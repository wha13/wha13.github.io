<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Before allI love RSA and Number Theory!!!picoCTF   Write UpMind your Ps and QsThe file:   1234Decrypt my super sick RSA:c: 96435412891391239393848085759096982630805446295056187563849203936337377980364">
<meta property="og:type" content="article">
<meta property="og:title" content="Write Up for RSA challenges in picoCTF">
<meta property="og:url" content="http://wha13.github.io/2023/09/21/picoctf-rsa/index.html">
<meta property="og:site_name" content="Whale120&#39;s Blog">
<meta property="og:description" content="Before allI love RSA and Number Theory!!!picoCTF   Write UpMind your Ps and QsThe file:   1234Decrypt my super sick RSA:c: 96435412891391239393848085759096982630805446295056187563849203936337377980364">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-09-22T02:52:24.000Z">
<meta property="article:modified_time" content="2024-07-25T09:30:32.267Z">
<meta property="article:author" content="William Lin">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Cryptography">
<meta property="article:tag" content="RSA">
<meta property="article:tag" content="Wiener&#39;s Attack">
<meta property="article:tag" content="picoCTF">
<meta property="article:tag" content="Pollard p-1">
<meta property="article:tag" content="Smooth Prime">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Write Up for RSA challenges in picoCTF</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2023/09/23/NCKUCTF/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2023/09/20/lotuxctf-crypto/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2023/09/21/picoctf-rsa/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&text=Write Up for RSA challenges in picoCTF"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&title=Write Up for RSA challenges in picoCTF"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&is_video=false&description=Write Up for RSA challenges in picoCTF"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Write Up for RSA challenges in picoCTF&body=Check out this article: http://wha13.github.io/2023/09/21/picoctf-rsa/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&title=Write Up for RSA challenges in picoCTF"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&title=Write Up for RSA challenges in picoCTF"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&title=Write Up for RSA challenges in picoCTF"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&title=Write Up for RSA challenges in picoCTF"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&name=Write Up for RSA challenges in picoCTF&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2023/09/21/picoctf-rsa/&t=Write Up for RSA challenges in picoCTF"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Write-Up"><span class="toc-number">2.</span> <span class="toc-text">Write Up</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Mind-your-Ps-and-Qs"><span class="toc-number">2.1.</span> <span class="toc-text">Mind your Ps and Qs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mini-RSA"><span class="toc-number">2.2.</span> <span class="toc-text">Mini RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dachshund-Attacks"><span class="toc-number">2.3.</span> <span class="toc-text">Dachshund Attacks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#No-Padding-No-Problem"><span class="toc-number">2.4.</span> <span class="toc-text">No Padding, No Problem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#triple-secure"><span class="toc-number">2.5.</span> <span class="toc-text">triple-secure</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b00tl3gRSA2"><span class="toc-number">2.6.</span> <span class="toc-text">b00tl3gRSA2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Very-smooth"><span class="toc-number">2.7.</span> <span class="toc-text">Very smooth</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sum-O-Prime"><span class="toc-number">2.8.</span> <span class="toc-text">Sum-O-Prime</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b00tl3gRSA3"><span class="toc-number">2.9.</span> <span class="toc-text">b00tl3gRSA3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SRA"><span class="toc-number">2.10.</span> <span class="toc-text">SRA</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Write Up for RSA challenges in picoCTF
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">William Lin</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-09-22T02:52:24.000Z" class="dt-published" itemprop="datePublished">2023-09-21</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/Cryptography/" rel="tag">Cryptography</a>, <a class="p-category" href="/tags/Pollard-p-1/" rel="tag">Pollard p-1</a>, <a class="p-category" href="/tags/RSA/" rel="tag">RSA</a>, <a class="p-category" href="/tags/Smooth-Prime/" rel="tag">Smooth Prime</a>, <a class="p-category" href="/tags/Wiener-s-Attack/" rel="tag">Wiener's Attack</a>, <a class="p-category" href="/tags/picoCTF/" rel="tag">picoCTF</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="Before-all"><a href="#Before-all" class="headerlink" title="Before all"></a>Before all</h1><p>I love RSA and Number Theory!!!<br><a target="_blank" rel="noopener" href="https://picoctf.org/">picoCTF</a>  </p>
<h1 id="Write-Up"><a href="#Write-Up" class="headerlink" title="Write Up"></a>Write Up</h1><h2 id="Mind-your-Ps-and-Qs"><a href="#Mind-your-Ps-and-Qs" class="headerlink" title="Mind your Ps and Qs"></a>Mind your Ps and Qs</h2><p>The file:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Decrypt my super sick RSA:</span><br><span class="line">c: 964354128913912393938480857590969826308054462950561875638492039363373779803642185</span><br><span class="line">n: 1584586296183412107468474423529992275940096154074798537916936609523894209759157543</span><br><span class="line">e: 65537</span><br></pre></td></tr></table></figure>
<p>It’s easy to see that the N is too small, so just throw it into factordb(<a target="_blank" rel="noopener" href="http://factordb.com/index.php">link</a>)<br>The factorized result:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1584586296183412107468474423529992275940096154074798537916936609523894209759157543=</span><br><span class="line">2434792384523484381583634042478415057961*650809615742055581459820253356987396346063</span><br></pre></td></tr></table></figure>
<p>After I found the p&amp;q, I just cauculated the phi(n) &#x2F; totient(n):  </p>
<p>p.s. Crypto.Util.number is a python package with many cryptography function, like inverse and long_to_bytes(convert long int to string):<br>My solve script:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="number">964354128913912393938480857590969826308054462950561875638492039363373779803642185</span></span><br><span class="line">n=<span class="number">1584586296183412107468474423529992275940096154074798537916936609523894209759157543</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p=<span class="number">2434792384523484381583634042478415057961</span></span><br><span class="line">q=<span class="number">650809615742055581459820253356987396346063</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=inverse(e, phi)</span><br><span class="line">flag=<span class="built_in">pow</span>(c, d, p*q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure>
<p>FLAG:<code>b&#39;picoCTF&#123;sma11_N_n0_g0od_73918962&#125;&#39;</code></p>
<h2 id="Mini-RSA"><a href="#Mini-RSA" class="headerlink" title="Mini RSA"></a>Mini RSA</h2><p>The file:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">N: 1615765684321463054078226051959887884233678317734892901740763321135213636796075462401950274602405095138589898087428337758445013281488966866073355710771864671726991918706558071231266976427184673800225254531695928541272546385146495736420261815693810544589811104967829354461491178200126099661909654163542661541699404839644035177445092988952614918424317082380174383819025585076206641993479326576180793544321194357018916215113009742654408597083724508169216182008449693917227497813165444372201517541788989925461711067825681947947471001390843774746442699739386923285801022685451221261010798837646928092277556198145662924691803032880040492762442561497760689933601781401617086600593482127465655390841361154025890679757514060456103104199255917164678161972735858939464790960448345988941481499050248673128656508055285037090026439683847266536283160142071643015434813473463469733112182328678706702116054036618277506997666534567846763938692335069955755244438415377933440029498378955355877502743215305768814857864433151287</span><br><span class="line">e: 3</span><br><span class="line">ciphertext (c): 1220012318588871886132524757898884422174534558055593713309088304910273991073554732659977133980685370899257850121970812405700793710546674062154237544840177616746805668666317481140872605653768484867292138139949076102907399831998827567645230986345455915692863094364797526497302082734955903755050638155202890599808146919581675891411119628108546342758721287307471723093546788074479139848242227243523617899178070097350912870635303707113283010669418774091018728233471491573736725568575532635111164176010070788796616348740261987121152288917179932230769893513971774137615028741237163693178359120276497700812698199245070488892892209716639870702721110338285426338729911942926177029934906215716407021792856449586278849142522957603215285531263079546937443583905937777298337318454706096366106704204777777913076793265584075700215822263709126228246232640662350759018119501368721990988895700497330256765579153834824063344973587990533626156498797388821484630786016515988383280196865544019939739447062641481267899176504155482</span><br></pre></td></tr></table></figure>
<p>Since e is too small and pow(flag, 3) can be written as c+k*n, it is a sufficient method to crack the k value through brute forcing:<br>p.s. the iroot is from gmpy2 which would return a pair(int, bool), the bool is if the root value it an interger and the int value is the floor of result<br>My solve script:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c=c=<span class="number">1220012318588871886132524757898884422174534558055593713309088304910273991073554732659977133980685370899257850121970812405700793710546674062154237544840177616746805668666317481140872605653768484867292138139949076102907399831998827567645230986345455915692863094364797526497302082734955903755050638155202890599808146919581675891411119628108546342758721287307471723093546788074479139848242227243523617899178070097350912870635303707113283010669418774091018728233471491573736725568575532635111164176010070788796616348740261987121152288917179932230769893513971774137615028741237163693178359120276497700812698199245070488892892209716639870702721110338285426338729911942926177029934906215716407021792856449586278849142522957603215285531263079546937443583905937777298337318454706096366106704204777777913076793265584075700215822263709126228246232640662350759018119501368721990988895700497330256765579153834824063344973587990533626156498797388821484630786016515988383280196865544019939739447062641481267899176504155482</span></span><br><span class="line">e=<span class="number">3</span></span><br><span class="line">n=<span class="number">1615765684321463054078226051959887884233678317734892901740763321135213636796075462401950274602405095138589898087428337758445013281488966866073355710771864671726991918706558071231266976427184673800225254531695928541272546385146495736420261815693810544589811104967829354461491178200126099661909654163542661541699404839644035177445092988952614918424317082380174383819025585076206641993479326576180793544321194357018916215113009742654408597083724508169216182008449693917227497813165444372201517541788989925461711067825681947947471001390843774746442699739386923285801022685451221261010798837646928092277556198145662924691803032880040492762442561497760689933601781401617086600593482127465655390841361154025890679757514060456103104199255917164678161972735858939464790960448345988941481499050248673128656508055285037090026439683847266536283160142071643015434813473463469733112182328678706702116054036618277506997666534567846763938692335069955755244438415377933440029498378955355877502743215305768814857864433151287</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000000</span>):</span><br><span class="line">     <span class="keyword">if</span> iroot(c+k*n, <span class="number">3</span>)[<span class="number">1</span>]:</span><br><span class="line">         <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(iroot(c+k*n, <span class="number">3</span>)[<span class="number">0</span>])))</span><br></pre></td></tr></table></figure>
<p>FLAG:<code>picoCTF&#123;e_sh0u1d_b3_lArg3r_60ef2420&#125;</code>  </p>
<h2 id="Dachshund-Attacks"><a href="#Dachshund-Attacks" class="headerlink" title="Dachshund Attacks"></a>Dachshund Attacks</h2><p>Since the d is too small, the Wiener’s Attack would work!(just as my last post said, maybe there would be a post in future talking about Wiener’s Attack)<br><a target="_blank" rel="noopener" href="https://github.com/orisano/owiener">Wiener’s Attack on Python</a><br><a target="_blank" rel="noopener" href="https://www.dcode.fr/rsa-cipher">Online Solver</a><br>Datas:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Welcome to my RSA challenge!</span><br><span class="line">e: 47998212863157354127621639739476305765986673601357336558728306019187778428142566649727260419736550419222300070928309397739848008761033583656922580232411234944797902346444995792666554040981439722213553763409879159053025130797613795919836493258902898708727788888299246768245150392055262213452071670286948516183</span><br><span class="line">n: 108450270285949346526350048750646710268918069236392973512666556070524106591394840719610692440100712487144849974036278198275813675381166111228464829157752311804319828824278457849476730380254297260586870398641503274370626516779600671443909726276180902673625434426727989117288738288809081300823291337863145072293</span><br><span class="line">c: 14362726277537353830427536242915576814218893651489047235892885549520535379820316816514967371049302181658890049971283699505914239513061023829084172958449927939056155559271988904584654187152261970664052050272055884068094880675411623681388448156866220509351435473297816532975759051581569088327735597919736660468</span><br></pre></td></tr></table></figure>
<p>FLAG:<code>picoCTF&#123;proving_wiener_6907362&#125;</code></p>
<h2 id="No-Padding-No-Problem"><a href="#No-Padding-No-Problem" class="headerlink" title="No Padding, No Problem"></a>No Padding, No Problem</h2><p>Well, well, well.<br>A  funny one, this challenge would give you the encrypted flag and the public key, and it also allow to input intergers to decrypt it(but not the flag)<br>Data received:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the Padding Oracle Challenge</span><br><span class="line">This oracle will take anything you give it and decrypt using RSA. It will not accept the ciphertext with the secret message... Good Luck!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n: 133049217096060230048644573425739918649950634329735874860181594086811938162707704420238875269503176879568678963867162580059653817683675108354519738044912928938017232590918506533061758792527840245394714875474445397523451401179617203900859068278397637211065280535031725192090486756426589573028646564004103844233</span><br><span class="line">e: 65537</span><br><span class="line">ciphertext: 94358969338652390102644924028147691030711298634986380650164278884952499986334429012692717646610958263845282354531226837663875103863965486724885153215561781299042382258495958558596258307791337558026498918805010409072341619722950473376728958503136804603535965168642205547902095786518209713087615531602706122630</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Give me ciphertext to decrypt:</span><br></pre></td></tr></table></figure>
<p>I came up with an idea to decrypt a value(2), which I named it t1; and decrypt(2*c), which I named it t2.<br>After that:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d is the private key.</span><br><span class="line">t1=2^d%n</span><br><span class="line">t2=(2*c)^d%n=(2^d*c^d)%n=(t1*c^d)%n</span><br></pre></td></tr></table></figure>
<p>than the value of <code>c^d%n</code> can be computed by <code>t2*(inverse)%n</code><br>My solve script:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">n=<span class="number">77005793532156829443826803097860385958429704134359957637962926177934403877451468634606875280571177101376040766342983289098122572766275185898756903614078539784650110642427440373150549948561881450266294450458211623996840066758889050119302108617577179256103345583934605532457065261663814241851573597453325390383</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="number">11083565797963011596598422114147242960498027263265537140695852060483304170572402080447617368582247544249565427218342463450867701716837615269698655189093864610527399894745981808123574701574734368657189803828233266256559440511169340526918081011349892249901897223344684589278999848235076029339046880893130380042</span></span><br><span class="line"><span class="comment">#t1=decrypt(2)</span></span><br><span class="line">t1=<span class="number">44716442020597541357343469015420742184907396729043973250538824036075491335429307776287226123666994142286193691198484313690025018110374213083495951170250459616408339179426774132280251606553770401935507743572600589506560431670893701883862520310597753475145452682096576393010164768050991341600484527711094189893</span></span><br><span class="line"><span class="comment">#t2=decrypt(2*c)</span></span><br><span class="line">t2=<span class="number">61002231760645453432330216276395586149529179098766541387367721531195448417171964477822685724290709728443085011562753553589437892416841056012738979370307340514180611653844736326960725464682872941352882838473224341241514443754886967218881777625139191033912032360286580829970384203603032358259283155282461716340</span></span><br><span class="line">key=inverse(t1, n)</span><br><span class="line">flag=(t2*key)%n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Welcome to the Padding Oracle Challenge</span></span><br><span class="line"><span class="string">This oracle will take anything you give it and decrypt using RSA. It will not accept the ciphertext with the secret message... Good Luck!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">n: 77005793532156829443826803097860385958429704134359957637962926177934403877451468634606875280571177101376040766342983289098122572766275185898756903614078539784650110642427440373150549948561881450266294450458211623996840066758889050119302108617577179256103345583934605532457065261663814241851573597453325390383</span></span><br><span class="line"><span class="string">e: 65537</span></span><br><span class="line"><span class="string">ciphertext: 11083565797963011596598422114147242960498027263265537140695852060483304170572402080447617368582247544249565427218342463450867701716837615269698655189093864610527399894745981808123574701574734368657189803828233266256559440511169340526918081011349892249901897223344684589278999848235076029339046880893130380042</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Give me ciphertext to decrypt: 2</span></span><br><span class="line"><span class="string">Here you go: 44716442020597541357343469015420742184907396729043973250538824036075491335429307776287226123666994142286193691198484313690025018110374213083495951170250459616408339179426774132280251606553770401935507743572600589506560431670893701883862520310597753475145452682096576393010164768050991341600484527711094189893</span></span><br><span class="line"><span class="string">Give me ciphertext to decrypt: 22167131595926023193196844228294485920996054526531074281391704120966608341144804160895234737164495088499130854436684926901735403433675230539397310378187729221054799789491963616247149403149468737314379607656466532513118881022338681053836162022699784499803794446689369178557999696470152058678093761786260760084</span></span><br><span class="line"><span class="string">Here you go: 61002231760645453432330216276395586149529179098766541387367721531195448417171964477822685724290709728443085011562753553589437892416841056012738979370307340514180611653844736326960725464682872941352882838473224341241514443754886967218881777625139191033912032360286580829970384203603032358259283155282461716340</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>FLAG:<code>picoCTF&#123;m4yb3_Th0se_m3s54g3s_4r3_difurrent_4005534&#125;</code></p>
<h2 id="triple-secure"><a href="#triple-secure" class="headerlink" title="triple-secure"></a>triple-secure</h2><p>encrypt.py:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read()</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">r = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">n1 = p * q</span><br><span class="line">n2 = p * r</span><br><span class="line">n3 = q * r</span><br><span class="line"></span><br><span class="line">moduli = [n1, n2, n3]</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> moduli:</span><br><span class="line">    c = <span class="built_in">pow</span>(c, e, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;public-key.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&#x27;n1: <span class="subst">&#123;n1&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;n2: <span class="subst">&#123;n2&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;n3: <span class="subst">&#123;n3&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;e: <span class="subst">&#123;e&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;c: <span class="subst">&#123;c&#125;</span>\n&#x27;</span>) </span><br></pre></td></tr></table></figure>
<p>public-keys.txt:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">n1: 15192492059814175574941055248891268822162533520576381643453916855435310880285336743521199057138647926712835561752909538944229702432795423884081992987060760867003375755338557996965825324749221386675061886921763747311599846248565297387814717840084998677273427776535730840343260681623323972936404815862969684384733188827100528542007213405382537935243645704237369770300643318878176739181891072725262069278646319502747718264711249767568106460533935904219027313131270918072460753061248221785076571054217566164086518459844527639082962818865640864990672033657423448004651989761933295878220596871163544315057550871764431562609</span><br><span class="line">n2: 15896482259608901559307142941940447232781986632502572991096358742354276347180855512281737388865155342941898447990281534875563129451327818848218781669275420292448483501384399236235069545630630803245125324540747189305877026874280373084005881976783826855683894679886076284892158862128016644725623200756074647449586448311069649515124968073653962156220351541159266665209363921681260367806445996085898841723209546021525012849575330252109081102034217511126192041193752164593519033112893785698509908066978411804133407757110693612926897693360335062446358344787945536573595254027237186626524339635916646549827668224103778645691</span><br><span class="line">n3: 16866741024290909515057727275216398505732182398866918550484373905882517578053919415558082579015872872951000794941027637288054371559194213756955947899010737036612882434425333227722062177363502202508368233645194979635011153509966453453939567651558628538264913958577698775210185802686516291658717434986786180150155217870273053289491069438118831268852205061142773994943387097417127660301519478434586738321776681183207796708047183864564628638795241493797850819727510884955449295504241048877759144706319821139891894102191791380663609673212846473456961724455481378829090944739778647230176360232323776623751623188480059886131</span><br><span class="line">e: 65537</span><br><span class="line">c: 5527557130549486626868355638343164556636640645975070563878791684872084568660950949839392805902757480207470630636669246237037694811318758082850684387745430679902248681495009593699928689084754915870981630249821819243308794164014262751330197659053593094226287631278905866187610594268602850237495796773397013150811502709453828013939726304717253858072813654392558403246468440154864433527550991691477685788311857169847773031859714215539719699781912119479668386111728900692806809163838659848295346731226661208367992168348253106720454566346143578242135426677554444162371330348888185625323879290902076363791018691228620744490</span><br></pre></td></tr></table></figure>
<p>Is just a simple math, let <code>n=n1*n2*n3</code>, then <code>sqrt(n)=p*q*r</code>, which means that the values of p, q, r can be solved.<br>My solve script:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n1= <span class="number">15192492059814175574941055248891268822162533520576381643453916855435310880285336743521199057138647926712835561752909538944229702432795423884081992987060760867003375755338557996965825324749221386675061886921763747311599846248565297387814717840084998677273427776535730840343260681623323972936404815862969684384733188827100528542007213405382537935243645704237369770300643318878176739181891072725262069278646319502747718264711249767568106460533935904219027313131270918072460753061248221785076571054217566164086518459844527639082962818865640864990672033657423448004651989761933295878220596871163544315057550871764431562609</span></span><br><span class="line">n2= <span class="number">15896482259608901559307142941940447232781986632502572991096358742354276347180855512281737388865155342941898447990281534875563129451327818848218781669275420292448483501384399236235069545630630803245125324540747189305877026874280373084005881976783826855683894679886076284892158862128016644725623200756074647449586448311069649515124968073653962156220351541159266665209363921681260367806445996085898841723209546021525012849575330252109081102034217511126192041193752164593519033112893785698509908066978411804133407757110693612926897693360335062446358344787945536573595254027237186626524339635916646549827668224103778645691</span></span><br><span class="line">n3= <span class="number">16866741024290909515057727275216398505732182398866918550484373905882517578053919415558082579015872872951000794941027637288054371559194213756955947899010737036612882434425333227722062177363502202508368233645194979635011153509966453453939567651558628538264913958577698775210185802686516291658717434986786180150155217870273053289491069438118831268852205061142773994943387097417127660301519478434586738321776681183207796708047183864564628638795241493797850819727510884955449295504241048877759144706319821139891894102191791380663609673212846473456961724455481378829090944739778647230176360232323776623751623188480059886131</span></span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">c= <span class="number">5527557130549486626868355638343164556636640645975070563878791684872084568660950949839392805902757480207470630636669246237037694811318758082850684387745430679902248681495009593699928689084754915870981630249821819243308794164014262751330197659053593094226287631278905866187610594268602850237495796773397013150811502709453828013939726304717253858072813654392558403246468440154864433527550991691477685788311857169847773031859714215539719699781912119479668386111728900692806809163838659848295346731226661208367992168348253106720454566346143578242135426677554444162371330348888185625323879290902076363791018691228620744490</span></span><br><span class="line">n=<span class="built_in">int</span>(iroot(n1*n2*n3, <span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(iroot(n1*n2*n3, <span class="number">2</span>)[<span class="number">1</span>])</span><br><span class="line">p=n//n3</span><br><span class="line">q=n//n2</span><br><span class="line">r=n//n1</span><br><span class="line">moduli=[n1, n2, n3]</span><br><span class="line">phi1=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">phi2=(p-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">phi3=(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">phi=[phi1, phi2, phi3]</span><br><span class="line">flag=c</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):  </span><br><span class="line">    flag=<span class="built_in">pow</span>(flag, inverse(e, phi[<span class="number">2</span>-i]), moduli[<span class="number">2</span>-i])</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure>
<p>FLAG:<code>picoCTF&#123;1_gu3ss_tr1pl3_rs4_1snt_tr1pl3_s3cur3!!!!!!&#125;</code></p>
<h2 id="b00tl3gRSA2"><a href="#b00tl3gRSA2" class="headerlink" title="b00tl3gRSA2"></a>b00tl3gRSA2</h2><p>yep another Winener’s Attack since d is too small<br>DATA:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c: 79396535588353630695486234014424929916205425304761091938030999059051581563198817503471784068587452953675941441350902358478355554368623855312096803479190639431422004857778295425507105153807293475639758387513183460099315344512961115213991958994879582567855434834786245483772632420424135418087952312013784447104</span><br><span class="line">n: 135353553008819297596740335339273679542882393695679559322286049659355156071182446202866363658452910881055640447592736005033375384280627574497016576001512272083463306254606627449113272614835389290642248900003987526599788620219498490945529378728109334543317754090740699052350653159051922670156288897456971301477</span><br><span class="line">e: 62845007621730662169022257107263969891975042460988957544865376887628637931092522628546021022675185394504510172571209605217824733635583204363485014436883229586360414955518882953345099159399543114307850329322548225862640531212783162556849902351176619695825848691413009881363312562974634505047548635398733234653</span><br></pre></td></tr></table></figure>
<p>FLAG:<code>picoCTF&#123;bad_1d3a5_4783252&#125;</code></p>
<h2 id="Very-smooth"><a href="#Very-smooth" class="headerlink" title="Very smooth"></a>Very smooth</h2><p>A Pollard p-1 attack<br>(many mathematics, that’s why I love RSA)<br><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Pollard%27s_p_%E2%88%92_1_algorithm">Pollard p-1 algorithm</a><br><a target="_blank" rel="noopener" href="https://www.dcode.fr/rsa-cipher">Dcode.fr Online Solver</a><br>Pollard p-1 algo  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">pollard_algorithm</span>(<span class="params">n: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    - input : `n (int)` , n has a factor p that (p - 1)&#x27;s large prime factor is really small</span></span><br><span class="line"><span class="string">    - output : `(p, q) (int, int)` , n&#x27;s factors</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    a = <span class="number">2</span></span><br><span class="line">    b = <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = <span class="built_in">int</span>(<span class="built_in">pow</span>(a, b, n))</span><br><span class="line">        p = <span class="built_in">int</span>(gcd(a - <span class="number">1</span>, n))</span><br><span class="line">        <span class="keyword">if</span> <span class="number">1</span> &lt; p &lt; n:</span><br><span class="line">            <span class="keyword">return</span> p, n // p</span><br><span class="line">        b += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>gen.py:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sys.version_info &lt; (<span class="number">3</span>, <span class="number">9</span>):</span><br><span class="line">    math.gcd = gcd</span><br><span class="line">    math.lcm = lcm</span><br><span class="line"></span><br><span class="line">_DEBUG = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">FLAG  = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>).read().strip()</span><br><span class="line">FLAG  = mpz(hexlify(FLAG.encode()), <span class="number">16</span>)</span><br><span class="line">SEED  = mpz(hexlify(os.urandom(<span class="number">32</span>)).decode(), <span class="number">16</span>)</span><br><span class="line">STATE = random_state(SEED)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_prime</span>(<span class="params">state, bits</span>):</span><br><span class="line">    <span class="keyword">return</span> next_prime(mpz_urandomb(state, bits) | (<span class="number">1</span> &lt;&lt; (bits - <span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_smooth_prime</span>(<span class="params">state, bits, smoothness=<span class="number">16</span></span>):</span><br><span class="line">    p = mpz(<span class="number">2</span>)</span><br><span class="line">    p_factors = [p]</span><br><span class="line">    <span class="keyword">while</span> p.bit_length() &lt; bits - <span class="number">2</span> * smoothness:</span><br><span class="line">        factor = get_prime(state, smoothness)</span><br><span class="line">        p_factors.append(factor)</span><br><span class="line">        p *= factor</span><br><span class="line"></span><br><span class="line">    bitcnt = (bits - p.bit_length()) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        prime1 = get_prime(state, bitcnt)</span><br><span class="line">        prime2 = get_prime(state, bitcnt)</span><br><span class="line">        tmpp = p * prime1 * prime2</span><br><span class="line">        <span class="keyword">if</span> tmpp.bit_length() &lt; bits:</span><br><span class="line">            bitcnt += <span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> tmpp.bit_length() &gt; bits:</span><br><span class="line">            bitcnt -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> is_prime(tmpp + <span class="number">1</span>):</span><br><span class="line">            p_factors.append(prime1)</span><br><span class="line">            p_factors.append(prime2)</span><br><span class="line">            p = tmpp + <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_factors.sort()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (p, p_factors)</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p, p_factors = get_smooth_prime(STATE, <span class="number">1024</span>, <span class="number">16</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(p_factors) != <span class="built_in">len</span>(<span class="built_in">set</span>(p_factors)):</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="comment"># Smoothness should be different or some might encounter issues.</span></span><br><span class="line">    q, q_factors = get_smooth_prime(STATE, <span class="number">1024</span>, <span class="number">17</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(q_factors) != <span class="built_in">len</span>(<span class="built_in">set</span>(q_factors)):</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    factors = p_factors + q_factors</span><br><span class="line">    <span class="keyword">if</span> e <span class="keyword">not</span> <span class="keyword">in</span> factors:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> _DEBUG:</span><br><span class="line">    <span class="keyword">import</span> sys</span><br><span class="line">    sys.stderr.write(<span class="string">f&#x27;p = <span class="subst">&#123;p.digits(<span class="number">16</span>)&#125;</span>\n\n&#x27;</span>)</span><br><span class="line">    sys.stderr.write(<span class="string">f&#x27;p_factors = [\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> factor <span class="keyword">in</span> p_factors:</span><br><span class="line">        sys.stderr.write(<span class="string">f&#x27;    <span class="subst">&#123;factor.digits(<span class="number">16</span>)&#125;</span>,\n&#x27;</span>)</span><br><span class="line">    sys.stderr.write(<span class="string">f&#x27;]\n\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    sys.stderr.write(<span class="string">f&#x27;q = <span class="subst">&#123;q.digits(<span class="number">16</span>)&#125;</span>\n\n&#x27;</span>)</span><br><span class="line">    sys.stderr.write(<span class="string">f&#x27;q_factors = [\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> factor <span class="keyword">in</span> q_factors:</span><br><span class="line">        sys.stderr.write(<span class="string">f&#x27;    <span class="subst">&#123;factor.digits(<span class="number">16</span>)&#125;</span>,\n&#x27;</span>)</span><br><span class="line">    sys.stderr.write(<span class="string">f&#x27;]\n\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">m = math.lcm(p - <span class="number">1</span>, q - <span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, m)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(FLAG, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n.digits(<span class="number">16</span>)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c.digits(<span class="number">16</span>)&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>DATA:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n = a1355e27e1419c3f129f1db20915bf2a2d8db159b67b55858ccb2fbe4c6f4f8245411928326496b416f389dc88f6f89f1e7dc2f184a4fb5efd40d53c4f578bd4643aea45971c21bde2ddfc6582c2955466cb8f5f2341d11ad3bdcb678efeadd043d203105545d104b1c6bde632fe72e89e37af6c69b8ca3c0d7f1367e3f9967f719e816ff603544530999eda08d28b6390fc9e3c8e0eb7432e9506bf5e638c4f548dd8c6c6c0791915f2e31b4f4114c89036650ebf541fec907017d17062114f6d2008aa641166a27734c936e7cb0f4c9df4ca5c7b57019901cbb4f3d3bbc78befbfb770ca8cbf0f3d9b752d55b81f57379e9a13bd33cf3ee17f131c16db8b21</span><br><span class="line">c = 73d31ba14f88d1343a774e5d4315e1733af382318d7bf99116e5e42f0b11dc9561dfa7eafca3e061504538396fd5e463247596e8524df1c51600644d9ea7e607d5be8f79ef237907616d2ab958debc6bef12bd1c959ed3e4c2b0d7aff8ea74711d49fc6e8d438de536d6dd6eb396587e015289717e2c6ea9951822f46aae4a8aa4fc2902ceeddefd45e67fe6d15a6b182bafe8a254323200c728720bfd2d727cc779172f0848616ed37d467179a6912e8bbeb12524c7ac5cda79eee31b96cc7e36d9d69ef673f3016d0e6f0444b4f9de3d05f9d483ee6c1af479a0ffb96e9efab8098e12c7160fe3e4288364be80633a637353979c3d62376abfc99c635b703c</span><br></pre></td></tr></table></figure>
<p>FLAG:<code>picoCTF&#123;p0ll4rd_f4ct0r1z4at10n_FTW_148cbc0f&#125;</code></p>
<h2 id="Sum-O-Prime"><a href="#Sum-O-Prime" class="headerlink" title="Sum-O-Prime"></a>Sum-O-Prime</h2><p>This challenge would give you the sum of p and q<br>than the value of p-q can be computed with sqrt((p+q)^2-4*n)<br>gen.py:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> mpz_urandomb, next_prime, random_state</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sys.version_info &lt; (<span class="number">3</span>, <span class="number">9</span>):</span><br><span class="line">    <span class="keyword">import</span> gmpy2</span><br><span class="line">    math.gcd = gmpy2.gcd</span><br><span class="line">    math.lcm = gmpy2.lcm</span><br><span class="line"></span><br><span class="line">FLAG  = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>).read().strip()</span><br><span class="line">FLAG  = <span class="built_in">int</span>(hexlify(FLAG.encode()), <span class="number">16</span>)</span><br><span class="line">SEED  = <span class="built_in">int</span>(hexlify(os.urandom(<span class="number">32</span>)).decode(), <span class="number">16</span>)</span><br><span class="line">STATE = random_state(SEED)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_prime</span>(<span class="params">bits</span>):</span><br><span class="line">    <span class="keyword">return</span> next_prime(mpz_urandomb(STATE, bits) | (<span class="number">1</span> &lt;&lt; (bits - <span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">p = get_prime(<span class="number">1024</span>)</span><br><span class="line">q = get_prime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">x = p + q</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m = math.lcm(p - <span class="number">1</span>, q - <span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, m)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(FLAG, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;x = <span class="subst">&#123;x:x&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n:x&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c:x&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>output.txt:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = 1626a189dcb38ca6b8e9ee26623ab5c3c6cd7e4c7ff6726f4b03831ca48c617a056827c5763458d0aa7172650072b892649cc73f943f156b795ff5dd2fc9a53b140cf9c3ee2cbb8181d17bb0275f404b4090766f798ad156db7e71000e93db65f3e1bc7406532d0f509fbecf095ef215b4ad51f5e8ac765861e5f93808948bf72</span><br><span class="line">n = 720d66204ec312d7f1bc688495d4585ec58520170b86ed3488c3f9c76407b7e9e466b82a282ba90d484698160f2e27f413b07cf8805d560abdffa977547d5fec3190a1ce284dfc8e92193f2f70590bf9c6e6d0ab449e35ef43ed20232b7f8686696125cde1f950230fbc6858392a3715c1b8a4947748b7fadd5cc921716ad5e0129c91ea88fceee140fb1c594606186afacb69143ef8f7b3b1aa2cc3206395c60e71ec0555dd15838d8a8395e8ccf9a4e4c4199ae0ab3f8af7ebc6605edc5ddd480be2d6c41e38618eba5822a1e566080877268802750de71e890ac865ebf87fdc290d9151e407dff4c97390c9e7388fd538e2716515cea2240f55963c2e0c21</span><br><span class="line">c = 554b90eb12fbece709d7bf23ab91f9b52d71cd77fbf42f65d68623c2055d99956b9bcf2eaf14771fa5781fae86624e44b452a0f68768849faba1b9695ce353a17238a3e7040ee7aede68b35bf4b51daf0982653910b280ac98aad9a5b3c49d226e10b2e8660effc2cb2a553039bde527e42f1795bc078af6ed2928505be6df1ebe993f2ed8c10477dd5cc9f899d1e69b6512b71c732472dde521f5393c76b2f9fbed668560d4e50ca177dd14b923414549d688b20fab94dba7cad7b5a729941c772dc4a1db79b0e6a111d2d2e8998b4e2a272dc940a9dd4cf856faa5a2ee0cb6f36f0ce6edbb421697e517a4d589cc5a880eecf6fbf65e5f6a1a437b06e5ff9a</span><br></pre></td></tr></table></figure>
<p>My solve script:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">x = <span class="number">0x1626a189dcb38ca6b8e9ee26623ab5c3c6cd7e4c7ff6726f4b03831ca48c617a056827c5763458d0aa7172650072b892649cc73f943f156b795ff5dd2fc9a53b140cf9c3ee2cbb8181d17bb</span>&gt;</span><br><span class="line">n = <span class="number">0x720d66204ec312d7f1bc688495d4585ec58520170b86ed3488c3f9c76407b7e9e466b82a282ba90d484698160f2e27f413b07cf8805d560abdffa977547d5fec3190a1ce284dfc8e92193f2</span>&gt;</span><br><span class="line">c = <span class="number">0x554b90eb12fbece709d7bf23ab91f9b52d71cd77fbf42f65d68623c2055d99956b9bcf2eaf14771fa5781fae86624e44b452a0f68768849faba1b9695ce353a17238a3e7040ee7aede68b35</span>&gt;</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">dif=<span class="built_in">int</span>(iroot(x*x-<span class="number">4</span>*n, <span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line">p=(x+dif)//<span class="number">2</span></span><br><span class="line">q=x-p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=inverse(e, phi)</span><br><span class="line">flag=<span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure>
<p>FLAG:<code>picoCTF&#123;pl33z_n0_g1v3_c0ngru3nc3_0f_5qu4r35_92fe3557&#125;</code></p>
<h2 id="b00tl3gRSA3"><a href="#b00tl3gRSA3" class="headerlink" title="b00tl3gRSA3"></a>b00tl3gRSA3</h2><p>I didn’t know how to solve this until I saw the hint:there’s many primes XD<br><a target="_blank" rel="noopener" href="https://www.alpertron.com.ar/ECM.HTM">online totient cauculator</a><br>DATA received:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c: 3798291345622232828545625884608355778200508418441257100989411897904139623617684581137446299126199954497239868324888648801262748153348933672898642876177156562954121430975134763536012436437663935722829225419618487120286073707231243067686035684397308337509258231644866314310307005915281389361476818972849148586431011664590904603610058099969223522</span><br><span class="line">n: 8729126666460774954335950980778226450552655275963874331584951440681876336912593854275664177683981585872871837731962225766891218022005808717477023954039311742477353852131523068552519474576711658262694637540615684267124200918711730673489232487609573305460354446932384278842210951786295463872891982246284528503447328498259541563662769737904553597</span><br><span class="line">e: 65537</span><br></pre></td></tr></table></figure>
<p>the totient(n) extracted:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8729126641569990303349941606358213543795611870013849035074534525735935994444149215240124561974468564177494971546223568802571662758666597072143145474781361778670492800310421961638425936064882823367160808667013708822249027718180930758164867107306628372647183993871293208192833265135465846321884844227832557551800909959600794442399744000000000000</span><br></pre></td></tr></table></figure>
<p>My solve script:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">phi=<span class="number">8729126641569990303349941606358213543795611870013849035074534525735935994444149215240124561974468564177494971546223568802571662758666597072143145474781361778670492800310421961638425936064882823367160808667013708822249027718180930758164867107306628372647183993871293208192833265135465846321884844227832557551800909959600794442399744000000000000</span></span><br><span class="line">c=<span class="number">3798291345622232828545625884608355778200508418441257100989411897904139623617684581137446299126199954497239868324888648801262748153348933672898642876177156562954121430975134763536012436437663935722829225419618487120286073707231243067686035684397308337509258231644866314310307005915281389361476818972849148586431011664590904603610058099969223522</span></span><br><span class="line">n=<span class="number">8729126666460774954335950980778226450552655275963874331584951440681876336912593854275664177683981585872871837731962225766891218022005808717477023954039311742477353852131523068552519474576711658262694637540615684267124200918711730673489232487609573305460354446932384278842210951786295463872891982246284528503447328498259541563662769737904553597</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d=inverse(e, phi)</span><br><span class="line">flag=<span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure>
<h2 id="SRA"><a href="#SRA" class="headerlink" title="SRA"></a>SRA</h2><p>A relaxing problem which brought me confidence.<br>Something cute but strange like this:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">anger = 73768303422649948577186525821079928269979190983329894967009810920290675100355</span><br><span class="line">envy = 73001188472029255507658713864524755933553198761720678866636731130354948599821</span><br><span class="line">vainglory?</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<p>chal.py:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, inverse, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters, digits</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"></span><br><span class="line">pride = <span class="string">&quot;&quot;</span>.join(choice(ascii_letters + digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>))</span><br><span class="line">gluttony = getPrime(<span class="number">128</span>)</span><br><span class="line">greed = getPrime(<span class="number">128</span>)</span><br><span class="line">lust = gluttony * greed</span><br><span class="line">sloth = <span class="number">65537</span></span><br><span class="line">envy = inverse(sloth, (gluttony - <span class="number">1</span>) * (greed - <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">anger = <span class="built_in">pow</span>(bytes_to_long(pride.encode()), sloth, lust)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;anger = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;envy = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;vainglory?&quot;</span>)</span><br><span class="line">vainglory = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>).strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> vainglory == pride:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Conquered!&quot;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/challenge/flag.txt&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="built_in">print</span>(f.read())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Hubris!&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>ok, ok… I just converted those strange variables into the familiar ones.  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gluttony=p</span><br><span class="line">greed=q</span><br><span class="line">lust=n</span><br><span class="line">sloth=e</span><br><span class="line">envy=d</span><br><span class="line">anger=c</span><br></pre></td></tr></table></figure>
<p>So the problem statement change into to cauculate the value of n, p, and q with d and e.<br>let <code>u=d*e-1</code>, than <code>u=(p-1)*(q-1)*t</code>, so I enumerated the values of t by factorizing u!<br>My solve script(partial?)<br>p.s. <code>sympy.ntheory</code> us a package contain the function divisors which would return a list of divisors of an interger.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory <span class="keyword">import</span> *</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;anger = &#x27;</span>))</span><br><span class="line">d=<span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;envy = &#x27;</span>))</span><br><span class="line">u=d*e-<span class="number">1</span></span><br><span class="line">factorlist=divisors(u)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> factorlist:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> factorlist:</span><br><span class="line">        <span class="keyword">if</span> j%i==<span class="number">0</span> <span class="keyword">and</span> isprime(j//i+<span class="number">1</span>) <span class="keyword">and</span> isprime(u//j+<span class="number">1</span>):</span><br><span class="line">            n=(j//i+<span class="number">1</span>)*(u//j+<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">len</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n))))==<span class="number">16</span>:</span><br><span class="line">                <span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n)))</span><br></pre></td></tr></table></figure>
<p>FINNALY:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; WrLH8Ulmjcbb2TbC</span><br><span class="line">WrLH8Ulmjcbb2TbC</span><br><span class="line">Conquered!</span><br><span class="line">picoCTF&#123;7h053_51n5_4r3_n0_m0r3_b2f9b414&#125;</span><br></pre></td></tr></table></figure>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Write-Up"><span class="toc-number">2.</span> <span class="toc-text">Write Up</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Mind-your-Ps-and-Qs"><span class="toc-number">2.1.</span> <span class="toc-text">Mind your Ps and Qs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mini-RSA"><span class="toc-number">2.2.</span> <span class="toc-text">Mini RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dachshund-Attacks"><span class="toc-number">2.3.</span> <span class="toc-text">Dachshund Attacks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#No-Padding-No-Problem"><span class="toc-number">2.4.</span> <span class="toc-text">No Padding, No Problem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#triple-secure"><span class="toc-number">2.5.</span> <span class="toc-text">triple-secure</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b00tl3gRSA2"><span class="toc-number">2.6.</span> <span class="toc-text">b00tl3gRSA2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Very-smooth"><span class="toc-number">2.7.</span> <span class="toc-text">Very smooth</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sum-O-Prime"><span class="toc-number">2.8.</span> <span class="toc-text">Sum-O-Prime</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b00tl3gRSA3"><span class="toc-number">2.9.</span> <span class="toc-text">b00tl3gRSA3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SRA"><span class="toc-number">2.10.</span> <span class="toc-text">SRA</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2023/09/21/picoctf-rsa/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&text=Write Up for RSA challenges in picoCTF"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&title=Write Up for RSA challenges in picoCTF"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&is_video=false&description=Write Up for RSA challenges in picoCTF"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Write Up for RSA challenges in picoCTF&body=Check out this article: http://wha13.github.io/2023/09/21/picoctf-rsa/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&title=Write Up for RSA challenges in picoCTF"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&title=Write Up for RSA challenges in picoCTF"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&title=Write Up for RSA challenges in picoCTF"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&title=Write Up for RSA challenges in picoCTF"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2023/09/21/picoctf-rsa/&name=Write Up for RSA challenges in picoCTF&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2023/09/21/picoctf-rsa/&t=Write Up for RSA challenges in picoCTF"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2024
    William Lin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
