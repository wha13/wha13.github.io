<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Before all感覺今天晚上可以去開箱HARD的Crypto玩…就先隨便丟點owob   Secure Signingserver.py   12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from hashlib import sha256from s">
<meta property="og:type" content="article">
<meta property="og:title" content="HackTheBox Crypto 隨筆 4&#x2F;20">
<meta property="og:url" content="http://wha13.github.io/2024/04/20/htb-crypto-2024apr/index.html">
<meta property="og:site_name" content="Whale120&#39;s Blog">
<meta property="og:description" content="Before all感覺今天晚上可以去開箱HARD的Crypto玩…就先隨便丟點owob   Secure Signingserver.py   12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from hashlib import sha256from s">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/Syy0PybWA.png">
<meta property="article:published_time" content="2024-04-20T18:51:00.000Z">
<meta property="article:modified_time" content="2024-07-25T09:30:32.267Z">
<meta property="article:author" content="William Lin">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Cryptography">
<meta property="article:tag" content="RSA">
<meta property="article:tag" content="ECC">
<meta property="article:tag" content="HackTheBox">
<meta property="article:tag" content="HASH">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/Syy0PybWA.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>HackTheBox Crypto 隨筆 4/20</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/04/23/sickrop-htb/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/04/20/htb-gamepwn-2024apr/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&text=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&title=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&is_video=false&description=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackTheBox Crypto 隨筆 4/20&body=Check out this article: http://wha13.github.io/2024/04/20/htb-crypto-2024apr/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&title=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&title=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&title=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&title=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&name=HackTheBox Crypto 隨筆 4/20&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&t=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Secure-Signing"><span class="toc-number">2.</span> <span class="toc-text">Secure Signing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Remeeting-The-Wheel"><span class="toc-number">3.</span> <span class="toc-text">Remeeting The Wheel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Quadratic-Points"><span class="toc-number">4.</span> <span class="toc-text">Quadratic Points</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        HackTheBox Crypto 隨筆 4/20
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">William Lin</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-04-20T18:51:00.000Z" class="dt-published" itemprop="datePublished">2024-04-20</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/Cryptography/" rel="tag">Cryptography</a>, <a class="p-category" href="/tags/ECC/" rel="tag">ECC</a>, <a class="p-category" href="/tags/HASH/" rel="tag">HASH</a>, <a class="p-category" href="/tags/HackTheBox/" rel="tag">HackTheBox</a>, <a class="p-category" href="/tags/RSA/" rel="tag">RSA</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Before-all"><a href="#Before-all" class="headerlink" title="Before all"></a>Before all</h2><p>感覺今天晚上可以去開箱HARD的Crypto玩…<br>就先隨便丟點owob  </p>
<h2 id="Secure-Signing"><a href="#Secure-Signing" class="headerlink" title="Secure Signing"></a>Secure Signing</h2><p><strong>server.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line">WELCOME_MSG = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Welcome to my Super Secure Signing service which uses unbreakable hash function.</span></span><br><span class="line"><span class="string">We combine your Cipher with our secure key to make sure that it is more secure than it should be.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">menu</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1 - Sign Your Message&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2 - Verify Your Message&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;3 - Exit&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([i ^ j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(a, b)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">H</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">return</span> sha256(m).digest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(WELCOME_MSG)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            menu()</span><br><span class="line">            choice = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Try again.&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> choice == <span class="number">1</span>:</span><br><span class="line">            message = <span class="built_in">input</span>(<span class="string">&quot;Enter your message: &quot;</span>).encode()</span><br><span class="line">            hsh = H(xor(message, FLAG))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Hash: <span class="subst">&#123;hsh.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="number">2</span>:</span><br><span class="line">            message = <span class="built_in">input</span>(<span class="string">&quot;Enter your message: &quot;</span>).encode()</span><br><span class="line">            hsh = <span class="built_in">input</span>(<span class="string">&quot;Enter your hash: &quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> H(xor(message, FLAG)).<span class="built_in">hex</span>() == hsh:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[+] Signature Validated!\n&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[!] Invalid Signature!\n&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Good Bye&quot;</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>觀察一下，會發現<code>xor</code>函數會根據長度比較小的資料進行xor，所以可以確認長度後在本地自己枚舉hash值找一樣的:D。  </p>
<p><strong>exp.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag=<span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;83.136.255.150&#x27;</span>, <span class="number">30584</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">oracle</span>(<span class="params">x</span>):</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(x)</span><br><span class="line">    <span class="keyword">return</span> r.recvline()[:-<span class="number">1</span>].replace(<span class="string">b&#x27;Enter your message: &#x27;</span>, <span class="string">b&#x27;&#x27;</span>).replace(<span class="string">b&#x27;Hash: &#x27;</span>, <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># bruteforce flag length</span></span><br><span class="line"></span><br><span class="line">past=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">flag_length=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">1</span>, <span class="number">101</span>):</span><br><span class="line">    cur=oracle(<span class="string">b&#x27;\x00&#x27;</span>*i)</span><br><span class="line">    <span class="comment">#print(cur)</span></span><br><span class="line">    <span class="keyword">if</span> cur==past:</span><br><span class="line">        flag_length=i-<span class="number">1</span></span><br><span class="line">        info(<span class="string">f&quot;Flag length found:<span class="subst">&#123;flag_length&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    past=cur</span><br><span class="line"></span><br><span class="line"><span class="comment"># exploit</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, flag_length+<span class="number">1</span>):</span><br><span class="line">    cur=oracle(flag+<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> string.printable:</span><br><span class="line">        <span class="keyword">if</span> cur==sha256(<span class="string">b&#x27;\x00&#x27;</span>*(i-<span class="number">1</span>)+c.encode()).hexdigest().encode():</span><br><span class="line">            flag=flag+c.encode()</span><br><span class="line">            info(<span class="string">f&quot;Current:<span class="subst">&#123;flag.decode()&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="Remeeting-The-Wheel"><a href="#Remeeting-The-Wheel" class="headerlink" title="Remeeting The Wheel"></a>Remeeting The Wheel</h2><p><strong>source.py</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, long_to_bytes <span class="keyword">as</span> l2b</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAGen</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, bits</span>):</span><br><span class="line">        self.bits = bits</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">keygen</span>(<span class="params">self</span>):</span><br><span class="line">        p = getPrime(self.bits//<span class="number">2</span>)</span><br><span class="line">        q = getPrime(self.bits//<span class="number">2</span>)</span><br><span class="line">        self.n = p*q</span><br><span class="line">        self.e = <span class="number">0x10001</span></span><br><span class="line">        phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">        self.d = <span class="built_in">pow</span>(self.e, -<span class="number">1</span>, phi)</span><br><span class="line">        <span class="keyword">return</span> (self.n, self.e), (p, q, phi, self.d)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, m</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(m, self.e, self.n)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, c</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(c, self.d, self.n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AESGen</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, size</span>):</span><br><span class="line">        key1 = randint(<span class="number">1</span> &lt;&lt; size, <span class="number">1</span> &lt;&lt; (size+<span class="number">1</span>))</span><br><span class="line">        key2 = randint(<span class="number">1</span> &lt;&lt; size, <span class="number">1</span> &lt;&lt; (size+<span class="number">1</span>))</span><br><span class="line">        self.k = key1 * key2</span><br><span class="line">        <span class="keyword">assert</span> <span class="number">40</span> &lt;= self.k.bit_length() &lt;= <span class="number">42</span></span><br><span class="line">        self.KEY = sha256(<span class="built_in">str</span>(self.k).encode()).digest()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, m</span>):</span><br><span class="line">        cipher = AES.new(self.KEY, AES.MODE_ECB)</span><br><span class="line">        enc_secret = cipher.encrypt(pad(m, <span class="number">16</span>))</span><br><span class="line">        <span class="keyword">return</span> enc_secret</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    rsa = RSAGen(<span class="number">1024</span>)</span><br><span class="line">    aes = AESGen(<span class="number">20</span>)</span><br><span class="line">    pubkey, _ = rsa.keygen()</span><br><span class="line">    enc_aes_key = l2b(rsa.encrypt(aes.k))</span><br><span class="line">    enc_secret = aes.encrypt(FLAG)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="string">&quot;Bob :: Hi Alice, here is my public key:\n&quot;</span>)</span><br><span class="line">        f.write(<span class="string">f&quot;(<span class="subst">&#123;pubkey[<span class="number">0</span>]&#125;</span>, <span class="subst">&#123;pubkey[<span class="number">1</span>]&#125;</span>)\n&quot;</span>)</span><br><span class="line">        f.write(<span class="string">&quot;Alice :: Hi Bob, here is my encrypted AES key, don&#x27;t forget to sha256-hash it!\n&quot;</span>)</span><br><span class="line">        f.write(<span class="string">f&quot;Encrypted AES Key = <span class="subst">&#123;enc_aes_key.<span class="built_in">hex</span>()&#125;</span>\n&quot;</span>)</span><br><span class="line">        f.write(<span class="string">&quot;Bob :: Got it, here is the encrypted secret you requested:\n&quot;</span>)</span><br><span class="line">        f.write(<span class="string">f&quot;Encrypted Secret = <span class="subst">&#123;enc_secret.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p><strong>output.txt</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Bob :: Hi Alice, here <span class="keyword">is</span> my public key:</span><br><span class="line">(<span class="number">72741423208033405403492275698762968936514657314823442485453559870105200118330405900858299998747406127848670334407387228444029070060538220448699667905891284937839901536444798774307744865631349770845980738192442639071823803272283670943732769371979418893953521892212745135191661138195973757608889180051128601323</span>, <span class="number">65537</span>)</span><br><span class="line">Alice :: Hi Bob, here <span class="keyword">is</span> my encrypted AES key, don<span class="string">&#x27;t forget to sha256-hash it!</span></span><br><span class="line"><span class="string">Encrypted AES Key = 4da0230d2b8b46e3a7065f32c46df019739cc002a208cc37767a82c3e94edfc3440fa4b24a32274e35d5ddceaa33505c4f2a57281c3a5d6d4db3a0dbdbb30dbf373241319ce4a7fdd1780b6bafc86e37d283c9f9787c567434e2fc29c988fb05fd411fe4453ea40eb45fc41a423839b485e238dd2530fba284e9b07a0bba6546</span></span><br><span class="line"><span class="string">Bob :: Got it, here is the encrypted secret you requested:</span></span><br><span class="line"><span class="string">Encrypted Secret = ce8f36aa844ab00319bcd4f86460a10d77492c060b2c2a91615f4cd1f2d0702e76b68f1ec0f11d15704ba52c5dacc60018d5ed87368464acd030ce6230efdbff7b18cba72ccaa9455a6fe6021b908dd1</span></span><br></pre></td></tr></table></figure>
<p>看起來不能直接暴力…<br>想一下，會發現只要枚舉介於 $2^{20}$ ~ $2^{21}$ 的數字之e次方mod n，然後透過枚舉其中一個數來尋找另一個(模逆元)就能在正常時間複雜度下完成。<br>就是 Meet in the Middle(?)<br><strong>source.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n, e=<span class="number">72741423208033405403492275698762968936514657314823442485453559870105200118330405900858299998747406127848670334407387228444029070060538220448699667905891284937839901536444798774307744865631349770845980738192442639071823803272283670943732769371979418893953521892212745135191661138195973757608889180051128601323</span>, <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">key=<span class="built_in">int</span>(<span class="string">&#x27;4da0230d2b8b46e3a7065f32c46df019739cc002a208cc37767a82c3e94edfc3440fa4b24a32274e35d5ddceaa33505c4f2a57281c3a5d6d4db3a0dbdbb30dbf373241319ce4a7fdd1780b6bafc86e37d283c9f9787c567434e2fc29c988fb05fd411fe4453ea40eb45fc41a423839b485e238dd2530fba284e9b07a0bba6546&#x27;</span>, <span class="number">16</span>)</span><br><span class="line">enc=<span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;ce8f36aa844ab00319bcd4f86460a10d77492c060b2c2a91615f4cd1f2d0702e76b68f1ec0f11d15704ba52c5dacc60018d5ed87368464acd030ce6230efdbff7b18cba72ccaa9455a6fe6021b908dd1&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">key, m</span>):</span><br><span class="line">    key=sha256(<span class="built_in">str</span>(key).encode()).digest()</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    enc_secret = cipher.decrypt(m)</span><br><span class="line">    <span class="keyword">return</span> enc_secret</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RSAkey</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(x, e, n)</span><br><span class="line"></span><br><span class="line">pool=&#123;<span class="number">1</span>&#125;</span><br><span class="line">table=&#123;<span class="number">0</span>:<span class="number">0</span>&#125;</span><br><span class="line">key1, key2=<span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">20</span>, <span class="number">2</span>**<span class="number">21</span>):</span><br><span class="line">    pool.add(RSAkey(i))</span><br><span class="line">    table[RSAkey(i)]=i</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(pool):</span><br><span class="line"><span class="comment">#    print(i)</span></span><br><span class="line">    <span class="keyword">if</span> (key*inverse(i, n))%n <span class="keyword">in</span> pool:</span><br><span class="line">        key1=table[i]</span><br><span class="line">        key2=table[(key*inverse(i, n))%n]</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypt(key1*key2, enc))</span><br></pre></td></tr></table></figure>

<h2 id="Quadratic-Points"><a href="#Quadratic-Points" class="headerlink" title="Quadratic Points"></a>Quadratic Points</h2><p><strong>server.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">from</span> utils <span class="keyword">import</span> EllipticCurve, find_valid_quadratic_coefficients</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_input_with_timeout</span>(<span class="params">prompt, timeout</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">alarm_handler</span>(<span class="params">signum, frame</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\nTime limit exceeded. Exiting...&quot;</span>)</span><br><span class="line">        sys.exit()</span><br><span class="line"></span><br><span class="line">    signal.signal(signal.SIGALRM, alarm_handler)</span><br><span class="line">    signal.alarm(timeout)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        input_data = <span class="built_in">input</span>(prompt).strip()</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(input_data)</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        signal.alarm(<span class="number">0</span>)  <span class="comment"># Disable the alarm</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    x1, x2 = find_valid_quadratic_coefficients()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Hello Cryptographer, please enter the coefficients of the quadratic equation to proceed, hint: a*x^2 + b*x + c == 0, x = <span class="subst">&#123;x1&#125;</span>\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    ai = get_input_with_timeout(<span class="string">&quot;a: &quot;</span>, <span class="number">2</span>)</span><br><span class="line">    bi = get_input_with_timeout(<span class="string">&quot;b: &quot;</span>, <span class="number">2</span>)</span><br><span class="line">    ci = get_input_with_timeout(<span class="string">&quot;c: &quot;</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    res = ai * x1 ** <span class="number">2</span> + bi * x1 + ci</span><br><span class="line">    res *= <span class="number">10</span> ** <span class="number">13</span>  <span class="comment"># did you think I would be that careless?</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(res) != <span class="number">0</span> <span class="keyword">or</span> <span class="built_in">any</span>(i == <span class="number">0</span> <span class="keyword">or</span> <span class="built_in">abs</span>(i) &gt; <span class="number">60</span> <span class="keyword">for</span> i <span class="keyword">in</span> [ai, bi, ci]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Nope!&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;You passed the first test, now onto the second\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">40</span>)</span><br><span class="line">E = EllipticCurve(p, [bi, ci])</span><br><span class="line">G = E.random_point()</span><br><span class="line">flag = bytes_to_long(FLAG)</span><br><span class="line">Gn = E.mul(flag, G)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;G = <span class="subst">&#123;G.xy()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Gn = <span class="subst">&#123;Gn.xy()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;E.p&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>第一關要解二次函數，其實我不太確定在三個數字都&lt;60的Case求高精度要怎麼做，但我就直接暴力😀(清澈的眼神)<br><strong>exp.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;94.237.49.182&#x27;</span>,<span class="number">51308</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">60</span>, <span class="number">61</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">60</span>, <span class="number">61</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">60</span>, <span class="number">61</span>):</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">int</span>(<span class="number">10</span>**<span class="number">13</span>*(i*x**<span class="number">2</span>+j*x+k)) ==<span class="number">0</span> :</span><br><span class="line">                    <span class="keyword">return</span> i, j, k</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    x=r.recvline()</span><br><span class="line"><span class="comment">#    print(x)</span></span><br><span class="line">    x=x.split(<span class="string">b&#x27; x = &#x27;</span>)[<span class="number">1</span>].replace(<span class="string">b&#x27;\n&#x27;</span>, <span class="string">b&#x27;&#x27;</span>).replace(<span class="string">b&#x27;a: &#x27;</span>, <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(x)</span><br><span class="line">    x=<span class="built_in">float</span>(x)</span><br><span class="line">    a, b, c=solve(x)</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(a).encode())</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(b).encode())</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(c).encode())</span><br><span class="line"></span><br><span class="line">log=r.recvlines(<span class="number">5</span>)</span><br><span class="line">os.system(<span class="string">f&#x27;echo &quot;<span class="subst">&#123;b&#125;</span> <span class="subst">&#123;c&#125;</span>&quot; &gt;&gt; log.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">5</span>):</span><br><span class="line">    os.system(<span class="string">f&#x27;echo &quot;<span class="subst">&#123;log[i].decode()&#125;</span>&quot; &gt;&gt; log.txt&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>再來是ECC的部分，因為flag不只40 bytes所以先用<strong>exp.py</strong>抓好幾個紀錄。<br><strong>run.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    os.system(<span class="string">&#x27;python3 exp.py&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>最後根據log.txt，因為每個數都很小，利可以直接用sage math的discrete_log求解，再CRT回去就可以。<br><strong>solve.py</strong>  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">ords=[]</span><br><span class="line">logs=[]</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;log.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    x=f.readline()[:-<span class="number">1</span>].split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    a, b=<span class="built_in">int</span>(x[<span class="number">0</span>]), <span class="built_in">int</span>(x[<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(a, b)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        <span class="built_in">exec</span>(f.readline()[:-<span class="number">1</span>])</span><br><span class="line">    E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">    G=E(G)</span><br><span class="line">    Gn=E(Gn)</span><br><span class="line">    logs.append(discrete_log(Gn, G, G.order(), operation=<span class="string">&#x27;+&#x27;</span>))</span><br><span class="line">    ords.append(G.order())</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(crt(logs, ords))))</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/Syy0PybWA.png" alt="image">  </p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Secure-Signing"><span class="toc-number">2.</span> <span class="toc-text">Secure Signing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Remeeting-The-Wheel"><span class="toc-number">3.</span> <span class="toc-text">Remeeting The Wheel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Quadratic-Points"><span class="toc-number">4.</span> <span class="toc-text">Quadratic Points</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&text=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&title=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&is_video=false&description=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackTheBox Crypto 隨筆 4/20&body=Check out this article: http://wha13.github.io/2024/04/20/htb-crypto-2024apr/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&title=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&title=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&title=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&title=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&name=HackTheBox Crypto 隨筆 4/20&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2024/04/20/htb-crypto-2024apr/&t=HackTheBox Crypto 隨筆 4/20"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    William Lin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
